<?xml version="1.0"?>
<!-- CPSA 3.6.9 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Grant Negotiation and Authorization Protocol</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(comment &quot;CPSA 3.6.9&quot;)
(comment &quot;Extracted shapes&quot;)
(herald &quot;Grant Negotiation and Authorization Protocol&quot; (limit 3000)
  (depth 1000) (bound 16)
  (comment
    &quot;This protocol allows a piece of software, the client instance, to request delegated authorization to resource servers and to request direct information&quot;))
(comment &quot;CPSA 3.6.9&quot;)
(comment &quot;All input read from GNAP_refresh_scenario.scm&quot;)
(comment &quot;Step count limited to 3000&quot;)
(comment &quot;Strand count bounded at 16&quot;)
(comment &quot;Tree depth bounded at 1000&quot;)</pre>

<p id="top">Trees: <a href="#t0">0</a> <a href="#t299">299</a> <a href="#t341">341</a>.</p>

<p id="t0">Tree <a href="#top">0</a>, POV <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='4354.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 4354.920' font-size='12.000'>
  <text
   x='89.880' y='4301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k257&quot;, &quot;_self&quot;)'>257</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='4314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k256&quot;, &quot;_self&quot;)'>256</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='4239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k250&quot;, &quot;_self&quot;)'>250</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='4164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k249&quot;, &quot;_self&quot;)'>249</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='4089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k244&quot;, &quot;_self&quot;)'>244</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='4014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k243&quot;, &quot;_self&quot;)'>243</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='3939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k242&quot;, &quot;_self&quot;)'>242</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='3864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k236&quot;, &quot;_self&quot;)'>236</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='3789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k235&quot;, &quot;_self&quot;)'>235</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='3714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k229&quot;, &quot;_self&quot;)'>229</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='3639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k228&quot;, &quot;_self&quot;)'>228</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='3564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k223&quot;, &quot;_self&quot;)'>223</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='3489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k222&quot;, &quot;_self&quot;)'>222</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='3414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k221&quot;, &quot;_self&quot;)'>221</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='3339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k216&quot;, &quot;_self&quot;)'>216</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='3264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k215&quot;, &quot;_self&quot;)'>215</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='3189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k214&quot;, &quot;_self&quot;)'>214</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='3114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k209&quot;, &quot;_self&quot;)'>209</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='3039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k208&quot;, &quot;_self&quot;)'>208</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='2964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k207&quot;, &quot;_self&quot;)'>207</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='2889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k202&quot;, &quot;_self&quot;)'>202</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='2814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2726.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k201&quot;, &quot;_self&quot;)'>201</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='2739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k200&quot;, &quot;_self&quot;)'>200</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='2664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k196&quot;, &quot;_self&quot;)'>196</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='2589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k193&quot;, &quot;_self&quot;)'>193</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='2514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k192&quot;, &quot;_self&quot;)'>192</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='2439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k187&quot;, &quot;_self&quot;)'>187</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='2364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2276.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k184&quot;, &quot;_self&quot;)'>184</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='2289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k183&quot;, &quot;_self&quot;)'>183</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='2214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k178&quot;, &quot;_self&quot;)'>178</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='2139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k177&quot;, &quot;_self&quot;)'>177</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='2064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k176&quot;, &quot;_self&quot;)'>176</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='1989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k170&quot;, &quot;_self&quot;)'>170</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='1914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k167&quot;, &quot;_self&quot;)'>167</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k166&quot;, &quot;_self&quot;)'>166</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='1764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k161&quot;, &quot;_self&quot;)'>161</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k158&quot;, &quot;_self&quot;)'>158</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k157&quot;, &quot;_self&quot;)'>157</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k152&quot;, &quot;_self&quot;)'>152</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k151&quot;, &quot;_self&quot;)'>151</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k150&quot;, &quot;_self&quot;)'>150</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k144&quot;, &quot;_self&quot;)'>144</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k143&quot;, &quot;_self&quot;)'>143</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k142&quot;, &quot;_self&quot;)'>142</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k137&quot;, &quot;_self&quot;)'>137</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k136&quot;, &quot;_self&quot;)'>136</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k135&quot;, &quot;_self&quot;)'>135</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k130&quot;, &quot;_self&quot;)'>130</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k129&quot;, &quot;_self&quot;)'>129</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k128&quot;, &quot;_self&quot;)'>128</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k122&quot;, &quot;_self&quot;)'>122</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k121&quot;, &quot;_self&quot;)'>121</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k115&quot;, &quot;_self&quot;)'>115</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k114&quot;, &quot;_self&quot;)'>114</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k103&quot;, &quot;_self&quot;)'>103</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k102&quot;, &quot;_self&quot;)'>102</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k96&quot;, &quot;_self&quot;)'>96</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k95&quot;, &quot;_self&quot;)'>95</text>
  <line
   x1='39.960' y1='2177.460' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='2163.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol token_refresh basic
  (defrole client
    (vars (c as rs name)
      (access management_uri management_uri_new response response_error
        response_new data) (n1 n2 n3 n4 text) (token token_new mesg))
    (trace (send (enc c n1 (pubk as))) (recv (enc as n1 n2 (pubk c)))
      (send (enc n2 (pubk as))) (send (enc c access (hash n1 n2)))
      (recv (enc management_uri token (hash n1 n2)))
      (send (enc c n3 (pubk rs))) (recv (enc rs n3 n4 (pubk c)))
      (send (enc n4 (pubk rs))) (send (enc token (hash n3 n4)))
      (recv (enc response (hash n3 n4))) (send (enc token (hash n3 n4)))
      (recv (enc response_error (hash n3 n4)))
      (send (enc token (hash n1 n2)))
      (recv (enc management_uri_new token_new (hash n1 n2)))
      (send (enc token_new (hash n3 n4)))
      (recv (enc response_new (hash n3 n4))))
    (uniq-orig n1 n3))
  (defrole authorization_server
    (vars (c as rs name)
      (access access_token access_token_new access_type management_uri
        management_uri_new value data) (n1 n2 text))
    (trace (recv (enc c n1 (pubk as))) (send (enc as n1 n2 (pubk c)))
      (recv (enc n2 (pubk as))) (recv (enc c access (hash n1 n2)))
      (send
        (enc management_uri
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n1 n2)))
      (recv
        (enc
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n1 n2)))
      (send
        (enc management_uri_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs)) (hash n1 n2))))
    (uniq-orig n2))
  (defrole resource_server
    (vars (c as rs name)
      (access_token access_token_new value access_type response
        response_error response_new data) (n3 n4 text))
    (trace (recv (enc c n3 (pubk rs))) (send (enc rs n3 n4 (pubk c)))
      (recv (enc n4 (pubk rs)))
      (recv
        (enc
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n3 n4))) (send (enc response (hash n3 n4)))
      (recv
        (enc
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n3 n4)))
      (send (enc response_error (hash n3 n4)))
      (recv
        (enc
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs)) (hash n3 n4)))
      (send (enc response_new (hash n3 n4))))
    (uniq-orig n4)))</pre>

<p id="k0">Item <a href="#t0">0</a>, Children: <a href="#k95">95</a> <a href="#k96">96</a> <a href="#k102">102</a> <a href="#k103">103</a> <a href="#k114">114</a> <a href="#k115">115</a> <a href="#k121">121</a> <a href="#k122">122</a> <a href="#k128">128</a> <a href="#k129">129</a> <a href="#k130">130</a> <a href="#k135">135</a> <a href="#k136">136</a> <a href="#k137">137</a> <a href="#k142">142</a> <a href="#k143">143</a> <a href="#k144">144</a> <a href="#k150">150</a> <a href="#k151">151</a> <a href="#k152">152</a> <a href="#k157">157</a> <a href="#k158">158</a> <a href="#k161">161</a> <a href="#k166">166</a> <a href="#k167">167</a> <a href="#k170">170</a> <a href="#k176">176</a> <a href="#k177">177</a> <a href="#k178">178</a> <a href="#k183">183</a> <a href="#k184">184</a> <a href="#k187">187</a> <a href="#k192">192</a> <a href="#k193">193</a> <a href="#k196">196</a> <a href="#k200">200</a> <a href="#k201">201</a> <a href="#k202">202</a> <a href="#k207">207</a> <a href="#k208">208</a> <a href="#k209">209</a> <a href="#k214">214</a> <a href="#k215">215</a> <a href="#k216">216</a> <a href="#k221">221</a> <a href="#k222">222</a> <a href="#k223">223</a> <a href="#k228">228</a> <a href="#k229">229</a> <a href="#k235">235</a> <a href="#k236">236</a> <a href="#k242">242</a> <a href="#k243">243</a> <a href="#k244">244</a> <a href="#k249">249</a> <a href="#k250">250</a> <a href="#k256">256</a> <a href="#k257">257</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle style='fill: red;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(enc token_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc management_uri_new token_new (hash n1 n2))</title>
   <circle style='fill: red;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g><title>(enc token (hash n1 n2))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: red;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>(enc token (hash n3 n4))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc token (hash n3 n4))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc management_uri token (hash n1 n2))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((token token) (token_new token_new) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>token_refresh 0</text></svg></div>

<pre>(defskeleton token_refresh
  (vars (token token_new mesg) (n1 n3 n2 n4 text)
    (access management_uri management_uri_new response response_error
      response_new data) (c as rs name))
  (defstrand client 16 (token token) (token_new token_new) (n1 n1)
    (n2 n2) (n3 n3) (n4 n4) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (label 0)
  (unrealized (0 1) (0 4) (0 6) (0 9) (0 11) (0 13) (0 15))
  (origs (n1 (0 0)) (n3 (0 5)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k95">Item <a href="#t0">95</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 95 (realized)</text></svg>
 </div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 95)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k96">Item <a href="#t0">96</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 96 (realized)</text></svg>
 </div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 96)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k102">Item <a href="#t0">102</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 102 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 102)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k103">Item <a href="#t0">103</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 103 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 103)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k114">Item <a href="#t0">114</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 114 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((2 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 114)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k115">Item <a href="#t0">115</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 115 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((2 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 115)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k121">Item <a href="#t0">121</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 141.584 1049.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 121 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((2 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 2 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 121)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k122">Item <a href="#t0">122</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 122 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value data)
    (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 122)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k128">Item <a href="#t0">128</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 128 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 128)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k129">Item <a href="#t0">129</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 129 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 129)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_error) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k130">Item <a href="#t0">130</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 130 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 130)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k135">Item <a href="#t0">135</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 135 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 135)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k136">Item <a href="#t0">136</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 136 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 136)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k137">Item <a href="#t0">137</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 137 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 137)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k142">Item <a href="#t0">142</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 142 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 142)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k143">Item <a href="#t0">143</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 143 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 143)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k144">Item <a href="#t0">144</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 144 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 144)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k150">Item <a href="#t0">150</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 150 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((2 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 150)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k151">Item <a href="#t0">151</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 151 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_error-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((2 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 151)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k152">Item <a href="#t0">152</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 152 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((2 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 152)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k157">Item <a href="#t0">157</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 157 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 157)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k158">Item <a href="#t0">158</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 158 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 158)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k161">Item <a href="#t0">161</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 141.584 1199.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 161 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 0 client 9)
    (enc
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs)) (hash n3 n4-0)) (2 7))
  (label 161)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5)) (n4-0 (2 1)) (n4 (1 1))))</pre>

<p id="k166">Item <a href="#t0">166</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 166 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 166)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k167">Item <a href="#t0">167</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 167 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 167)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k170">Item <a href="#t0">170</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 141.584 1199.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 170 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 0 client 9)
    (enc
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs)) (hash n3 n4-0)) (2 7))
  (label 170)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5)) (n4-0 (2 1)) (n4 (1 1))))</pre>

<p id="k176">Item <a href="#t0">176</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.320 825.660 44.759 936.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 176 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((2 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 176)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k177">Item <a href="#t0">177</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.320 825.660 44.759 936.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 177 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((2 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 177)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k178">Item <a href="#t0">178</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.320 825.660 44.759 936.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 178 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((2 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 178)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n4 (1 1)) (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k183">Item <a href="#t0">183</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 136.920 977.460 233.880 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 183 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response access access_token
      access_token_new access_type management_uri value data)
    (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 4) (0 9)) ((1 6) (0 11)) ((2 1) (0 1)) ((2 4) (0 4))
    ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 183)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k184">Item <a href="#t0">184</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 136.920 977.460 233.880 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 184 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response access access_token
      access_token_new access_type management_uri value data)
    (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 4) (0 9)) ((1 6) (0 11)) ((2 1) (0 1)) ((2 4) (0 4))
    ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 184)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k187">Item <a href="#t0">187</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.320 1125.659 44.759 1236.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 187 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((2 6) (0 11)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 0 client 9)
    (enc
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs)) (hash n3 n4-0)) (2 7))
  (label 187)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5)) (n4-0 (2 1)) (n4 (1 1))))</pre>

<p id="k192">Item <a href="#t0">192</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 141.584 1049.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 86.940 1014.960 133.920 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 192 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response data)
    (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((0 12) (1 5)) ((1 1) (0 1))
    ((1 4) (0 4)) ((1 6) (0 13)) ((2 1) (0 6)) ((2 4) (0 9))
    ((2 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 1 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 192)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (2 1)) (n1 (0 0)) (n3 (0 5)) (n4 (1 1))))</pre>

<p id="k193">Item <a href="#t0">193</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 136.920 977.460 233.880 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 193 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response access access_token access_token_new
      access_type management_uri value data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 4) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 193)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k196">Item <a href="#t0">196</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.320 1125.659 44.759 1236.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 196 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 0 client 9)
    (enc
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs)) (hash n3 n4-0)) (2 7))
  (label 196)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5)) (n4-0 (2 1)) (n4 (1 1))))</pre>

<p id="k200">Item <a href="#t0">200</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 200 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 8) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 200)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k201">Item <a href="#t0">201</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 201 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 8) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 201)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_error) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k202">Item <a href="#t0">202</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 202 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 8) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 202)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k207">Item <a href="#t0">207</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 207 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 8) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 207)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k208">Item <a href="#t0">208</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 208 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 8) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 208)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k209">Item <a href="#t0">209</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 209 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response-0) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 8) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 209)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k214">Item <a href="#t0">214</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 214 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 8) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 214)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k215">Item <a href="#t0">215</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 215 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 8) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 215)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k216">Item <a href="#t0">216</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 216 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 8) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 216)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k221">Item <a href="#t0">221</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error-0) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 221 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response response_error-0 access
      access_token access_token_new access_type management_uri value
      data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error-0)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((1 8) (0 11)) ((2 1) (0 1)) ((2 4) (0 4))
    ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 221)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error-0) (response_error response_error)
        (response_new response_error) (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k222">Item <a href="#t0">222</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error-0) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 222 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response response_error-0 access
      access_token access_token_new access_type management_uri value
      data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error-0)
    (response_error response_error) (response_new response_error-0)
    (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((1 8) (0 11)) ((2 1) (0 1)) ((2 4) (0 4))
    ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 222)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error-0) (response_error response_error)
        (response_new response_error-0) (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k223">Item <a href="#t0">223</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 223 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response response_error-0 access
      access_token access_token_new access_type management_uri value
      data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((1 8) (0 11)) ((2 1) (0 1)) ((2 4) (0 4))
    ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 223)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error-0) (response_error response_error)
        (response_new response) (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k228">Item <a href="#t0">228</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 86.940 1164.960 133.920 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 228 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((0 12) (1 5)) ((0 14) (2 7))
    ((1 1) (0 1)) ((1 4) (0 4)) ((1 6) (0 13)) ((2 1) (0 6))
    ((2 6) (0 9)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 0 client 15)
    (enc
      (enc (enc access_token_new-0 value access_type (privk as))
        (pubk rs)) (hash n3 n4-0)) (2 7))
  (label 228)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response_error)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5)) (n4-0 (2 1)) (n4 (1 1))))</pre>

<p id="k229">Item <a href="#t0">229</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 141.584 1199.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 86.940 1164.960 133.920 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 229 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((0 12) (1 5)) ((1 1) (0 1))
    ((1 4) (0 4)) ((1 6) (0 13)) ((2 1) (0 6)) ((2 6) (0 9))
    ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 0 client 9)
    (enc
      (enc (enc access_token_new-0 value access_type (privk as))
        (pubk rs)) (hash n3 n4-0)) (2 7))
  (label 229)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response_error)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5)) (n4-0 (2 1)) (n4 (1 1))))</pre>

<p id="k235">Item <a href="#t0">235</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 86.940 1164.960 133.920 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 235 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((0 12) (1 5)) ((0 14) (2 7))
    ((1 1) (0 1)) ((1 4) (0 4)) ((1 6) (0 13)) ((2 1) (0 6))
    ((2 6) (0 9)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 0 client 15)
    (enc
      (enc (enc access_token_new-0 value access_type (privk as))
        (pubk rs)) (hash n3 n4-0)) (2 7))
  (label 235)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5)) (n4-0 (2 1)) (n4 (1 1))))</pre>

<p id="k236">Item <a href="#t0">236</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 141.584 1199.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 86.940 1164.960 133.920 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 236 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((0 12) (1 5)) ((1 1) (0 1))
    ((1 4) (0 4)) ((1 6) (0 13)) ((2 1) (0 6)) ((2 6) (0 9))
    ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 0 client 9)
    (enc
      (enc (enc access_token_new-0 value access_type (privk as))
        (pubk rs)) (hash n3 n4-0)) (2 7))
  (label 236)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5)) (n4-0 (2 1)) (n4 (1 1))))</pre>

<p id="k242">Item <a href="#t0">242</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 91.604 862.464 43.287 934.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 242 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response response_error-0 access
      access_token access_token_new access_type management_uri value
      data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 4) (0 9)) ((1 8) (0 11)) ((2 1) (0 1)) ((2 4) (0 4))
    ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 242)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k243">Item <a href="#t0">243</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 91.604 862.464 43.287 934.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 243 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response response_error-0 access
      access_token access_token_new access_type management_uri value
      data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error-0)
    (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 4) (0 9)) ((1 8) (0 11)) ((2 1) (0 1)) ((2 4) (0 4))
    ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 243)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k244">Item <a href="#t0">244</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 91.604 862.464 43.287 934.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 244 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response response_error-0 access
      access_token access_token_new access_type management_uri value
      data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 5) (1 0))
    ((0 7) (1 2)) ((0 8) (1 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 4) (0 9)) ((1 8) (0 11)) ((2 1) (0 1)) ((2 4) (0 4))
    ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 244)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n4-0 (1 1)) (n1 (0 0)) (n3 (0 5)) (n4 (2 1))))</pre>

<p id="k249">Item <a href="#t0">249</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 86.940 1014.960 133.920 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 249 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((0 12) (1 5)) ((0 14) (2 7))
    ((1 1) (0 1)) ((1 4) (0 4)) ((1 6) (0 13)) ((2 1) (0 6))
    ((2 4) (0 9)) ((2 6) (0 11)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 0 client 15)
    (enc
      (enc (enc access_token_new-0 value access_type (privk as))
        (pubk rs)) (hash n3 n4-0)) (2 7))
  (label 249)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5)) (n4-0 (2 1)) (n4 (1 1))))</pre>

<p id="k250">Item <a href="#t0">250</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.320 1125.659 44.759 1236.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 86.940 1014.960 133.920 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 250 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((0 12) (1 5)) ((1 1) (0 1))
    ((1 4) (0 4)) ((1 6) (0 13)) ((2 1) (0 6)) ((2 4) (0 9))
    ((2 6) (0 11)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 0 client 9)
    (enc
      (enc (enc access_token_new-0 value access_type (privk as))
        (pubk rs)) (hash n3 n4-0)) (2 7))
  (label 250)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5)) (n4-0 (2 1)) (n4 (1 1))))</pre>

<p id="k256">Item <a href="#t0">256</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 86.940 1014.960 133.920 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 256 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((0 12) (1 5)) ((0 14) (2 7))
    ((1 1) (0 1)) ((1 4) (0 4)) ((1 6) (0 13)) ((2 1) (0 6))
    ((2 4) (0 9)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 0 client 15)
    (enc
      (enc (enc access_token_new-0 value access_type (privk as))
        (pubk rs)) (hash n3 n4-0)) (2 7))
  (label 256)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5)) (n4-0 (2 1)) (n4 (1 1))))</pre>

<p id="k257">Item <a href="#t0">257</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.320 1125.659 44.759 1236.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 86.940 1014.960 133.920 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 257 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 5) (2 0))
    ((0 7) (2 2)) ((0 8) (2 3)) ((0 12) (1 5)) ((1 1) (0 1))
    ((1 4) (0 4)) ((1 6) (0 13)) ((2 1) (0 6)) ((2 4) (0 9))
    ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3 n4 n4-0)
  (operation encryption-test (displaced 3 0 client 9)
    (enc
      (enc (enc access_token_new-0 value access_type (privk as))
        (pubk rs)) (hash n3 n4-0)) (2 7))
  (label 257)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5)) (n4-0 (2 1)) (n4 (1 1))))</pre>

<p id="t299">Tree <a href="#top">299</a>, POV <a href="#k299">299</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k324&quot;, &quot;_self&quot;)'>324</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k299&quot;, &quot;_self&quot;)'>299</text>
  </svg></div>

<pre>(defprotocol token_refresh basic
  (defrole client
    (vars (c as rs name)
      (access management_uri management_uri_new response response_error
        response_new data) (n1 n2 n3 n4 text) (token token_new mesg))
    (trace (send (enc c n1 (pubk as))) (recv (enc as n1 n2 (pubk c)))
      (send (enc n2 (pubk as))) (send (enc c access (hash n1 n2)))
      (recv (enc management_uri token (hash n1 n2)))
      (send (enc c n3 (pubk rs))) (recv (enc rs n3 n4 (pubk c)))
      (send (enc n4 (pubk rs))) (send (enc token (hash n3 n4)))
      (recv (enc response (hash n3 n4))) (send (enc token (hash n3 n4)))
      (recv (enc response_error (hash n3 n4)))
      (send (enc token (hash n1 n2)))
      (recv (enc management_uri_new token_new (hash n1 n2)))
      (send (enc token_new (hash n3 n4)))
      (recv (enc response_new (hash n3 n4))))
    (uniq-orig n1 n3))
  (defrole authorization_server
    (vars (c as rs name)
      (access access_token access_token_new access_type management_uri
        management_uri_new value data) (n1 n2 text))
    (trace (recv (enc c n1 (pubk as))) (send (enc as n1 n2 (pubk c)))
      (recv (enc n2 (pubk as))) (recv (enc c access (hash n1 n2)))
      (send
        (enc management_uri
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n1 n2)))
      (recv
        (enc
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n1 n2)))
      (send
        (enc management_uri_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs)) (hash n1 n2))))
    (uniq-orig n2))
  (defrole resource_server
    (vars (c as rs name)
      (access_token access_token_new value access_type response
        response_error response_new data) (n3 n4 text))
    (trace (recv (enc c n3 (pubk rs))) (send (enc rs n3 n4 (pubk c)))
      (recv (enc n4 (pubk rs)))
      (recv
        (enc
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n3 n4))) (send (enc response (hash n3 n4)))
      (recv
        (enc
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n3 n4)))
      (send (enc response_error (hash n3 n4)))
      (recv
        (enc
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs)) (hash n3 n4)))
      (send (enc response_new (hash n3 n4))))
    (uniq-orig n4)))</pre>

<p id="k299">Item <a href="#t299">299</a>, Child: <a href="#k324">324</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>token_refresh 299</text></svg></div>

<pre>(defskeleton token_refresh
  (vars (n2 n1 text)
    (access access_token access_token_new access_type management_uri
      management_uri_new value data) (c as rs name))
  (defstrand authorization_server 7 (n1 n1) (n2 n2) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n2)
  (label 299)
  (unrealized (0 2) (0 3) (0 5))
  (origs (n2 (0 1)))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k324">Item <a href="#t299">324</a>, Parent: <a href="#k299">299</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs-0))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access) (management_uri management_uri) (response response) (response_error response_error) (c c) (as as) (rs rs-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>token_refresh 324 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n2 n1 n3 n4 text)
    (access_token access_token_new access_type management_uri
      management_uri_new value access response response_error data)
    (rs c as rs-0 name))
  (defstrand authorization_server 7 (n1 n1) (n2 n2) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand client 13
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access)
    (management_uri management_uri) (response response)
    (response_error response_error) (c c) (as as) (rs rs-0))
  (precedes ((0 1) (1 1)) ((0 4) (1 4)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 3) (0 3)) ((1 12) (0 5)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n2 n1 n3)
  (operation encryption-test (displaced 2 0 authorization_server 5)
    (enc management_uri-0
      (enc (enc access_token value access_type (privk as)) (pubk rs))
      (hash n1 n2)) (1 4))
  (label 324)
  (parent 299)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (access access)
        (access_token access_token) (access_token_new access_token_new)
        (access_type access_type) (management_uri management_uri)
        (management_uri_new management_uri_new) (value value) (n1 n1))))
  (origs (n2 (0 1)) (n1 (1 0)) (n3 (1 5))))</pre>

<p id="t341">Tree <a href="#top">341</a>, POV <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='2104.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 2104.920' font-size='12.000'>
  <text
   x='89.880' y='2051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k439&quot;, &quot;_self&quot;)'>439</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='2064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k437&quot;, &quot;_self&quot;)'>437</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='1989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k436&quot;, &quot;_self&quot;)'>436</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='1914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k435&quot;, &quot;_self&quot;)'>435</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k433&quot;, &quot;_self&quot;)'>433</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='1764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k432&quot;, &quot;_self&quot;)'>432</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k430&quot;, &quot;_self&quot;)'>430</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k428&quot;, &quot;_self&quot;)'>428</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k427&quot;, &quot;_self&quot;)'>427</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k426&quot;, &quot;_self&quot;)'>426</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k424&quot;, &quot;_self&quot;)'>424</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k423&quot;, &quot;_self&quot;)'>423</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k420&quot;, &quot;_self&quot;)'>420</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k419&quot;, &quot;_self&quot;)'>419</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k418&quot;, &quot;_self&quot;)'>418</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k416&quot;, &quot;_self&quot;)'>416</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k415&quot;, &quot;_self&quot;)'>415</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k414&quot;, &quot;_self&quot;)'>414</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k411&quot;, &quot;_self&quot;)'>411</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k410&quot;, &quot;_self&quot;)'>410</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k409&quot;, &quot;_self&quot;)'>409</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k407&quot;, &quot;_self&quot;)'>407</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k406&quot;, &quot;_self&quot;)'>406</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k405&quot;, &quot;_self&quot;)'>405</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k383&quot;, &quot;_self&quot;)'>383</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k381&quot;, &quot;_self&quot;)'>381</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k363&quot;, &quot;_self&quot;)'>363</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k360&quot;, &quot;_self&quot;)'>360</text>
  <line
   x1='39.960' y1='1052.460' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='1038.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k341&quot;, &quot;_self&quot;)'>341</text>
  </svg></div>

<pre>(defprotocol token_refresh basic
  (defrole client
    (vars (c as rs name)
      (access management_uri management_uri_new response response_error
        response_new data) (n1 n2 n3 n4 text) (token token_new mesg))
    (trace (send (enc c n1 (pubk as))) (recv (enc as n1 n2 (pubk c)))
      (send (enc n2 (pubk as))) (send (enc c access (hash n1 n2)))
      (recv (enc management_uri token (hash n1 n2)))
      (send (enc c n3 (pubk rs))) (recv (enc rs n3 n4 (pubk c)))
      (send (enc n4 (pubk rs))) (send (enc token (hash n3 n4)))
      (recv (enc response (hash n3 n4))) (send (enc token (hash n3 n4)))
      (recv (enc response_error (hash n3 n4)))
      (send (enc token (hash n1 n2)))
      (recv (enc management_uri_new token_new (hash n1 n2)))
      (send (enc token_new (hash n3 n4)))
      (recv (enc response_new (hash n3 n4))))
    (uniq-orig n1 n3))
  (defrole authorization_server
    (vars (c as rs name)
      (access access_token access_token_new access_type management_uri
        management_uri_new value data) (n1 n2 text))
    (trace (recv (enc c n1 (pubk as))) (send (enc as n1 n2 (pubk c)))
      (recv (enc n2 (pubk as))) (recv (enc c access (hash n1 n2)))
      (send
        (enc management_uri
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n1 n2)))
      (recv
        (enc
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n1 n2)))
      (send
        (enc management_uri_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs)) (hash n1 n2))))
    (uniq-orig n2))
  (defrole resource_server
    (vars (c as rs name)
      (access_token access_token_new value access_type response
        response_error response_new data) (n3 n4 text))
    (trace (recv (enc c n3 (pubk rs))) (send (enc rs n3 n4 (pubk c)))
      (recv (enc n4 (pubk rs)))
      (recv
        (enc
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n3 n4))) (send (enc response (hash n3 n4)))
      (recv
        (enc
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n3 n4)))
      (send (enc response_error (hash n3 n4)))
      (recv
        (enc
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs)) (hash n3 n4)))
      (send (enc response_new (hash n3 n4))))
    (uniq-orig n4)))</pre>

<p id="k341">Item <a href="#t341">341</a>, Children: <a href="#k360">360</a> <a href="#k363">363</a> <a href="#k381">381</a> <a href="#k383">383</a> <a href="#k405">405</a> <a href="#k406">406</a> <a href="#k407">407</a> <a href="#k409">409</a> <a href="#k410">410</a> <a href="#k411">411</a> <a href="#k414">414</a> <a href="#k415">415</a> <a href="#k416">416</a> <a href="#k418">418</a> <a href="#k419">419</a> <a href="#k420">420</a> <a href="#k423">423</a> <a href="#k424">424</a> <a href="#k426">426</a> <a href="#k427">427</a> <a href="#k428">428</a> <a href="#k430">430</a> <a href="#k432">432</a> <a href="#k433">433</a> <a href="#k435">435</a> <a href="#k436">436</a> <a href="#k437">437</a> <a href="#k439">439</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: red;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>token_refresh 341</text></svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 text)
    (access_token access_token_new value access_type response
      response_error response_new data) (c as rs name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n4)
  (label 341)
  (unrealized (0 2) (0 3) (0 5) (0 7))
  (origs (n4 (0 1)))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k360">Item <a href="#t341">360</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='639.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-0 n2-0 (pubk c-0))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 864.960 Q 92.940 864.960 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as-0))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc as-0 n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access-0) (access_token access_token-0) (access_token_new access_token) (access_type access_type) (management_uri management_uri-0) (management_uri_new management_uri_new) (value value) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access) (management_uri management_uri) (c c) (as as-0) (rs rs))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 360 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 text)
    (access_token value access_type response response_error response_new
      access management_uri access-0 access_token-0 management_uri-0
      management_uri_new data) (as c as-0 rs c-0 rs-0 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand client 9
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access)
    (management_uri management_uri) (c c) (as as-0) (rs rs))
  (defstrand authorization_server 7 (n1 n1-0) (n2 n2-0)
    (access access-0) (access_token access_token-0)
    (access_token_new access_token) (access_type access_type)
    (management_uri management_uri-0)
    (management_uri_new management_uri_new) (value value) (c c-0)
    (as as) (rs rs-0))
  (precedes ((0 1) (1 6)) ((1 5) (0 0)) ((1 7) (0 2)) ((1 8) (0 3))
    ((2 6) (1 4)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n4 n3 n1 n2-0)
  (operation encryption-test (displaced 3 1 client 9)
    (enc
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs)) (hash n3 n4)) (0 7))
  (label 360)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n4 n4) (access_token access_token)
        (access_token_new access_token) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n1 (1 0)) (n3 (1 5)) (n2-0 (2 1)) (n4 (0 1))))</pre>

<p id="k363">Item <a href="#t341">363</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-0 n2-0 (pubk c-0))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access-0) (access_token access_token) (access_type access_type) (management_uri management_uri-0) (value value) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access) (management_uri management_uri) (c c) (as as-0) (rs rs))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 363 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 text)
    (access_token value access_type response response_error response_new
      access management_uri access-0 management_uri-0 data)
    (as c as-0 rs c-0 rs-0 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand client 9
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access)
    (management_uri management_uri) (c c) (as as-0) (rs rs))
  (defstrand authorization_server 5 (n1 n1-0) (n2 n2-0)
    (access access-0) (access_token access_token)
    (access_type access_type) (management_uri management_uri-0)
    (value value) (c c-0) (as as) (rs rs-0))
  (precedes ((0 1) (1 6)) ((1 5) (0 0)) ((1 7) (0 2)) ((1 8) (0 3))
    ((2 4) (1 4)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n4 n3 n1 n2-0)
  (operation encryption-test (displaced 3 1 client 9)
    (enc
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs)) (hash n3 n4)) (0 7))
  (label 363)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n4 n4) (access_token access_token)
        (access_token_new access_token) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n1 (1 0)) (n3 (1 5)) (n2-0 (2 1)) (n4 (0 1))))</pre>

<p id="k381">Item <a href="#t341">381</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 564.960 Q 190.461 824.513 141.042 1084.066'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-0 n2-0 (pubk c-0))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1164.960 Q 92.940 1164.960 45.960 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(enc response-0 (hash n1 n2))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4))</title>
   <circle cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 90.591 862.031 41.261 1084.103'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc management_uri response-0 (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1464.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access-0) (access_token access_token-0) (access_token_new access_token) (access_type access_type) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (value value) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token response-0) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response-0) (response_error response-0) (c c) (as as-0) (rs rs))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 381 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 text)
    (access_token value access_type response response_error response_new
      access management_uri management_uri_new response-0 access-0
      access_token-0 management_uri-0 management_uri_new-0 data)
    (as c as-0 rs c-0 rs-0 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand client 15 (token response-0)
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response-0)
    (response_error response-0) (c c) (as as-0) (rs rs))
  (defstrand authorization_server 7 (n1 n1-0) (n2 n2-0)
    (access access-0) (access_token access_token-0)
    (access_token_new access_token) (access_type access_type)
    (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (value value) (c c-0)
    (as as) (rs rs-0))
  (precedes ((0 1) (1 6)) ((1 5) (0 0)) ((1 7) (0 2)) ((1 14) (0 3))
    ((2 6) (1 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n4 n3 n1 n2-0)
  (operation encryption-test (displaced 3 1 client 15)
    (enc
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs)) (hash n3 n4)) (0 7))
  (label 381)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n4 n4) (access_token access_token)
        (access_token_new access_token) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n1 (1 0)) (n3 (1 5)) (n2-0 (2 1)) (n4 (0 1))))</pre>

<p id="k383">Item <a href="#t341">383</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 190.339 749.492 140.799 1084.025'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-0 n2-0 (pubk c-0))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1164.960 Q 92.940 1164.960 45.960 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(enc response-0 (hash n1 n2))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4))</title>
   <circle cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 90.591 862.031 41.261 1084.103'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc management_uri response-0 (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1464.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access-0) (access_token access_token) (access_type access_type) (management_uri management_uri-0) (value value) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token response-0) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response-0) (response_error response-0) (c c) (as as-0) (rs rs))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 383 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 text)
    (access_token value access_type response response_error response_new
      access management_uri management_uri_new response-0 access-0
      management_uri-0 data) (as c as-0 rs c-0 rs-0 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand client 15 (token response-0)
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response-0)
    (response_error response-0) (c c) (as as-0) (rs rs))
  (defstrand authorization_server 5 (n1 n1-0) (n2 n2-0)
    (access access-0) (access_token access_token)
    (access_type access_type) (management_uri management_uri-0)
    (value value) (c c-0) (as as) (rs rs-0))
  (precedes ((0 1) (1 6)) ((1 5) (0 0)) ((1 7) (0 2)) ((1 14) (0 3))
    ((2 4) (1 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n4 n3 n1 n2-0)
  (operation encryption-test (displaced 3 1 client 15)
    (enc
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs)) (hash n3 n4)) (0 7))
  (label 383)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n4 n4) (access_token access_token)
        (access_token_new access_token) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n1 (1 0)) (n3 (1 5)) (n2-0 (2 1)) (n4 (0 1))))</pre>

<p id="k405">Item <a href="#t341">405</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='639.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 290.221 974.482 240.602 1384.004'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new-1 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-1 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token-1 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1464.960 Q 142.920 1427.460 45.960 1464.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1464.960' r='6.000'/></g>
  <path
   d='M 39.960 1089.960 Q 136.920 1052.460 233.880 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token-1) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-1) (management_uri_new management_uri_new-1) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (response response_error) (response_error response_error) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token-0) (access_token_new access_token) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 405 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access access_token-0 management_uri
      management_uri_new access-0 management_uri-0 management_uri_new-0
      access-1 access_token-1 management_uri-1 management_uri_new-1
      data) (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1) (n2 n2) (access access)
    (access_token access_token-0) (access_token_new access_token)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (response response_error)
    (response_error response_error) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token-1)
    (access_token_new access_token_new) (access_type access_type)
    (management_uri management_uri-1)
    (management_uri_new management_uri_new-1) (value value) (c c-1)
    (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 6) (2 9)) ((1 6) (2 4)) ((2 5) (0 0))
    ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)) ((3 6) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 7)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 405)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

<p id="k406">Item <a href="#t341">406</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='639.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1464.960 Q 142.920 1427.460 45.960 1464.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1464.960' r='6.000'/></g>
  <path
   d='M 39.960 1089.960 Q 136.920 1052.460 233.880 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (response response_error) (response_error response_error) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token-0) (access_token_new access_token) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token-0) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 406 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 text)
    (access_token value access_type response response_error response_new
      access access_token-0 management_uri management_uri_new access-0
      management_uri-0 management_uri_new-0 data)
    (as c rs c-0 as-0 rs-0 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token-0)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1) (n2 n2) (access access)
    (access_token access_token-0) (access_token_new access_token)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token-0 value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (response response_error)
    (response_error response_error) (c c-0) (as as-0) (rs rs-0))
  (precedes ((0 1) (2 6)) ((0 6) (2 9)) ((1 6) (2 4)) ((2 5) (0 0))
    ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0)
  (operation encryption-test (displaced 3 1 authorization_server 5)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 406)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token-0) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2 (1 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5))))</pre>

<p id="k407">Item <a href="#t341">407</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='639.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 290.166 899.476 240.492 1383.991'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1464.960 Q 142.920 1427.460 45.960 1464.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1464.960' r='6.000'/></g>
  <path
   d='M 39.960 1089.960 Q 136.920 1052.460 233.880 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token_new) (access_type access_type) (management_uri management_uri-1) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (response response_error) (response_error response_error) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token-0) (access_token_new access_token) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 407 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access access_token-0 management_uri
      management_uri_new access-0 management_uri-0 management_uri_new-0
      access-1 management_uri-1 data)
    (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1) (n2 n2) (access access)
    (access_token access_token-0) (access_token_new access_token)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (response response_error)
    (response_error response_error) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token_new)
    (access_type access_type) (management_uri management_uri-1)
    (value value) (c c-1) (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 6) (2 9)) ((1 6) (2 4)) ((2 5) (0 0))
    ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)) ((3 4) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 5)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 407)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

<p id="k409">Item <a href="#t341">409</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='639.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 290.221 974.482 240.602 1384.004'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new-1 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-1 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token-1 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1464.960 Q 142.920 1427.460 45.960 1464.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1464.960' r='6.000'/></g>
  <path
   d='M 39.960 1089.960 Q 136.920 1052.460 233.880 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token-1) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-1) (management_uri_new management_uri_new-1) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (response response_error) (response_error response) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token-0) (access_token_new access_token) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 409 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access access_token-0 management_uri
      management_uri_new access-0 management_uri-0 management_uri_new-0
      access-1 access_token-1 management_uri-1 management_uri_new-1
      data) (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1) (n2 n2) (access access)
    (access_token access_token-0) (access_token_new access_token)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (response response_error)
    (response_error response) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token-1)
    (access_token_new access_token_new) (access_type access_type)
    (management_uri management_uri-1)
    (management_uri_new management_uri_new-1) (value value) (c c-1)
    (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 6) (2 9)) ((1 6) (2 4)) ((2 5) (0 0))
    ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)) ((3 6) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 7)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 409)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

<p id="k410">Item <a href="#t341">410</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='639.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1464.960 Q 142.920 1427.460 45.960 1464.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1464.960' r='6.000'/></g>
  <path
   d='M 39.960 1089.960 Q 136.920 1052.460 233.880 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (response response_error) (response_error response) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token-0) (access_token_new access_token) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token-0) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 410 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 text)
    (access_token value access_type response response_error response_new
      access access_token-0 management_uri management_uri_new access-0
      management_uri-0 management_uri_new-0 data)
    (as c rs c-0 as-0 rs-0 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token-0)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1) (n2 n2) (access access)
    (access_token access_token-0) (access_token_new access_token)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token-0 value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (response response_error)
    (response_error response) (c c-0) (as as-0) (rs rs-0))
  (precedes ((0 1) (2 6)) ((0 6) (2 9)) ((1 6) (2 4)) ((2 5) (0 0))
    ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0)
  (operation encryption-test (displaced 3 1 authorization_server 5)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 410)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token-0) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2 (1 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5))))</pre>

<p id="k411">Item <a href="#t341">411</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='639.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 290.166 899.476 240.492 1383.991'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1464.960 Q 142.920 1427.460 45.960 1464.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1464.960' r='6.000'/></g>
  <path
   d='M 39.960 1089.960 Q 136.920 1052.460 233.880 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token_new) (access_type access_type) (management_uri management_uri-1) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (response response_error) (response_error response) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token-0) (access_token_new access_token) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 411 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access access_token-0 management_uri
      management_uri_new access-0 management_uri-0 management_uri_new-0
      access-1 management_uri-1 data)
    (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1) (n2 n2) (access access)
    (access_token access_token-0) (access_token_new access_token)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (response response_error)
    (response_error response) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token_new)
    (access_type access_type) (management_uri management_uri-1)
    (value value) (c c-1) (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 6) (2 9)) ((1 6) (2 4)) ((2 5) (0 0))
    ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)) ((3 4) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 5)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 411)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

<p id="k414">Item <a href="#t341">414</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='639.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 290.299 899.492 240.759 1234.025'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new-1 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-1 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token-1 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1314.960 Q 142.920 1277.460 45.960 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <path
   d='M 39.960 1089.960 Q 136.920 1052.460 233.880 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 939.960 Q 136.920 902.460 233.880 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token-1) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-1) (management_uri_new management_uri_new-1) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (response response) (response_error response_error) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token-0) (access_token_new access_token) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 414 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access access_token-0 management_uri
      management_uri_new access-0 management_uri-0 management_uri_new-0
      access-1 access_token-1 management_uri-1 management_uri_new-1
      data) (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1) (n2 n2) (access access)
    (access_token access_token-0) (access_token_new access_token)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (response response)
    (response_error response_error) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token-1)
    (access_token_new access_token_new) (access_type access_type)
    (management_uri management_uri-1)
    (management_uri_new management_uri_new-1) (value value) (c c-1)
    (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 4) (2 9)) ((0 6) (2 11)) ((1 6) (2 4))
    ((2 5) (0 0)) ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7))
    ((3 6) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 7)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 414)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

<p id="k415">Item <a href="#t341">415</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='639.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1314.960 Q 142.920 1277.460 45.960 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <path
   d='M 39.960 1089.960 Q 136.920 1052.460 233.880 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 939.960 Q 136.920 902.460 233.880 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (response response) (response_error response_error) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token-0) (access_token_new access_token) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token-0) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 415 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 text)
    (access_token value access_type response response_error response_new
      access access_token-0 management_uri management_uri_new access-0
      management_uri-0 management_uri_new-0 data)
    (as c rs c-0 as-0 rs-0 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token-0)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1) (n2 n2) (access access)
    (access_token access_token-0) (access_token_new access_token)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token-0 value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (response response)
    (response_error response_error) (c c-0) (as as-0) (rs rs-0))
  (precedes ((0 1) (2 6)) ((0 4) (2 9)) ((0 6) (2 11)) ((1 6) (2 4))
    ((2 5) (0 0)) ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0)
  (operation encryption-test (displaced 3 1 authorization_server 5)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 415)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token-0) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2 (1 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5))))</pre>

<p id="k416">Item <a href="#t341">416</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='639.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 290.221 824.482 240.602 1234.004'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1314.960 Q 142.920 1277.460 45.960 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <path
   d='M 39.960 1089.960 Q 136.920 1052.460 233.880 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 939.960 Q 136.920 902.460 233.880 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token_new) (access_type access_type) (management_uri management_uri-1) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (response response) (response_error response_error) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token-0) (access_token_new access_token) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 416 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access access_token-0 management_uri
      management_uri_new access-0 management_uri-0 management_uri_new-0
      access-1 management_uri-1 data)
    (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1) (n2 n2) (access access)
    (access_token access_token-0) (access_token_new access_token)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (response response)
    (response_error response_error) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token_new)
    (access_type access_type) (management_uri management_uri-1)
    (value value) (c c-1) (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 4) (2 9)) ((0 6) (2 11)) ((1 6) (2 4))
    ((2 5) (0 0)) ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7))
    ((3 4) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 5)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 416)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

<p id="k418">Item <a href="#t341">418</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='639.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 290.299 899.492 240.759 1234.025'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new-1 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-1 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token-1 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1314.960 Q 142.920 1277.460 45.960 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <path
   d='M 39.960 939.960 Q 136.920 902.460 233.880 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token-1) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-1) (management_uri_new management_uri_new-1) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (response response) (response_error response) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token-0) (access_token_new access_token) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 418 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access access_token-0 management_uri
      management_uri_new access-0 management_uri-0 management_uri_new-0
      access-1 access_token-1 management_uri-1 management_uri_new-1
      data) (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1) (n2 n2) (access access)
    (access_token access_token-0) (access_token_new access_token)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (response response)
    (response_error response) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token-1)
    (access_token_new access_token_new) (access_type access_type)
    (management_uri management_uri-1)
    (management_uri_new management_uri_new-1) (value value) (c c-1)
    (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 4) (2 9)) ((1 6) (2 4)) ((2 5) (0 0))
    ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)) ((3 6) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 7)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 418)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

<p id="k419">Item <a href="#t341">419</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='639.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1314.960 Q 142.920 1277.460 45.960 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <path
   d='M 39.960 939.960 Q 136.920 902.460 233.880 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token-0 value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (response response) (response_error response) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token-0) (access_token_new access_token) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token-0) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 419 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 text)
    (access_token value access_type response response_error response_new
      access access_token-0 management_uri management_uri_new access-0
      management_uri-0 management_uri_new-0 data)
    (as c rs c-0 as-0 rs-0 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token-0)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1) (n2 n2) (access access)
    (access_token access_token-0) (access_token_new access_token)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token-0 value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (response response)
    (response_error response) (c c-0) (as as-0) (rs rs-0))
  (precedes ((0 1) (2 6)) ((0 4) (2 9)) ((1 6) (2 4)) ((2 5) (0 0))
    ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0)
  (operation encryption-test (displaced 3 1 authorization_server 5)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 419)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token-0) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2 (1 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5))))</pre>

<p id="k420">Item <a href="#t341">420</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='639.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 290.221 824.482 240.602 1234.004'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1314.960 Q 142.920 1277.460 45.960 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token-0 value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <path
   d='M 39.960 939.960 Q 136.920 902.460 233.880 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token_new) (access_type access_type) (management_uri management_uri-1) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (response response) (response_error response) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token-0) (access_token_new access_token) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 420 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access access_token-0 management_uri
      management_uri_new access-0 management_uri-0 management_uri_new-0
      access-1 management_uri-1 data)
    (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1) (n2 n2) (access access)
    (access_token access_token-0) (access_token_new access_token)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (response response)
    (response_error response) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token_new)
    (access_type access_type) (management_uri management_uri-1)
    (value value) (c c-1) (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 4) (2 9)) ((1 6) (2 4)) ((2 5) (0 0))
    ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)) ((3 4) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 5)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 420)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

<p id="k423">Item <a href="#t341">423</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 564.960 Q 190.339 899.492 140.799 1234.025'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-0 n2-0 (pubk c-0))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1314.960 Q 92.940 1314.960 45.960 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <path
   d='M 39.960 939.960 Q 86.940 939.960 133.920 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access-0) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (value value) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response_error) (c c) (as as-0) (rs rs))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 423 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 text)
    (access_token_new value access_type response response_error
      response_new access management_uri management_uri_new access-0
      access_token management_uri-0 management_uri_new-0 data)
    (as c as-0 rs c-0 rs-0 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response_error) (c c) (as as-0) (rs rs))
  (defstrand authorization_server 7 (n1 n1-0) (n2 n2-0)
    (access access-0) (access_token access_token)
    (access_token_new access_token_new) (access_type access_type)
    (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (value value) (c c-0)
    (as as) (rs rs-0))
  (precedes ((0 1) (1 6)) ((0 6) (1 9)) ((1 5) (0 0)) ((1 7) (0 2))
    ((1 8) (0 3)) ((1 14) (0 7)) ((2 4) (1 4)) ((2 6) (1 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n4 n3 n1 n2-0)
  (operation encryption-test (displaced 1 3 authorization_server 7)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 423)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-0 (2 1)) (n4 (0 1)) (n1 (1 0)) (n3 (1 5))))</pre>

<p id="k424">Item <a href="#t341">424</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 290.299 899.492 240.759 1234.025'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token-0 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1314.960 Q 142.920 1277.460 45.960 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 186.900 414.960 233.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <path
   d='M 39.960 939.960 Q 136.920 902.460 233.880 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token-0) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-1) (management_uri_new management_uri_new-0) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new) (response response_error) (response_error response_error) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 424 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access management_uri access-0
      management_uri-0 management_uri_new access-1 access_token-0
      management_uri-1 management_uri_new-0 data)
    (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response_error) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token-0)
    (access_token_new access_token_new) (access_type access_type)
    (management_uri management_uri-1)
    (management_uri_new management_uri_new-0) (value value) (c c-1)
    (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 6) (2 9)) ((1 4) (2 4)) ((2 5) (0 0))
    ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)) ((3 6) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 7)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 424)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

<p id="k426">Item <a href="#t341">426</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 290.221 824.482 240.602 1234.004'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1314.960 Q 142.920 1277.460 45.960 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 186.900 414.960 233.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <path
   d='M 39.960 939.960 Q 136.920 902.460 233.880 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token_new) (access_type access_type) (management_uri management_uri-1) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new) (response response_error) (response_error response_error) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 426 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access management_uri access-0
      management_uri-0 management_uri_new access-1 management_uri-1
      data) (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response_error) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token_new)
    (access_type access_type) (management_uri management_uri-1)
    (value value) (c c-1) (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 6) (2 9)) ((1 4) (2 4)) ((2 5) (0 0))
    ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)) ((3 4) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 5)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 426)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

<p id="k427">Item <a href="#t341">427</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 564.960 Q 190.339 899.492 140.799 1234.025'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-0 n2-0 (pubk c-0))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1314.960 Q 92.940 1314.960 45.960 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <path
   d='M 39.960 939.960 Q 86.940 939.960 133.920 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access-0) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (value value) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response) (c c) (as as-0) (rs rs))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 427 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 text)
    (access_token_new value access_type response response_error
      response_new access management_uri management_uri_new access-0
      access_token management_uri-0 management_uri_new-0 data)
    (as c as-0 rs c-0 rs-0 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response) (c c) (as as-0) (rs rs))
  (defstrand authorization_server 7 (n1 n1-0) (n2 n2-0)
    (access access-0) (access_token access_token)
    (access_token_new access_token_new) (access_type access_type)
    (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (value value) (c c-0)
    (as as) (rs rs-0))
  (precedes ((0 1) (1 6)) ((0 6) (1 9)) ((1 5) (0 0)) ((1 7) (0 2))
    ((1 8) (0 3)) ((1 14) (0 7)) ((2 4) (1 4)) ((2 6) (1 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n4 n3 n1 n2-0)
  (operation encryption-test (displaced 1 3 authorization_server 7)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 427)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-0 (2 1)) (n4 (0 1)) (n1 (1 0)) (n3 (1 5))))</pre>

<p id="k428">Item <a href="#t341">428</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 290.299 899.492 240.759 1234.025'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token-0 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1314.960 Q 142.920 1277.460 45.960 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 186.900 414.960 233.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <path
   d='M 39.960 939.960 Q 136.920 902.460 233.880 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token-0) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-1) (management_uri_new management_uri_new-0) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new) (response response_error) (response_error response) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 428 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access management_uri access-0
      management_uri-0 management_uri_new access-1 access_token-0
      management_uri-1 management_uri_new-0 data)
    (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token-0)
    (access_token_new access_token_new) (access_type access_type)
    (management_uri management_uri-1)
    (management_uri_new management_uri_new-0) (value value) (c c-1)
    (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 6) (2 9)) ((1 4) (2 4)) ((2 5) (0 0))
    ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)) ((3 6) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 7)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 428)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

<p id="k430">Item <a href="#t341">430</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 290.221 824.482 240.602 1234.004'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1314.960 Q 142.920 1277.460 45.960 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 186.900 414.960 233.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <path
   d='M 39.960 939.960 Q 136.920 902.460 233.880 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token_new) (access_type access_type) (management_uri management_uri-1) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new) (response response_error) (response_error response) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 430 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access management_uri access-0
      management_uri-0 management_uri_new access-1 management_uri-1
      data) (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token_new)
    (access_type access_type) (management_uri management_uri-1)
    (value value) (c c-1) (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 6) (2 9)) ((1 4) (2 4)) ((2 5) (0 0))
    ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)) ((3 4) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 5)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 430)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

<p id="k432">Item <a href="#t341">432</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 564.960 Q 190.461 824.513 141.042 1084.066'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-0 n2-0 (pubk c-0))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1164.960 Q 92.940 1164.960 45.960 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <path
   d='M 39.960 939.960 Q 86.940 939.960 133.920 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 789.960 Q 86.940 789.960 133.920 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access-0) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (value value) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (c c) (as as-0) (rs rs))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 432 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 text)
    (access_token_new value access_type response response_error
      response_new access management_uri management_uri_new access-0
      access_token management_uri-0 management_uri_new-0 data)
    (as c as-0 rs c-0 rs-0 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (c c) (as as-0) (rs rs))
  (defstrand authorization_server 7 (n1 n1-0) (n2 n2-0)
    (access access-0) (access_token access_token)
    (access_token_new access_token_new) (access_type access_type)
    (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (value value) (c c-0)
    (as as) (rs rs-0))
  (precedes ((0 1) (1 6)) ((0 4) (1 9)) ((0 6) (1 11)) ((1 5) (0 0))
    ((1 7) (0 2)) ((1 8) (0 3)) ((1 14) (0 7)) ((2 4) (1 4))
    ((2 6) (1 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n4 n3 n1 n2-0)
  (operation encryption-test (displaced 1 3 authorization_server 7)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 432)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-0 (2 1)) (n4 (0 1)) (n1 (1 0)) (n3 (1 5))))</pre>

<p id="k433">Item <a href="#t341">433</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 290.421 824.513 241.002 1084.066'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token-0 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 142.920 1127.460 45.960 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 186.900 414.960 233.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <path
   d='M 39.960 939.960 Q 136.920 902.460 233.880 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 789.960 Q 136.920 752.460 233.880 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token-0) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-1) (management_uri_new management_uri_new-0) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new) (response response) (response_error response_error) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 433 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access management_uri access-0
      management_uri-0 management_uri_new access-1 access_token-0
      management_uri-1 management_uri_new-0 data)
    (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token-0)
    (access_token_new access_token_new) (access_type access_type)
    (management_uri management_uri-1)
    (management_uri_new management_uri_new-0) (value value) (c c-1)
    (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 4) (2 9)) ((0 6) (2 11)) ((1 4) (2 4))
    ((2 5) (0 0)) ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7))
    ((3 6) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 7)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 433)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

<p id="k435">Item <a href="#t341">435</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 290.299 749.492 240.759 1084.025'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 142.920 1127.460 45.960 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 186.900 414.960 233.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <path
   d='M 39.960 939.960 Q 136.920 902.460 233.880 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 789.960 Q 136.920 752.460 233.880 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token_new) (access_type access_type) (management_uri management_uri-1) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new) (response response) (response_error response_error) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 435 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access management_uri access-0
      management_uri-0 management_uri_new access-1 management_uri-1
      data) (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token_new)
    (access_type access_type) (management_uri management_uri-1)
    (value value) (c c-1) (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 4) (2 9)) ((0 6) (2 11)) ((1 4) (2 4))
    ((2 5) (0 0)) ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7))
    ((3 4) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 5)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 435)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

<p id="k436">Item <a href="#t341">436</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 564.960 Q 190.461 824.513 141.042 1084.066'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-0 n2-0 (pubk c-0))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1164.960 Q 92.940 1164.960 45.960 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 789.960 Q 86.940 789.960 133.920 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access-0) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-0) (management_uri_new management_uri_new-0) (value value) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (c c) (as as-0) (rs rs))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 436 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 text)
    (access_token_new value access_type response response_error
      response_new access management_uri management_uri_new access-0
      access_token management_uri-0 management_uri_new-0 data)
    (as c as-0 rs c-0 rs-0 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (c c) (as as-0) (rs rs))
  (defstrand authorization_server 7 (n1 n1-0) (n2 n2-0)
    (access access-0) (access_token access_token)
    (access_token_new access_token_new) (access_type access_type)
    (management_uri management_uri-0)
    (management_uri_new management_uri_new-0) (value value) (c c-0)
    (as as) (rs rs-0))
  (precedes ((0 1) (1 6)) ((0 4) (1 9)) ((1 5) (0 0)) ((1 7) (0 2))
    ((1 8) (0 3)) ((1 14) (0 7)) ((2 4) (1 4)) ((2 6) (1 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n4 n3 n1 n2-0)
  (operation encryption-test (displaced 1 3 authorization_server 7)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 436)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-0 (2 1)) (n4 (0 1)) (n1 (1 0)) (n3 (1 5))))</pre>

<p id="k437">Item <a href="#t341">437</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 290.421 824.513 241.002 1084.066'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new-0 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token-0 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token-0 value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 142.920 1127.460 45.960 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 186.900 414.960 233.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 789.960 Q 136.920 752.460 233.880 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token-0) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-1) (management_uri_new management_uri_new-0) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new) (response response) (response_error response) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 437 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access management_uri access-0
      management_uri-0 management_uri_new access-1 access_token-0
      management_uri-1 management_uri_new-0 data)
    (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 7 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token-0)
    (access_token_new access_token_new) (access_type access_type)
    (management_uri management_uri-1)
    (management_uri_new management_uri_new-0) (value value) (c c-1)
    (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 4) (2 9)) ((1 4) (2 4)) ((2 5) (0 0))
    ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)) ((3 6) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 7)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 437)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

<p id="k439">Item <a href="#t341">439</a>, Parent: <a href="#k341">341</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 290.299 749.492 240.759 1084.025'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri-1 (enc (enc access_token_new value access_type (privk as)) (pubk rs-1)) (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-1 access-1 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-1 n2-1 (pubk c-1))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-1 n1-1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 142.920 1127.460 45.960 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri-0 (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c-0 access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c-0 n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 186.900 414.960 233.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 789.960 Q 136.920 752.460 233.880 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs-0)) (hash n3 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n3 n4 (pubk c-0))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c-0 n3 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-1) (access access-1) (access_token access_token_new) (access_type access_type) (management_uri management_uri-1) (value value) (c c-1) (as as) (rs rs-1))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs-0))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4) (access access-0) (management_uri management_uri-0) (management_uri_new management_uri_new) (response response) (response_error response) (c c-0) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c-0) (as as) (rs rs-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 439 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n4 n3 n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access_token access_token_new value access_type response
      response_error response_new access management_uri access-0
      management_uri-0 management_uri_new access-1 management_uri-1
      data) (as c rs c-0 as-0 rs-0 c-1 rs-1 name))
  (defstrand resource_server 9 (n3 n3) (n4 n4)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c-0)
    (as as) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand client 15
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs-0)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs-0))) (n1 n1-0) (n2 n2-0) (n3 n3) (n4 n4)
    (access access-0) (management_uri management_uri-0)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (c c-0) (as as-0) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1-1) (n2 n2-1)
    (access access-1) (access_token access_token_new)
    (access_type access_type) (management_uri management_uri-1)
    (value value) (c c-1) (as as) (rs rs-1))
  (precedes ((0 1) (2 6)) ((0 4) (2 9)) ((1 4) (2 4)) ((2 5) (0 0))
    ((2 7) (0 2)) ((2 8) (0 3)) ((2 14) (0 7)) ((3 4) (2 13)))
  (neq (c-0 as) (c-0 rs-0) (as rs-0))
  (non-orig (privk as) (privk c-0) (privk rs-0))
  (uniq-orig n4 n3 n2 n1-0 n2-1)
  (operation encryption-test (added-strand authorization_server 5)
    (enc access_token_new value access_type (privk as)) (2 13))
  (label 439)
  (parent 341)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c-0) (as as) (rs rs-0) (n4 n4) (access_token access_token)
        (access_token_new access_token_new) (value value)
        (access_type access_type) (response response)
        (response_error response_error) (response_new response_new)
        (n3 n3))))
  (origs (n2-1 (3 1)) (n4 (0 1)) (n1-0 (2 0)) (n3 (2 5)) (n2 (1 1))))</pre>

</body>
</html>
