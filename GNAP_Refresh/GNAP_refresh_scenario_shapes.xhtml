<?xml version="1.0"?>
<!-- CPSA 3.6.9 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Grant Negotiation and Authorization Protocol</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(comment &quot;CPSA 3.6.9&quot;)
(comment &quot;Extracted shapes&quot;)
(herald &quot;Grant Negotiation and Authorization Protocol&quot; (limit 20000)
  (comment
    &quot;This protocol allows a piece of software, the client instance, to request delegated authorization to resource servers and to request direct information&quot;))
(comment &quot;CPSA 3.6.9&quot;)
(comment &quot;All input read from GNAP_refresh_scenario.scm&quot;)
(comment &quot;Step count limited to 20000&quot;)</pre>

<p id="t0">Tree 0, POV <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='25204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 25204.920' font-size='12.000'>
  <text
   x='89.880' y='25151.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8201&quot;, &quot;_self&quot;)'>8201</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='25164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='25076.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8191&quot;, &quot;_self&quot;)'>8191</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='25089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='25001.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8177&quot;, &quot;_self&quot;)'>8177</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='25014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='24926.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8158&quot;, &quot;_self&quot;)'>8158</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='24939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='24851.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8157&quot;, &quot;_self&quot;)'>8157</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='24864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='24776.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8151&quot;, &quot;_self&quot;)'>8151</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='24789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='24701.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8150&quot;, &quot;_self&quot;)'>8150</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='24714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='24626.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8144&quot;, &quot;_self&quot;)'>8144</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='24639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='24551.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8143&quot;, &quot;_self&quot;)'>8143</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='24564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='24476.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8113&quot;, &quot;_self&quot;)'>8113</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='24489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='24401.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8111&quot;, &quot;_self&quot;)'>8111</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='24414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='24326.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8101&quot;, &quot;_self&quot;)'>8101</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='24339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='24251.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8100&quot;, &quot;_self&quot;)'>8100</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='24264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='24176.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8098&quot;, &quot;_self&quot;)'>8098</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='24189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='24101.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8097&quot;, &quot;_self&quot;)'>8097</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='24114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='24026.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8055&quot;, &quot;_self&quot;)'>8055</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='24039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='23951.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8054&quot;, &quot;_self&quot;)'>8054</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='23964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='23876.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8051&quot;, &quot;_self&quot;)'>8051</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='23889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='23801.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8050&quot;, &quot;_self&quot;)'>8050</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='23814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='23726.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8027&quot;, &quot;_self&quot;)'>8027</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='23739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='23651.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8024&quot;, &quot;_self&quot;)'>8024</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='23664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='23576.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8008&quot;, &quot;_self&quot;)'>8008</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='23589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='23501.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7998&quot;, &quot;_self&quot;)'>7998</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='23514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='23426.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7984&quot;, &quot;_self&quot;)'>7984</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='23439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='23351.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7965&quot;, &quot;_self&quot;)'>7965</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='23364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='23276.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7964&quot;, &quot;_self&quot;)'>7964</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='23289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='23201.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7958&quot;, &quot;_self&quot;)'>7958</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='23214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='23126.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7957&quot;, &quot;_self&quot;)'>7957</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='23139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='23051.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7951&quot;, &quot;_self&quot;)'>7951</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='23064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='22976.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7950&quot;, &quot;_self&quot;)'>7950</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='22989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='22901.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7920&quot;, &quot;_self&quot;)'>7920</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='22914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='22826.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7918&quot;, &quot;_self&quot;)'>7918</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='22839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='22751.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7908&quot;, &quot;_self&quot;)'>7908</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='22764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='22676.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7907&quot;, &quot;_self&quot;)'>7907</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='22689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='22601.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7905&quot;, &quot;_self&quot;)'>7905</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='22614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='22526.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7904&quot;, &quot;_self&quot;)'>7904</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='22539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='22451.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7853&quot;, &quot;_self&quot;)'>7853</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='22464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='22376.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7847&quot;, &quot;_self&quot;)'>7847</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='22389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='22301.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7831&quot;, &quot;_self&quot;)'>7831</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='22314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='22226.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7828&quot;, &quot;_self&quot;)'>7828</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='22239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='22151.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7825&quot;, &quot;_self&quot;)'>7825</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='22164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='22076.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7810&quot;, &quot;_self&quot;)'>7810</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='22089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='22001.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7809&quot;, &quot;_self&quot;)'>7809</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='22014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='21926.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7807&quot;, &quot;_self&quot;)'>7807</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='21939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='21851.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7806&quot;, &quot;_self&quot;)'>7806</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='21864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='21776.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7804&quot;, &quot;_self&quot;)'>7804</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='21789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='21701.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7714&quot;, &quot;_self&quot;)'>7714</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='21714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='21626.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7712&quot;, &quot;_self&quot;)'>7712</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='21639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='21551.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7702&quot;, &quot;_self&quot;)'>7702</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='21564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='21476.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7701&quot;, &quot;_self&quot;)'>7701</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='21489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='21401.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7699&quot;, &quot;_self&quot;)'>7699</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='21414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='21326.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7698&quot;, &quot;_self&quot;)'>7698</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='21339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='21251.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7658&quot;, &quot;_self&quot;)'>7658</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='21264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='21176.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7657&quot;, &quot;_self&quot;)'>7657</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='21189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='21101.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7629&quot;, &quot;_self&quot;)'>7629</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='21114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='21026.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7609&quot;, &quot;_self&quot;)'>7609</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='21039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='20951.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7607&quot;, &quot;_self&quot;)'>7607</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='20964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='20876.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7595&quot;, &quot;_self&quot;)'>7595</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='20889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='20801.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7594&quot;, &quot;_self&quot;)'>7594</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='20814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='20726.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7588&quot;, &quot;_self&quot;)'>7588</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='20739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='20651.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7587&quot;, &quot;_self&quot;)'>7587</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='20664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='20576.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7495&quot;, &quot;_self&quot;)'>7495</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='20589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='20501.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7493&quot;, &quot;_self&quot;)'>7493</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='20514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='20426.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7483&quot;, &quot;_self&quot;)'>7483</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='20439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='20351.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7482&quot;, &quot;_self&quot;)'>7482</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='20364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='20276.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7480&quot;, &quot;_self&quot;)'>7480</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='20289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='20201.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7479&quot;, &quot;_self&quot;)'>7479</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='20214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='20126.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7439&quot;, &quot;_self&quot;)'>7439</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='20139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='20051.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7438&quot;, &quot;_self&quot;)'>7438</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='20064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='19976.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7410&quot;, &quot;_self&quot;)'>7410</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='19989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='19901.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7390&quot;, &quot;_self&quot;)'>7390</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='19914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='19826.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7388&quot;, &quot;_self&quot;)'>7388</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='19839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='19751.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7376&quot;, &quot;_self&quot;)'>7376</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='19764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='19676.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7375&quot;, &quot;_self&quot;)'>7375</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='19689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='19601.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7369&quot;, &quot;_self&quot;)'>7369</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='19614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='19526.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7368&quot;, &quot;_self&quot;)'>7368</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='19539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='19451.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7321&quot;, &quot;_self&quot;)'>7321</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='19464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='19376.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7320&quot;, &quot;_self&quot;)'>7320</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='19389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='19301.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7318&quot;, &quot;_self&quot;)'>7318</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='19314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='19226.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7317&quot;, &quot;_self&quot;)'>7317</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='19239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='19151.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7315&quot;, &quot;_self&quot;)'>7315</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='19164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='19076.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7295&quot;, &quot;_self&quot;)'>7295</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='19089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='19001.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7293&quot;, &quot;_self&quot;)'>7293</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='19014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='18926.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7291&quot;, &quot;_self&quot;)'>7291</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='18939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='18851.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7283&quot;, &quot;_self&quot;)'>7283</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='18864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='18776.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7277&quot;, &quot;_self&quot;)'>7277</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='18789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='18701.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6877&quot;, &quot;_self&quot;)'>6877</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='18714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='18626.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6871&quot;, &quot;_self&quot;)'>6871</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='18639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='18551.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6855&quot;, &quot;_self&quot;)'>6855</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='18564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='18476.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6852&quot;, &quot;_self&quot;)'>6852</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='18489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='18401.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6849&quot;, &quot;_self&quot;)'>6849</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='18414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='18326.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6838&quot;, &quot;_self&quot;)'>6838</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='18339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='18251.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6837&quot;, &quot;_self&quot;)'>6837</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='18264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='18176.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6835&quot;, &quot;_self&quot;)'>6835</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='18189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='18101.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6834&quot;, &quot;_self&quot;)'>6834</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='18114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='18026.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6831&quot;, &quot;_self&quot;)'>6831</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='18039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='17951.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6793&quot;, &quot;_self&quot;)'>6793</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='17964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='17876.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6787&quot;, &quot;_self&quot;)'>6787</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='17889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='17801.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6771&quot;, &quot;_self&quot;)'>6771</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='17814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='17726.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6768&quot;, &quot;_self&quot;)'>6768</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='17739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='17651.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6765&quot;, &quot;_self&quot;)'>6765</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='17664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='17576.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6754&quot;, &quot;_self&quot;)'>6754</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='17589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='17501.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6753&quot;, &quot;_self&quot;)'>6753</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='17514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='17426.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6751&quot;, &quot;_self&quot;)'>6751</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='17439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='17351.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6750&quot;, &quot;_self&quot;)'>6750</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='17364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='17276.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6747&quot;, &quot;_self&quot;)'>6747</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='17289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='17201.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6712&quot;, &quot;_self&quot;)'>6712</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='17214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='17126.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6706&quot;, &quot;_self&quot;)'>6706</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='17139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='17051.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6690&quot;, &quot;_self&quot;)'>6690</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='17064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='16976.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6687&quot;, &quot;_self&quot;)'>6687</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='16989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='16901.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6684&quot;, &quot;_self&quot;)'>6684</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='16914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='16826.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6646&quot;, &quot;_self&quot;)'>6646</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='16839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='16751.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6645&quot;, &quot;_self&quot;)'>6645</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='16764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='16676.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6643&quot;, &quot;_self&quot;)'>6643</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='16689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='16601.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6642&quot;, &quot;_self&quot;)'>6642</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='16614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='16526.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6639&quot;, &quot;_self&quot;)'>6639</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='16539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='16451.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6621&quot;, &quot;_self&quot;)'>6621</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='16464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='16376.041'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6619&quot;, &quot;_self&quot;)'>6619</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='16389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='16301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6617&quot;, &quot;_self&quot;)'>6617</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='16314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='16226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6609&quot;, &quot;_self&quot;)'>6609</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='16239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='16151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6603&quot;, &quot;_self&quot;)'>6603</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='16164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='16076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6548&quot;, &quot;_self&quot;)'>6548</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='16089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='16001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6547&quot;, &quot;_self&quot;)'>6547</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='16014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6545&quot;, &quot;_self&quot;)'>6545</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='15939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6544&quot;, &quot;_self&quot;)'>6544</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='15864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6541&quot;, &quot;_self&quot;)'>6541</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='15789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6523&quot;, &quot;_self&quot;)'>6523</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='15714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6521&quot;, &quot;_self&quot;)'>6521</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='15639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6519&quot;, &quot;_self&quot;)'>6519</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='15564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6511&quot;, &quot;_self&quot;)'>6511</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='15489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6505&quot;, &quot;_self&quot;)'>6505</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='15414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6444&quot;, &quot;_self&quot;)'>6444</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='15339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6442&quot;, &quot;_self&quot;)'>6442</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='15264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6440&quot;, &quot;_self&quot;)'>6440</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='15189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6432&quot;, &quot;_self&quot;)'>6432</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='15114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6426&quot;, &quot;_self&quot;)'>6426</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='15039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5276&quot;, &quot;_self&quot;)'>5276</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='14964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5273&quot;, &quot;_self&quot;)'>5273</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='14889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5234&quot;, &quot;_self&quot;)'>5234</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='14814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14726.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5231&quot;, &quot;_self&quot;)'>5231</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='14739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5147&quot;, &quot;_self&quot;)'>5147</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='14664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5143&quot;, &quot;_self&quot;)'>5143</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='14589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5141&quot;, &quot;_self&quot;)'>5141</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='14514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5126&quot;, &quot;_self&quot;)'>5126</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='14439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5124&quot;, &quot;_self&quot;)'>5124</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='14364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14276.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5080&quot;, &quot;_self&quot;)'>5080</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='14289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5076&quot;, &quot;_self&quot;)'>5076</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='14214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5074&quot;, &quot;_self&quot;)'>5074</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='14139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5059&quot;, &quot;_self&quot;)'>5059</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='14064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5057&quot;, &quot;_self&quot;)'>5057</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='13989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5032&quot;, &quot;_self&quot;)'>5032</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='13914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5030&quot;, &quot;_self&quot;)'>5030</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='13839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5028&quot;, &quot;_self&quot;)'>5028</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='13764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4889&quot;, &quot;_self&quot;)'>4889</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='13689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4886&quot;, &quot;_self&quot;)'>4886</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='13614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4847&quot;, &quot;_self&quot;)'>4847</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='13539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4844&quot;, &quot;_self&quot;)'>4844</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='13464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4760&quot;, &quot;_self&quot;)'>4760</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='13389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4756&quot;, &quot;_self&quot;)'>4756</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='13314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4754&quot;, &quot;_self&quot;)'>4754</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='13239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4739&quot;, &quot;_self&quot;)'>4739</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='13164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4737&quot;, &quot;_self&quot;)'>4737</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='13089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4693&quot;, &quot;_self&quot;)'>4693</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='13014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4689&quot;, &quot;_self&quot;)'>4689</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='12939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4687&quot;, &quot;_self&quot;)'>4687</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='12864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4672&quot;, &quot;_self&quot;)'>4672</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='12789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4670&quot;, &quot;_self&quot;)'>4670</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='12714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4645&quot;, &quot;_self&quot;)'>4645</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='12639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4643&quot;, &quot;_self&quot;)'>4643</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='12564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4641&quot;, &quot;_self&quot;)'>4641</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='12489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4527&quot;, &quot;_self&quot;)'>4527</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='12414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4525&quot;, &quot;_self&quot;)'>4525</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='12339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4523&quot;, &quot;_self&quot;)'>4523</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='12264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4499&quot;, &quot;_self&quot;)'>4499</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='12189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4497&quot;, &quot;_self&quot;)'>4497</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='12114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4495&quot;, &quot;_self&quot;)'>4495</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='12039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4471&quot;, &quot;_self&quot;)'>4471</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='11964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4469&quot;, &quot;_self&quot;)'>4469</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='11889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4467&quot;, &quot;_self&quot;)'>4467</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='11814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11726.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4135&quot;, &quot;_self&quot;)'>4135</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='11739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4129&quot;, &quot;_self&quot;)'>4129</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='11664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4123&quot;, &quot;_self&quot;)'>4123</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='11589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4111&quot;, &quot;_self&quot;)'>4111</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='11514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4108&quot;, &quot;_self&quot;)'>4108</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='11439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4094&quot;, &quot;_self&quot;)'>4094</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='11364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11276.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4093&quot;, &quot;_self&quot;)'>4093</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='11289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4091&quot;, &quot;_self&quot;)'>4091</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='11214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4090&quot;, &quot;_self&quot;)'>4090</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='11139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4049&quot;, &quot;_self&quot;)'>4049</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='11064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4043&quot;, &quot;_self&quot;)'>4043</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='10989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4037&quot;, &quot;_self&quot;)'>4037</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='10914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4025&quot;, &quot;_self&quot;)'>4025</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='10839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4022&quot;, &quot;_self&quot;)'>4022</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='10764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4008&quot;, &quot;_self&quot;)'>4008</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='10689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4007&quot;, &quot;_self&quot;)'>4007</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='10614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4005&quot;, &quot;_self&quot;)'>4005</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='10539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4004&quot;, &quot;_self&quot;)'>4004</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='10464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3971&quot;, &quot;_self&quot;)'>3971</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='10389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3968&quot;, &quot;_self&quot;)'>3968</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='10314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3965&quot;, &quot;_self&quot;)'>3965</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='10239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3922&quot;, &quot;_self&quot;)'>3922</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='10164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3921&quot;, &quot;_self&quot;)'>3921</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='10089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3919&quot;, &quot;_self&quot;)'>3919</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='10014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3918&quot;, &quot;_self&quot;)'>3918</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='9939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3897&quot;, &quot;_self&quot;)'>3897</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='9864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3895&quot;, &quot;_self&quot;)'>3895</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='9789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3885&quot;, &quot;_self&quot;)'>3885</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='9714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3879&quot;, &quot;_self&quot;)'>3879</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='9639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3848&quot;, &quot;_self&quot;)'>3848</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='9564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3847&quot;, &quot;_self&quot;)'>3847</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='9489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3820&quot;, &quot;_self&quot;)'>3820</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='9414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3819&quot;, &quot;_self&quot;)'>3819</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='9339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3817&quot;, &quot;_self&quot;)'>3817</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='9264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3816&quot;, &quot;_self&quot;)'>3816</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='9189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3795&quot;, &quot;_self&quot;)'>3795</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='9114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3793&quot;, &quot;_self&quot;)'>3793</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='9039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3783&quot;, &quot;_self&quot;)'>3783</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='8964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3777&quot;, &quot;_self&quot;)'>3777</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='8889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3746&quot;, &quot;_self&quot;)'>3746</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='8814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8726.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3745&quot;, &quot;_self&quot;)'>3745</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='8739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3695&quot;, &quot;_self&quot;)'>3695</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='8664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3693&quot;, &quot;_self&quot;)'>3693</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='8589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3691&quot;, &quot;_self&quot;)'>3691</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='8514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3369&quot;, &quot;_self&quot;)'>3369</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='8439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3363&quot;, &quot;_self&quot;)'>3363</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='8364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8276.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3357&quot;, &quot;_self&quot;)'>3357</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='8289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3345&quot;, &quot;_self&quot;)'>3345</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='8214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3342&quot;, &quot;_self&quot;)'>3342</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='8139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3328&quot;, &quot;_self&quot;)'>3328</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='8064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3327&quot;, &quot;_self&quot;)'>3327</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='7989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3325&quot;, &quot;_self&quot;)'>3325</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='7914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3324&quot;, &quot;_self&quot;)'>3324</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='7839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3283&quot;, &quot;_self&quot;)'>3283</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='7764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3277&quot;, &quot;_self&quot;)'>3277</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='7689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3271&quot;, &quot;_self&quot;)'>3271</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='7614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3259&quot;, &quot;_self&quot;)'>3259</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='7539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3256&quot;, &quot;_self&quot;)'>3256</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='7464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3242&quot;, &quot;_self&quot;)'>3242</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='7389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3241&quot;, &quot;_self&quot;)'>3241</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='7314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3239&quot;, &quot;_self&quot;)'>3239</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='7239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3238&quot;, &quot;_self&quot;)'>3238</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='7164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3205&quot;, &quot;_self&quot;)'>3205</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='7089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3202&quot;, &quot;_self&quot;)'>3202</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='7014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3199&quot;, &quot;_self&quot;)'>3199</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='6939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3156&quot;, &quot;_self&quot;)'>3156</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='6864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3155&quot;, &quot;_self&quot;)'>3155</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='6789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3153&quot;, &quot;_self&quot;)'>3153</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='6714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3152&quot;, &quot;_self&quot;)'>3152</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='6639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3131&quot;, &quot;_self&quot;)'>3131</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='6564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3129&quot;, &quot;_self&quot;)'>3129</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='6489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3119&quot;, &quot;_self&quot;)'>3119</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='6414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3113&quot;, &quot;_self&quot;)'>3113</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='6339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3082&quot;, &quot;_self&quot;)'>3082</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='6264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3081&quot;, &quot;_self&quot;)'>3081</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='6189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3054&quot;, &quot;_self&quot;)'>3054</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='6114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3053&quot;, &quot;_self&quot;)'>3053</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='6039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3051&quot;, &quot;_self&quot;)'>3051</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='5964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3050&quot;, &quot;_self&quot;)'>3050</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='5889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3029&quot;, &quot;_self&quot;)'>3029</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='5814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5726.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3027&quot;, &quot;_self&quot;)'>3027</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='5739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3017&quot;, &quot;_self&quot;)'>3017</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='5664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3011&quot;, &quot;_self&quot;)'>3011</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='5589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2980&quot;, &quot;_self&quot;)'>2980</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='5514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2979&quot;, &quot;_self&quot;)'>2979</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='5439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2929&quot;, &quot;_self&quot;)'>2929</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='5364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5276.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2927&quot;, &quot;_self&quot;)'>2927</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='5289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2925&quot;, &quot;_self&quot;)'>2925</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='5214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2784&quot;, &quot;_self&quot;)'>2784</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='5139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2781&quot;, &quot;_self&quot;)'>2781</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='5064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2778&quot;, &quot;_self&quot;)'>2778</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='4989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2750&quot;, &quot;_self&quot;)'>2750</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='4914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2747&quot;, &quot;_self&quot;)'>2747</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='4839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2744&quot;, &quot;_self&quot;)'>2744</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='4764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2716&quot;, &quot;_self&quot;)'>2716</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='4689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2713&quot;, &quot;_self&quot;)'>2713</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='4614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2710&quot;, &quot;_self&quot;)'>2710</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='4539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2657&quot;, &quot;_self&quot;)'>2657</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='4464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2655&quot;, &quot;_self&quot;)'>2655</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='4389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2653&quot;, &quot;_self&quot;)'>2653</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='4314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2612&quot;, &quot;_self&quot;)'>2612</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='4239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2610&quot;, &quot;_self&quot;)'>2610</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='4164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2608&quot;, &quot;_self&quot;)'>2608</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='4089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2570&quot;, &quot;_self&quot;)'>2570</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='4014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2568&quot;, &quot;_self&quot;)'>2568</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='3939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2566&quot;, &quot;_self&quot;)'>2566</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='3864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2140&quot;, &quot;_self&quot;)'>2140</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='3789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2138&quot;, &quot;_self&quot;)'>2138</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='3714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2112&quot;, &quot;_self&quot;)'>2112</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='3639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2110&quot;, &quot;_self&quot;)'>2110</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='3564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1998&quot;, &quot;_self&quot;)'>1998</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='3489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1996&quot;, &quot;_self&quot;)'>1996</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='3414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1970&quot;, &quot;_self&quot;)'>1970</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='3339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1968&quot;, &quot;_self&quot;)'>1968</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='3264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1762&quot;, &quot;_self&quot;)'>1762</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='3189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1759&quot;, &quot;_self&quot;)'>1759</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='3114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1728&quot;, &quot;_self&quot;)'>1728</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='3039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1725&quot;, &quot;_self&quot;)'>1725</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='2964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1656&quot;, &quot;_self&quot;)'>1656</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='2889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1646&quot;, &quot;_self&quot;)'>1646</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='2814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2726.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1644&quot;, &quot;_self&quot;)'>1644</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='2739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1609&quot;, &quot;_self&quot;)'>1609</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='2664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1599&quot;, &quot;_self&quot;)'>1599</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='2589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1597&quot;, &quot;_self&quot;)'>1597</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='2514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1576&quot;, &quot;_self&quot;)'>1576</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='2439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1574&quot;, &quot;_self&quot;)'>1574</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='2364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2276.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1572&quot;, &quot;_self&quot;)'>1572</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='2289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1447&quot;, &quot;_self&quot;)'>1447</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='2214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1444&quot;, &quot;_self&quot;)'>1444</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='2139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1413&quot;, &quot;_self&quot;)'>1413</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='2064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1410&quot;, &quot;_self&quot;)'>1410</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='1989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1341&quot;, &quot;_self&quot;)'>1341</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='1914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1331&quot;, &quot;_self&quot;)'>1331</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1329&quot;, &quot;_self&quot;)'>1329</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='1764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1294&quot;, &quot;_self&quot;)'>1294</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1284&quot;, &quot;_self&quot;)'>1284</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1282&quot;, &quot;_self&quot;)'>1282</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1261&quot;, &quot;_self&quot;)'>1261</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1259&quot;, &quot;_self&quot;)'>1259</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1257&quot;, &quot;_self&quot;)'>1257</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1155&quot;, &quot;_self&quot;)'>1155</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1153&quot;, &quot;_self&quot;)'>1153</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1151&quot;, &quot;_self&quot;)'>1151</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1133&quot;, &quot;_self&quot;)'>1133</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1131&quot;, &quot;_self&quot;)'>1131</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1129&quot;, &quot;_self&quot;)'>1129</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1111&quot;, &quot;_self&quot;)'>1111</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1109&quot;, &quot;_self&quot;)'>1109</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1107&quot;, &quot;_self&quot;)'>1107</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k765&quot;, &quot;_self&quot;)'>765</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k763&quot;, &quot;_self&quot;)'>763</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k743&quot;, &quot;_self&quot;)'>743</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k741&quot;, &quot;_self&quot;)'>741</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k641&quot;, &quot;_self&quot;)'>641</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k639&quot;, &quot;_self&quot;)'>639</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k619&quot;, &quot;_self&quot;)'>619</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k617&quot;, &quot;_self&quot;)'>617</text>
  <line
   x1='39.960' y1='12602.460' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='12588.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol token_refresh basic
  (defrole client
    (vars (c as rs name)
      (access management_uri management_uri_new response response_error
        response_new data) (n1 n2 n3 n4 text) (token token_new mesg))
    (trace (send (enc c n1 (pubk as))) (recv (enc as n1 n2 (pubk c)))
      (send (enc n2 (pubk as))) (send (enc c access (hash n1 n2)))
      (recv (enc management_uri token (hash n1 n2)))
      (send (enc c n3 (pubk rs))) (recv (enc rs n3 n4 (pubk c)))
      (send (enc n4 (pubk rs))) (send (enc token (hash n3 n4)))
      (recv (enc response (hash n3 n4))) (send (enc token (hash n3 n4)))
      (recv (enc response_error (hash n3 n4)))
      (send (enc token (hash n1 n2)))
      (recv (enc management_uri_new token_new (hash n1 n2)))
      (send (enc token_new (hash n3 n4)))
      (recv (enc response_new (hash n3 n4)))))
  (defrole authorization_server
    (vars (c as name)
      (access access_token access_token_new access_type management_uri
        management_uri_new value data) (n1 n2 text))
    (trace (recv (enc c n1 (pubk as))) (send (enc as n1 n2 (pubk c)))
      (recv (enc n2 (pubk as))) (recv (enc c access (hash n1 n2)))
      (send
        (enc management_uri
          (enc access_token value access_type (privk as)) (hash n1 n2)))
      (recv
        (enc (enc access_token value access_type (privk as))
          (hash n1 n2)))
      (send
        (enc management_uri_new
          (enc access_token_new value access_type (privk as))
          (hash n1 n2)))))
  (defrole resource_server
    (vars (c as rs name)
      (access_token access_token_new value access_type response
        response_error response_new data) (n3 n4 text))
    (trace (recv (enc c n3 (pubk rs))) (send (enc rs n3 n4 (pubk c)))
      (recv (enc n4 (pubk rs)))
      (recv
        (enc (enc access_token value access_type (privk as))
          (hash n3 n4))) (send (enc response (hash n3 n4)))
      (recv
        (enc (enc access_token value access_type (privk as))
          (hash n3 n4))) (send (enc response_error (hash n3 n4)))
      (recv
        (enc (enc access_token_new value access_type (privk as))
          (hash n3 n4))) (send (enc response_new (hash n3 n4))))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Children: <a href="#k617">617</a> <a href="#k619">619</a> <a href="#k639">639</a> <a href="#k641">641</a> <a href="#k741">741</a> <a href="#k743">743</a> <a href="#k763">763</a> <a href="#k765">765</a> <a href="#k1107">1107</a> <a href="#k1109">1109</a> <a href="#k1111">1111</a> <a href="#k1129">1129</a> <a href="#k1131">1131</a> <a href="#k1133">1133</a> <a href="#k1151">1151</a> <a href="#k1153">1153</a> <a href="#k1155">1155</a> <a href="#k1257">1257</a> <a href="#k1259">1259</a> <a href="#k1261">1261</a> <a href="#k1282">1282</a> <a href="#k1284">1284</a> <a href="#k1294">1294</a> <a href="#k1329">1329</a> <a href="#k1331">1331</a> <a href="#k1341">1341</a> <a href="#k1410">1410</a> <a href="#k1413">1413</a> <a href="#k1444">1444</a> <a href="#k1447">1447</a> <a href="#k1572">1572</a> <a href="#k1574">1574</a> <a href="#k1576">1576</a> <a href="#k1597">1597</a> <a href="#k1599">1599</a> <a href="#k1609">1609</a> <a href="#k1644">1644</a> <a href="#k1646">1646</a> <a href="#k1656">1656</a> <a href="#k1725">1725</a> <a href="#k1728">1728</a> <a href="#k1759">1759</a> <a href="#k1762">1762</a> <a href="#k1968">1968</a> <a href="#k1970">1970</a> <a href="#k1996">1996</a> <a href="#k1998">1998</a> <a href="#k2110">2110</a> <a href="#k2112">2112</a> <a href="#k2138">2138</a> <a href="#k2140">2140</a> <a href="#k2566">2566</a> <a href="#k2568">2568</a> <a href="#k2570">2570</a> <a href="#k2608">2608</a> <a href="#k2610">2610</a> <a href="#k2612">2612</a> <a href="#k2653">2653</a> <a href="#k2655">2655</a> <a href="#k2657">2657</a> <a href="#k2710">2710</a> <a href="#k2713">2713</a> <a href="#k2716">2716</a> <a href="#k2744">2744</a> <a href="#k2747">2747</a> <a href="#k2750">2750</a> <a href="#k2778">2778</a> <a href="#k2781">2781</a> <a href="#k2784">2784</a> <a href="#k2925">2925</a> <a href="#k2927">2927</a> <a href="#k2929">2929</a> <a href="#k2979">2979</a> <a href="#k2980">2980</a> <a href="#k3011">3011</a> <a href="#k3017">3017</a> <a href="#k3027">3027</a> <a href="#k3029">3029</a> <a href="#k3050">3050</a> <a href="#k3051">3051</a> <a href="#k3053">3053</a> <a href="#k3054">3054</a> <a href="#k3081">3081</a> <a href="#k3082">3082</a> <a href="#k3113">3113</a> <a href="#k3119">3119</a> <a href="#k3129">3129</a> <a href="#k3131">3131</a> <a href="#k3152">3152</a> <a href="#k3153">3153</a> <a href="#k3155">3155</a> <a href="#k3156">3156</a> <a href="#k3199">3199</a> <a href="#k3202">3202</a> <a href="#k3205">3205</a> <a href="#k3238">3238</a> <a href="#k3239">3239</a> <a href="#k3241">3241</a> <a href="#k3242">3242</a> <a href="#k3256">3256</a> <a href="#k3259">3259</a> <a href="#k3271">3271</a> <a href="#k3277">3277</a> <a href="#k3283">3283</a> <a href="#k3324">3324</a> <a href="#k3325">3325</a> <a href="#k3327">3327</a> <a href="#k3328">3328</a> <a href="#k3342">3342</a> <a href="#k3345">3345</a> <a href="#k3357">3357</a> <a href="#k3363">3363</a> <a href="#k3369">3369</a> <a href="#k3691">3691</a> <a href="#k3693">3693</a> <a href="#k3695">3695</a> <a href="#k3745">3745</a> <a href="#k3746">3746</a> <a href="#k3777">3777</a> <a href="#k3783">3783</a> <a href="#k3793">3793</a> <a href="#k3795">3795</a> <a href="#k3816">3816</a> <a href="#k3817">3817</a> <a href="#k3819">3819</a> <a href="#k3820">3820</a> <a href="#k3847">3847</a> <a href="#k3848">3848</a> <a href="#k3879">3879</a> <a href="#k3885">3885</a> <a href="#k3895">3895</a> <a href="#k3897">3897</a> <a href="#k3918">3918</a> <a href="#k3919">3919</a> <a href="#k3921">3921</a> <a href="#k3922">3922</a> <a href="#k3965">3965</a> <a href="#k3968">3968</a> <a href="#k3971">3971</a> <a href="#k4004">4004</a> <a href="#k4005">4005</a> <a href="#k4007">4007</a> <a href="#k4008">4008</a> <a href="#k4022">4022</a> <a href="#k4025">4025</a> <a href="#k4037">4037</a> <a href="#k4043">4043</a> <a href="#k4049">4049</a> <a href="#k4090">4090</a> <a href="#k4091">4091</a> <a href="#k4093">4093</a> <a href="#k4094">4094</a> <a href="#k4108">4108</a> <a href="#k4111">4111</a> <a href="#k4123">4123</a> <a href="#k4129">4129</a> <a href="#k4135">4135</a> <a href="#k4467">4467</a> <a href="#k4469">4469</a> <a href="#k4471">4471</a> <a href="#k4495">4495</a> <a href="#k4497">4497</a> <a href="#k4499">4499</a> <a href="#k4523">4523</a> <a href="#k4525">4525</a> <a href="#k4527">4527</a> <a href="#k4641">4641</a> <a href="#k4643">4643</a> <a href="#k4645">4645</a> <a href="#k4670">4670</a> <a href="#k4672">4672</a> <a href="#k4687">4687</a> <a href="#k4689">4689</a> <a href="#k4693">4693</a> <a href="#k4737">4737</a> <a href="#k4739">4739</a> <a href="#k4754">4754</a> <a href="#k4756">4756</a> <a href="#k4760">4760</a> <a href="#k4844">4844</a> <a href="#k4847">4847</a> <a href="#k4886">4886</a> <a href="#k4889">4889</a> <a href="#k5028">5028</a> <a href="#k5030">5030</a> <a href="#k5032">5032</a> <a href="#k5057">5057</a> <a href="#k5059">5059</a> <a href="#k5074">5074</a> <a href="#k5076">5076</a> <a href="#k5080">5080</a> <a href="#k5124">5124</a> <a href="#k5126">5126</a> <a href="#k5141">5141</a> <a href="#k5143">5143</a> <a href="#k5147">5147</a> <a href="#k5231">5231</a> <a href="#k5234">5234</a> <a href="#k5273">5273</a> <a href="#k5276">5276</a> <a href="#k6426">6426</a> <a href="#k6432">6432</a> <a href="#k6440">6440</a> <a href="#k6442">6442</a> <a href="#k6444">6444</a> <a href="#k6505">6505</a> <a href="#k6511">6511</a> <a href="#k6519">6519</a> <a href="#k6521">6521</a> <a href="#k6523">6523</a> <a href="#k6541">6541</a> <a href="#k6544">6544</a> <a href="#k6545">6545</a> <a href="#k6547">6547</a> <a href="#k6548">6548</a> <a href="#k6603">6603</a> <a href="#k6609">6609</a> <a href="#k6617">6617</a> <a href="#k6619">6619</a> <a href="#k6621">6621</a> <a href="#k6639">6639</a> <a href="#k6642">6642</a> <a href="#k6643">6643</a> <a href="#k6645">6645</a> <a href="#k6646">6646</a> <a href="#k6684">6684</a> <a href="#k6687">6687</a> <a href="#k6690">6690</a> <a href="#k6706">6706</a> <a href="#k6712">6712</a> <a href="#k6747">6747</a> <a href="#k6750">6750</a> <a href="#k6751">6751</a> <a href="#k6753">6753</a> <a href="#k6754">6754</a> <a href="#k6765">6765</a> <a href="#k6768">6768</a> <a href="#k6771">6771</a> <a href="#k6787">6787</a> <a href="#k6793">6793</a> <a href="#k6831">6831</a> <a href="#k6834">6834</a> <a href="#k6835">6835</a> <a href="#k6837">6837</a> <a href="#k6838">6838</a> <a href="#k6849">6849</a> <a href="#k6852">6852</a> <a href="#k6855">6855</a> <a href="#k6871">6871</a> <a href="#k6877">6877</a> <a href="#k7277">7277</a> <a href="#k7283">7283</a> <a href="#k7291">7291</a> <a href="#k7293">7293</a> <a href="#k7295">7295</a> <a href="#k7315">7315</a> <a href="#k7317">7317</a> <a href="#k7318">7318</a> <a href="#k7320">7320</a> <a href="#k7321">7321</a> <a href="#k7368">7368</a> <a href="#k7369">7369</a> <a href="#k7375">7375</a> <a href="#k7376">7376</a> <a href="#k7388">7388</a> <a href="#k7390">7390</a> <a href="#k7410">7410</a> <a href="#k7438">7438</a> <a href="#k7439">7439</a> <a href="#k7479">7479</a> <a href="#k7480">7480</a> <a href="#k7482">7482</a> <a href="#k7483">7483</a> <a href="#k7493">7493</a> <a href="#k7495">7495</a> <a href="#k7587">7587</a> <a href="#k7588">7588</a> <a href="#k7594">7594</a> <a href="#k7595">7595</a> <a href="#k7607">7607</a> <a href="#k7609">7609</a> <a href="#k7629">7629</a> <a href="#k7657">7657</a> <a href="#k7658">7658</a> <a href="#k7698">7698</a> <a href="#k7699">7699</a> <a href="#k7701">7701</a> <a href="#k7702">7702</a> <a href="#k7712">7712</a> <a href="#k7714">7714</a> <a href="#k7804">7804</a> <a href="#k7806">7806</a> <a href="#k7807">7807</a> <a href="#k7809">7809</a> <a href="#k7810">7810</a> <a href="#k7825">7825</a> <a href="#k7828">7828</a> <a href="#k7831">7831</a> <a href="#k7847">7847</a> <a href="#k7853">7853</a> <a href="#k7904">7904</a> <a href="#k7905">7905</a> <a href="#k7907">7907</a> <a href="#k7908">7908</a> <a href="#k7918">7918</a> <a href="#k7920">7920</a> <a href="#k7950">7950</a> <a href="#k7951">7951</a> <a href="#k7957">7957</a> <a href="#k7958">7958</a> <a href="#k7964">7964</a> <a href="#k7965">7965</a> <a href="#k7984">7984</a> <a href="#k7998">7998</a> <a href="#k8008">8008</a> <a href="#k8024">8024</a> <a href="#k8027">8027</a> <a href="#k8050">8050</a> <a href="#k8051">8051</a> <a href="#k8054">8054</a> <a href="#k8055">8055</a> <a href="#k8097">8097</a> <a href="#k8098">8098</a> <a href="#k8100">8100</a> <a href="#k8101">8101</a> <a href="#k8111">8111</a> <a href="#k8113">8113</a> <a href="#k8143">8143</a> <a href="#k8144">8144</a> <a href="#k8150">8150</a> <a href="#k8151">8151</a> <a href="#k8157">8157</a> <a href="#k8158">8158</a> <a href="#k8177">8177</a> <a href="#k8191">8191</a> <a href="#k8201">8201</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle style='fill: red;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(enc token_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc management_uri_new token_new (hash n1 n2))</title>
   <circle style='fill: red;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g><title>(enc token (hash n1 n2))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: red;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>(enc token (hash n3 n4))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc token (hash n3 n4))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc management_uri token (hash n1 n2))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((token token) (token_new token_new) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>token_refresh 0</text></svg></div>

<pre>(defskeleton token_refresh
  (vars (token token_new mesg) (n1 n3 n2 n4 text)
    (access management_uri management_uri_new response response_error
      response_new data) (c as rs name))
  (defstrand client 16 (token token) (token_new token_new) (n1 n1)
    (n2 n2) (n3 n3) (n4 n4) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (label 0)
  (unrealized (0 1) (0 4) (0 6) (0 9) (0 11) (0 13) (0 15))
  (origs (n1 (0 0)) (n3 (0 5)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k617">Item <a href="#t0">617</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 617 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 617)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k619">Item <a href="#t0">619</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 619 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 619)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k639">Item <a href="#t0">639</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 639 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 639)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k641">Item <a href="#t0">641</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 641 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 641)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k741">Item <a href="#t0">741</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 741 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 4) (0 9))
    ((2 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 741)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k743">Item <a href="#t0">743</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 743 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 4) (0 9))
    ((2 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 743)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k763">Item <a href="#t0">763</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 141.584 1049.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 763 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 4) (0 9))
    ((2 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 2 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 763)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k765">Item <a href="#t0">765</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 765 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 4) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 765)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1107">Item <a href="#t0">1107</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1107 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1107)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1109">Item <a href="#t0">1109</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1109 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1109)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_error) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1111">Item <a href="#t0">1111</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1111 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1111)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1129">Item <a href="#t0">1129</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1129 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1129)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1131">Item <a href="#t0">1131</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1131 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1131)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1133">Item <a href="#t0">1133</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1133 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1133)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1151">Item <a href="#t0">1151</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1151 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1151)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1153">Item <a href="#t0">1153</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1153 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1153)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1155">Item <a href="#t0">1155</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1155 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1155)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1257">Item <a href="#t0">1257</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1257 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9))
    ((2 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1257)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1259">Item <a href="#t0">1259</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1259 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_error-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9))
    ((2 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1259)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1261">Item <a href="#t0">1261</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1261 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9))
    ((2 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1261)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1282">Item <a href="#t0">1282</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1282 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 6) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1282)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1284">Item <a href="#t0">1284</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1284 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 6) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1284)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1294">Item <a href="#t0">1294</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 141.584 1199.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1294 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9))
    ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (2 7))
  (label 1294)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1329">Item <a href="#t0">1329</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1329 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 6) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1329)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1331">Item <a href="#t0">1331</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1331 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 6) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1331)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1341">Item <a href="#t0">1341</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 141.584 1199.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1341 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9))
    ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (2 7))
  (label 1341)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1410">Item <a href="#t0">1410</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 1410 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1410)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1413">Item <a href="#t0">1413</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 1413 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1413)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1444">Item <a href="#t0">1444</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 1444 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1444)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1447">Item <a href="#t0">1447</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 1447 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1447)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1572">Item <a href="#t0">1572</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.320 825.660 44.759 936.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1572 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 4) (0 9))
    ((2 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1572)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1574">Item <a href="#t0">1574</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.320 825.660 44.759 936.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1574 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 4) (0 9))
    ((2 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1574)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1576">Item <a href="#t0">1576</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.320 825.660 44.759 936.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1576 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 4) (0 9))
    ((2 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1576)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1597">Item <a href="#t0">1597</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 136.920 977.460 233.880 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1597 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 4) (0 9)) ((1 6) (0 11))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1597)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1599">Item <a href="#t0">1599</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 136.920 977.460 233.880 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1599 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 4) (0 9)) ((1 6) (0 11))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1599)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1609">Item <a href="#t0">1609</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.320 1125.659 44.759 1236.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1609 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 4) (0 9))
    ((2 6) (0 11)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (2 7))
  (label 1609)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1644">Item <a href="#t0">1644</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 141.584 1049.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 86.940 1014.960 133.920 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1644 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response data)
    (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((0 12) (1 5)) ((1 1) (0 1)) ((1 4) (0 4)) ((1 6) (0 13))
    ((2 1) (0 6)) ((2 4) (0 9)) ((2 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 1 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1644)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1646">Item <a href="#t0">1646</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 136.920 977.460 233.880 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1646 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response access access_token access_token_new
      access_type management_uri value data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 4) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1646)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1656">Item <a href="#t0">1656</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.320 1125.659 44.759 1236.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1656 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 4) (0 9))
    ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (2 7))
  (label 1656)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1725">Item <a href="#t0">1725</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 1725 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 4) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1725)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1728">Item <a href="#t0">1728</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 1728 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 4) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1728)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1759">Item <a href="#t0">1759</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 1759 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 4) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1759)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1762">Item <a href="#t0">1762</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 1762 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 4) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1762)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1968">Item <a href="#t0">1968</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 1968 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1968)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1970">Item <a href="#t0">1970</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 1970 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1970)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1996">Item <a href="#t0">1996</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 1996 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1996)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1998">Item <a href="#t0">1998</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 1998 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1998)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2110">Item <a href="#t0">2110</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 2110 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 4) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2110)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2112">Item <a href="#t0">2112</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 2112 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 4) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2112)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2138">Item <a href="#t0">2138</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 2138 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 4) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2138)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2140">Item <a href="#t0">2140</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 2140 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 4) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2140)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2566">Item <a href="#t0">2566</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 2566 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 8) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2566)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2568">Item <a href="#t0">2568</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 2568 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 8) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2568)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_error) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2570">Item <a href="#t0">2570</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 2570 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 8) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2570)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2608">Item <a href="#t0">2608</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 2608 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 8) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2608)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2610">Item <a href="#t0">2610</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 2610 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 8) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2610)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2612">Item <a href="#t0">2612</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 2612 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response-0) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 8) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2612)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2653">Item <a href="#t0">2653</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 2653 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 8) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2653)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2655">Item <a href="#t0">2655</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 2655 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 8) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2655)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2657">Item <a href="#t0">2657</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 2657 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 8) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2657)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2710">Item <a href="#t0">2710</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 2710 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2710)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2713">Item <a href="#t0">2713</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 2713 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2713)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_error) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2716">Item <a href="#t0">2716</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 2716 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2716)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2744">Item <a href="#t0">2744</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 2744 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2744)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2747">Item <a href="#t0">2747</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 2747 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2747)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2750">Item <a href="#t0">2750</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 2750 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2750)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2778">Item <a href="#t0">2778</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 2778 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2778)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2781">Item <a href="#t0">2781</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 2781 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2781)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2784">Item <a href="#t0">2784</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 2784 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2784)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2925">Item <a href="#t0">2925</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error-0) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 2925 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response response_error-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error-0)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 6) (0 9)) ((1 8) (0 11))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2925)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error-0) (response_error response_error)
        (response_new response_error) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2927">Item <a href="#t0">2927</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error-0) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 2927 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response response_error-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error-0)
    (response_error response_error) (response_new response_error-0)
    (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 6) (0 9)) ((1 8) (0 11))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2927)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error-0) (response_error response_error)
        (response_new response_error-0) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2929">Item <a href="#t0">2929</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 2929 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response response_error-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 6) (0 9)) ((1 8) (0 11))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 2929)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error-0) (response_error response_error)
        (response_new response) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2979">Item <a href="#t0">2979</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 86.940 1164.960 133.920 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 2979 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((0 12) (1 5)) ((0 14) (2 7)) ((1 1) (0 1)) ((1 4) (0 4))
    ((1 6) (0 13)) ((2 1) (0 6)) ((2 6) (0 9)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 0 client 15)
    (enc (enc access_token_new-0 value access_type (privk as))
      (hash n3 n4-0)) (2 7))
  (label 2979)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response_error)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k2980">Item <a href="#t0">2980</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 141.584 1199.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 86.940 1164.960 133.920 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 2980 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((0 12) (1 5)) ((1 1) (0 1)) ((1 4) (0 4)) ((1 6) (0 13))
    ((2 1) (0 6)) ((2 6) (0 9)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 0 client 9)
    (enc (enc access_token_new-0 value access_type (privk as))
      (hash n3 n4-0)) (2 7))
  (label 2980)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response_error)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3011">Item <a href="#t0">3011</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.564 1124.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3011 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 3011)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3017">Item <a href="#t0">3017</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.241 1049.776 42.642 1384.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3017 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 3017)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3027">Item <a href="#t0">3027</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.925 787.140 42.010 1234.321'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3027 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 access_token-0 access_type-0 value-0
      data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3027)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3029">Item <a href="#t0">3029</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.925 787.140 42.010 1234.321'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3029 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 access_token-0 access_type-0 value-0
      data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3029)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3050">Item <a href="#t0">3050</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.583 976.118 45.326 1087.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3050 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3050)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3051">Item <a href="#t0">3051</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.583 976.118 45.326 1087.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3051 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3051)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3053">Item <a href="#t0">3053</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.583 976.118 45.326 1087.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3053 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3053)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3054">Item <a href="#t0">3054</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.583 976.118 45.326 1087.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-1) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3054 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-1) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3054)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-1)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3081">Item <a href="#t0">3081</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1389.960 Q 142.920 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 136.920 1277.460 233.880 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 86.940 1164.960 133.920 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 3081 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((0 12) (1 5)) ((0 14) (2 7)) ((1 1) (0 1)) ((1 4) (0 4))
    ((1 6) (0 13)) ((2 1) (0 6)) ((2 6) (0 9)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 0 client 15)
    (enc (enc access_token_new-0 value access_type (privk as))
      (hash n3 n4-0)) (2 7))
  (label 3081)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3082">Item <a href="#t0">3082</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 141.584 1199.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 86.940 1164.960 133.920 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 3082 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((0 12) (1 5)) ((1 1) (0 1)) ((1 4) (0 4)) ((1 6) (0 13))
    ((2 1) (0 6)) ((2 6) (0 9)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 0 client 9)
    (enc (enc access_token_new-0 value access_type (privk as))
      (hash n3 n4-0)) (2 7))
  (label 3082)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3113">Item <a href="#t0">3113</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.564 1124.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3113 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 3113)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3119">Item <a href="#t0">3119</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.241 1049.776 42.642 1384.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3119 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 3119)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3129">Item <a href="#t0">3129</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.925 787.140 42.010 1234.321'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3129 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 access_token-0 access_type-0 value-0
      data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3129)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3131">Item <a href="#t0">3131</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.925 787.140 42.010 1234.321'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3131 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 access_token-0 access_type-0 value-0
      data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3131)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3152">Item <a href="#t0">3152</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.021 900.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3152 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3152)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3153">Item <a href="#t0">3153</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.564 1124.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.021 900.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-1) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3153 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new response-0 access_token
      value access_type response-1 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-1)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 4) (0 11)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3153)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-1) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3155">Item <a href="#t0">3155</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.021 900.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3155 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3155)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3156">Item <a href="#t0">3156</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.021 900.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3156 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3156)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3199">Item <a href="#t0">3199</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3199 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 6) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3199)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3202">Item <a href="#t0">3202</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3202 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_error-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 6) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3202)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3205">Item <a href="#t0">3205</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3205 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 6) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3205)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3238">Item <a href="#t0">3238</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.583 976.118 45.326 1087.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3238 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3238)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3239">Item <a href="#t0">3239</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.583 976.118 45.326 1087.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3239 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3239)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3241">Item <a href="#t0">3241</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.583 976.118 45.326 1087.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3241 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3241)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3242">Item <a href="#t0">3242</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.583 976.118 45.326 1087.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-1) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3242 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-1) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3242)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-1)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3256">Item <a href="#t0">3256</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3256 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 6) (0 9))
    ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3256)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3259">Item <a href="#t0">3259</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3259 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 6) (0 9))
    ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3259)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3271">Item <a href="#t0">3271</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3271 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 6) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 3271)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3277">Item <a href="#t0">3277</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.564 1124.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3277 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 3277)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3283">Item <a href="#t0">3283</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.241 1049.776 42.642 1384.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3283 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 3283)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3324">Item <a href="#t0">3324</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.021 900.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3324 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3324)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3325">Item <a href="#t0">3325</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.564 1124.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.021 900.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-1) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3325 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new response-0 access_token
      value access_type response-1 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-1)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 4) (0 11)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3325)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-1) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3327">Item <a href="#t0">3327</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.021 900.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3327 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3327)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3328">Item <a href="#t0">3328</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.021 900.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3328 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3328)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3342">Item <a href="#t0">3342</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3342 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 6) (0 9))
    ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3342)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3345">Item <a href="#t0">3345</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3345 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 6) (0 9))
    ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3345)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3357">Item <a href="#t0">3357</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3357 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 6) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 3357)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3363">Item <a href="#t0">3363</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.564 1124.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3363 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 3363)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3369">Item <a href="#t0">3369</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.241 1049.776 42.642 1384.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3369 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 3369)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3691">Item <a href="#t0">3691</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 91.604 862.464 43.287 934.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 3691 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response response_error-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 4) (0 9)) ((1 8) (0 11))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3691)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3693">Item <a href="#t0">3693</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 91.604 862.464 43.287 934.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 3693 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response response_error-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error-0)
    (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 4) (0 9)) ((1 8) (0 11))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3693)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3695">Item <a href="#t0">3695</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 91.604 862.464 43.287 934.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 3695 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response response_error-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 4) (0 9)) ((1 8) (0 11))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3695)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3745">Item <a href="#t0">3745</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 86.940 1014.960 133.920 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 3745 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((0 12) (1 5)) ((0 14) (2 7)) ((1 1) (0 1)) ((1 4) (0 4))
    ((1 6) (0 13)) ((2 1) (0 6)) ((2 4) (0 9)) ((2 6) (0 11))
    ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 0 client 15)
    (enc (enc access_token_new-0 value access_type (privk as))
      (hash n3 n4-0)) (2 7))
  (label 3745)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3746">Item <a href="#t0">3746</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.320 1125.659 44.759 1236.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 86.940 1014.960 133.920 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 3746 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((0 12) (1 5)) ((1 1) (0 1)) ((1 4) (0 4)) ((1 6) (0 13))
    ((2 1) (0 6)) ((2 4) (0 9)) ((2 6) (0 11)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 0 client 9)
    (enc (enc access_token_new-0 value access_type (privk as))
      (hash n3 n4-0)) (2 7))
  (label 3746)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3777">Item <a href="#t0">3777</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3777 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new access_token
      value access_type response response-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((2 6) (0 11)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 3777)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3783">Item <a href="#t0">3783</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.564 974.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3783 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new access_token
      value access_type response data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((2 6) (0 11)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 3783)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3793">Item <a href="#t0">3793</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 191.118 712.218 42.396 1084.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3793 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response_error
      access_token value access_type response access_token-0
      access_type-0 value-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((2 6) (0 11)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3793)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3795">Item <a href="#t0">3795</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 191.118 712.218 42.396 1084.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3795 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response_error
      access_token value access_type response access_token-0
      access_type-0 value-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((2 6) (0 11)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3795)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3816">Item <a href="#t0">3816</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response-0) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3816 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new response
      access_token value access_type response-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response-0) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 11)) ((3 1) (0 6)) ((3 4) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 2 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3816)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response-0)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3817">Item <a href="#t0">3817</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3817 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3817)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3819">Item <a href="#t0">3819</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3819 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3819)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3820">Item <a href="#t0">3820</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3820 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3820)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3847">Item <a href="#t0">3847</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 86.940 1014.960 133.920 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 3847 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((0 12) (1 5)) ((0 14) (2 7)) ((1 1) (0 1)) ((1 4) (0 4))
    ((1 6) (0 13)) ((2 1) (0 6)) ((2 4) (0 9)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 0 client 15)
    (enc (enc access_token_new-0 value access_type (privk as))
      (hash n3 n4-0)) (2 7))
  (label 3847)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3848">Item <a href="#t0">3848</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.320 1125.659 44.759 1236.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 1089.960 Q 92.940 1089.960 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 86.940 1014.960 133.920 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 3848 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((0 12) (1 5)) ((1 1) (0 1)) ((1 4) (0 4)) ((1 6) (0 13))
    ((2 1) (0 6)) ((2 4) (0 9)) ((2 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 0 client 9)
    (enc (enc access_token_new-0 value access_type (privk as))
      (hash n3 n4-0)) (2 7))
  (label 3848)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3879">Item <a href="#t0">3879</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3879 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 3879)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3885">Item <a href="#t0">3885</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.564 974.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3885 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 3885)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3895">Item <a href="#t0">3895</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 140.772 712.084 41.664 1084.207'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token-0) (value value-0) (access_type access_type-0) (response response) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri) (value value-0) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token-0 value-0 access_type-0 (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3895 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response_new access_token
      access_type value access_token-0 value-0 access_type-0 response
      data) (c as rs name))
  (defstrand client 16
    (token (enc access_token-0 value-0 access_type-0 (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri) (value value-0) (c c) (as as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token-0) (value value-0)
    (access_type access_type-0) (response response)
    (response_error response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((0 5) (3 0)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 4) (0 13)) ((3 1) (0 6)) ((3 4) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 2 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3895)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token-0 value-0 access_type-0 (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3897">Item <a href="#t0">3897</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 191.118 712.218 42.396 1084.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3897 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value access_token-0 access_type-0 value-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3897)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3918">Item <a href="#t0">3918</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.320 825.660 44.759 936.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3918 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new access_token
      value access_type response data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 4) (0 11)) ((3 1) (0 6)) ((3 4) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 2 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3918)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3919">Item <a href="#t0">3919</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.583 826.118 45.326 937.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3919 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token value
      access_type response-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((3 4) (0 11)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3919)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3921">Item <a href="#t0">3921</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.583 826.118 45.326 937.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3921 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3921)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3922">Item <a href="#t0">3922</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.583 826.118 45.326 937.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3922 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 9)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3922)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3965">Item <a href="#t0">3965</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.583 826.118 45.326 937.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3965 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 4) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3965)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3968">Item <a href="#t0">3968</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.583 826.118 45.326 937.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3968 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 4) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3968)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k3971">Item <a href="#t0">3971</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.583 826.118 45.326 937.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 3971 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 4) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 3971)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4004">Item <a href="#t0">4004</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response-0) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4004 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new response
      access_token value access_type response-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response-0) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 11)) ((3 4) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 2 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4004)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response-0)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4005">Item <a href="#t0">4005</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4005 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 4) (0 9)) ((3 1) (0 6)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4005)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4007">Item <a href="#t0">4007</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4007 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 4) (0 9)) ((3 1) (0 6)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4007)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4008">Item <a href="#t0">4008</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4008 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 4) (0 9)) ((3 1) (0 6)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4008)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4022">Item <a href="#t0">4022</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 186.900 977.460 333.840 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4022 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 4) (0 9))
    ((2 6) (0 11)) ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4022)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4025">Item <a href="#t0">4025</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 186.900 977.460 333.840 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4025 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 4) (0 9))
    ((2 6) (0 11)) ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4025)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4037">Item <a href="#t0">4037</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.583 1126.118 45.326 1237.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4037 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 4) (0 9)) ((3 6) (0 11)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 4037)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4043">Item <a href="#t0">4043</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4043 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new access_token
      value access_type response response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 4) (0 9)) ((2 6) (0 11)) ((3 1) (0 6)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 4043)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4049">Item <a href="#t0">4049</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.564 974.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4049 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new access_token
      value access_type response data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 4) (0 9)) ((2 6) (0 11)) ((3 1) (0 6)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 4049)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4090">Item <a href="#t0">4090</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.320 825.660 44.759 936.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4090 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new access_token
      value access_type response data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 11)) ((3 4) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 2 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4090)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4091">Item <a href="#t0">4091</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.583 826.118 45.326 937.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4091 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token value
      access_type response-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 4) (0 9)) ((3 1) (0 6)) ((3 4) (0 11)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4091)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4093">Item <a href="#t0">4093</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.583 826.118 45.326 937.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4093 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 4) (0 9)) ((3 1) (0 6)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4093)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4094">Item <a href="#t0">4094</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.583 826.118 45.326 937.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4094 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 4) (0 9)) ((3 1) (0 6)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4094)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4108">Item <a href="#t0">4108</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 136.920 977.460 233.880 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4108 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response data)
    (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((0 12) (2 5)) ((1 1) (0 6)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)) ((3 4) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 2 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4108)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4111">Item <a href="#t0">4111</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 186.900 977.460 333.840 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4111 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response access access_token access_token_new
      access_type management_uri value data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 4) (0 9))
    ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4111)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4123">Item <a href="#t0">4123</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.583 1126.118 45.326 1237.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4123 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 4) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 4123)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4129">Item <a href="#t0">4129</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4129 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 4) (0 9)) ((3 1) (0 6)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 4129)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4135">Item <a href="#t0">4135</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.564 974.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4135 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 4) (0 9)) ((3 1) (0 6)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 4135)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4467">Item <a href="#t0">4467</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4467 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4467)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4469">Item <a href="#t0">4469</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4469 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4469)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_error) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4471">Item <a href="#t0">4471</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4471 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4471)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4495">Item <a href="#t0">4495</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4495 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4495)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4497">Item <a href="#t0">4497</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4497 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4497)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4499">Item <a href="#t0">4499</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4499 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4499)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4523">Item <a href="#t0">4523</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4523 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4523)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4525">Item <a href="#t0">4525</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4525 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4525)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4527">Item <a href="#t0">4527</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4527 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4527)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4641">Item <a href="#t0">4641</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4641 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 6) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4641)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4643">Item <a href="#t0">4643</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4643 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_error-0) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 6) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4643)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4645">Item <a href="#t0">4645</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4645 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 6) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4645)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4670">Item <a href="#t0">4670</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4670 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 1)) ((2 1) (0 6))
    ((2 6) (0 9)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4670)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4672">Item <a href="#t0">4672</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4672 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 1)) ((2 1) (0 6))
    ((2 6) (0 9)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4672)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4687">Item <a href="#t0">4687</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.925 787.140 42.010 1234.321'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4687 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 access_token-0 access_type-0 value-0
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 4) (0 4)) ((2 1) (0 6))
    ((2 6) (0 9)) ((3 1) (0 1)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4687)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4689">Item <a href="#t0">4689</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.925 787.140 42.010 1234.321'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4689 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 access_token-0 access_type-0 value-0
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 4) (0 4)) ((2 1) (0 6))
    ((2 6) (0 9)) ((3 1) (0 1)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4689)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4693">Item <a href="#t0">4693</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4693 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 6) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 4693)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4737">Item <a href="#t0">4737</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4737 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 1)) ((2 1) (0 6))
    ((2 6) (0 9)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4737)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4739">Item <a href="#t0">4739</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4739 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 1)) ((2 1) (0 6))
    ((2 6) (0 9)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4739)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4754">Item <a href="#t0">4754</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.925 787.140 42.010 1234.321'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4754 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 access_token-0 access_type-0 value-0
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 4) (0 4)) ((2 1) (0 6))
    ((2 6) (0 9)) ((3 1) (0 1)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4754)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4756">Item <a href="#t0">4756</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.925 787.140 42.010 1234.321'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4756 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 access_token-0 access_type-0 value-0
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 4) (0 4)) ((2 1) (0 6))
    ((2 6) (0 9)) ((3 1) (0 1)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4756)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4760">Item <a href="#t0">4760</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 4760 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 6) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 4760)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4844">Item <a href="#t0">4844</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 939.960 Q 242.880 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 4844 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (4 3)) ((1 1) (0 1)) ((2 4) (0 4))
    ((3 1) (0 6)) ((4 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4844)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4847">Item <a href="#t0">4847</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 939.960 Q 242.880 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 4847 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (4 3)) ((1 1) (0 1)) ((2 4) (0 4))
    ((3 1) (0 6)) ((4 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 4 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4847)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4886">Item <a href="#t0">4886</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 939.960 Q 242.880 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 4886 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (4 3)) ((1 1) (0 1)) ((2 4) (0 4))
    ((3 1) (0 6)) ((4 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4886)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k4889">Item <a href="#t0">4889</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 939.960 Q 242.880 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 4889 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (4 3)) ((1 1) (0 1)) ((2 4) (0 4))
    ((3 1) (0 6)) ((4 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 4 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 4889)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5028">Item <a href="#t0">5028</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.583 826.118 45.326 937.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 5028 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 4) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 5028)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5030">Item <a href="#t0">5030</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.583 826.118 45.326 937.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 5030 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error-0) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 4) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 5030)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5032">Item <a href="#t0">5032</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.583 826.118 45.326 937.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 5032 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 4) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 5032)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5057">Item <a href="#t0">5057</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 186.900 977.460 333.840 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 5057 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 1)) ((2 1) (0 6))
    ((2 4) (0 9)) ((2 6) (0 11)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 5057)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5059">Item <a href="#t0">5059</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 186.900 977.460 333.840 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 5059 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response access access_token
      access_token_new access_type management_uri value data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 1)) ((2 1) (0 6))
    ((2 4) (0 9)) ((2 6) (0 11)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 5059)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5074">Item <a href="#t0">5074</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 191.118 712.218 42.396 1084.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 5074 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response_error
      access_token value access_type response access_token-0
      access_type-0 value-0 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 4) (0 4)) ((2 1) (0 6))
    ((2 4) (0 9)) ((2 6) (0 11)) ((3 1) (0 1)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 5074)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5076">Item <a href="#t0">5076</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 191.118 712.218 42.396 1084.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 5076 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response_error
      access_token value access_type response access_token-0
      access_type-0 value-0 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 4) (0 4)) ((2 1) (0 6))
    ((2 4) (0 9)) ((2 6) (0 11)) ((3 1) (0 1)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 5076)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5080">Item <a href="#t0">5080</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.583 1126.118 45.326 1237.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 5080 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 4) (0 9)) ((3 6) (0 11)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 5080)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5124">Item <a href="#t0">5124</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 136.920 977.460 233.880 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 5124 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response data)
    (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((0 12) (2 5)) ((1 1) (0 1)) ((2 4) (0 4))
    ((2 6) (0 13)) ((3 1) (0 6)) ((3 4) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 2 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 5124)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5126">Item <a href="#t0">5126</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 1014.960 Q 186.900 977.460 333.840 1014.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 5126 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response access access_token access_token_new
      access_type management_uri value data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 1)) ((2 1) (0 6))
    ((2 4) (0 9)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 5126)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5141">Item <a href="#t0">5141</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 140.772 712.084 41.664 1084.207'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token-0) (value value-0) (access_type access_type-0) (response response) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri) (value value-0) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token-0 value-0 access_type-0 (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 5141 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response_new access_token
      access_type value access_token-0 value-0 access_type-0 response
      data) (c as rs name))
  (defstrand client 16
    (token (enc access_token-0 value-0 access_type-0 (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri) (value value-0) (c c) (as as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token-0) (value value-0)
    (access_type access_type-0) (response response)
    (response_error response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((0 5) (3 0)) ((0 8) (3 3)) ((1 4) (0 4)) ((2 1) (0 1))
    ((2 4) (0 13)) ((3 1) (0 6)) ((3 4) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 2 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 5141)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token-0 value-0 access_type-0 (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5143">Item <a href="#t0">5143</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 191.118 712.218 42.396 1084.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 5143 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value access_token-0 access_type-0 value-0 data)
    (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 4) (0 4)) ((2 1) (0 6))
    ((2 4) (0 9)) ((3 1) (0 1)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 5143)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5147">Item <a href="#t0">5147</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.583 1126.118 45.326 1237.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 5147 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 4) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 5147)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5231">Item <a href="#t0">5231</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 939.960 Q 242.880 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 5231 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (4 3)) ((1 1) (0 1)) ((2 4) (0 4))
    ((3 1) (0 6)) ((4 4) (0 9)) ((4 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 5231)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5234">Item <a href="#t0">5234</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 939.960 Q 242.880 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 5234 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (4 3)) ((1 1) (0 1)) ((2 4) (0 4))
    ((3 1) (0 6)) ((4 4) (0 9)) ((4 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 4 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 5234)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5273">Item <a href="#t0">5273</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 939.960 Q 242.280 1050.660 44.759 1236.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 5273 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (4 3)) ((1 1) (0 1)) ((2 4) (0 4))
    ((3 1) (0 6)) ((4 4) (0 9)) ((4 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 5 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 5273)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k5276">Item <a href="#t0">5276</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 5276 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value data)
    (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (4 3)) ((1 1) (0 1)) ((2 4) (0 4))
    ((3 1) (0 6)) ((4 4) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 4 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 5276)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6426">Item <a href="#t0">6426</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.241 1199.776 42.642 1534.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6426 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response_error response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 6426)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6432">Item <a href="#t0">6432</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.014 1124.674 42.188 1534.389'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6432 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 6432)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6440">Item <a href="#t0">6440</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.782 862.092 41.724 1384.225'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6440 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 response_error access_token-0
      access_type-0 value-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6440)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6442">Item <a href="#t0">6442</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.782 862.092 41.724 1384.225'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6442 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 response_error access_token-0
      access_type-0 value-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6442)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_error) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6444">Item <a href="#t0">6444</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.782 862.092 41.724 1384.225'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6444 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 response_error access_token-0
      access_type-0 value-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6444)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6505">Item <a href="#t0">6505</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.241 1199.776 42.642 1534.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6505 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response_error response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 6505)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6511">Item <a href="#t0">6511</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.014 1124.674 42.188 1534.389'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6511 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 6511)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6519">Item <a href="#t0">6519</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.782 862.092 41.724 1384.225'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6519 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 response_error access_token-0
      access_type-0 value-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6519)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6521">Item <a href="#t0">6521</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.782 862.092 41.724 1384.225'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6521 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 response_error access_token-0
      access_type-0 value-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6521)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6523">Item <a href="#t0">6523</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.782 862.092 41.724 1384.225'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6523 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 response_error access_token-0
      access_type-0 value-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response-0) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6523)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6541">Item <a href="#t0">6541</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6541 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6541)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6544">Item <a href="#t0">6544</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6544 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6544)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6545">Item <a href="#t0">6545</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6545 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6545)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6547">Item <a href="#t0">6547</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6547 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6547)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6548">Item <a href="#t0">6548</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-1) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6548 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-1) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6548)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-1)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6603">Item <a href="#t0">6603</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.241 1199.776 42.642 1534.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6603 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response_error response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 6603)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6609">Item <a href="#t0">6609</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.014 1124.674 42.188 1534.389'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6609 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 6609)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6617">Item <a href="#t0">6617</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.782 862.092 41.724 1384.225'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6617 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 response_error access_token-0
      access_type-0 value-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6617)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6619">Item <a href="#t0">6619</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.782 862.092 41.724 1384.225'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6619 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 response_error access_token-0
      access_type-0 value-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6619)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6621">Item <a href="#t0">6621</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.782 862.092 41.724 1384.225'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6621 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 response_error access_token-0
      access_type-0 value-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6621)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6639">Item <a href="#t0">6639</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.564 974.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6639 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6639)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6642">Item <a href="#t0">6642</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.564 974.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6642 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6642)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6643">Item <a href="#t0">6643</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.241 1199.776 42.642 1534.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 191.564 974.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-1) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6643 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new response-0
      response_error access_token value access_type response-1 data)
    (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-1)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 11)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6643)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-1) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6645">Item <a href="#t0">6645</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.564 974.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6645 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6645)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6646">Item <a href="#t0">6646</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.564 974.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6646 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 8) (0 9)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6646)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6684">Item <a href="#t0">6684</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6684 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 8) (0 9))
    ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6684)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6687">Item <a href="#t0">6687</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6687 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 8) (0 9))
    ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6687)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_error) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6690">Item <a href="#t0">6690</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6690 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 8) (0 9))
    ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6690)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6706">Item <a href="#t0">6706</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.241 1199.776 42.642 1534.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6706 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response_error response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 6706)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6712">Item <a href="#t0">6712</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.014 1124.674 42.188 1534.389'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6712 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 6712)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6747">Item <a href="#t0">6747</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6747 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6747)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6750">Item <a href="#t0">6750</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6750 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6750)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6751">Item <a href="#t0">6751</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6751 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6751)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6753">Item <a href="#t0">6753</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6753 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6753)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6754">Item <a href="#t0">6754</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 192.021 1050.338 44.202 1235.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-1) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6754 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-1) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6754)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-1)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6765">Item <a href="#t0">6765</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6765 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 8) (0 9))
    ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6765)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6768">Item <a href="#t0">6768</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6768 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 8) (0 9))
    ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6768)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6771">Item <a href="#t0">6771</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6771 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response-0) (c c)
    (as as) (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 8) (0 9))
    ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6771)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6787">Item <a href="#t0">6787</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.241 1199.776 42.642 1534.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6787 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response_error response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 6787)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6793">Item <a href="#t0">6793</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.014 1124.674 42.188 1534.389'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6793 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 6793)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6831">Item <a href="#t0">6831</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.564 974.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6831 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6831)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6834">Item <a href="#t0">6834</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.564 974.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6834 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6834)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6835">Item <a href="#t0">6835</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.241 1199.776 42.642 1534.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 191.564 974.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-1) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6835 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new response-0
      response_error access_token value access_type response-1 data)
    (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-1)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 4) (0 11)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6835)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-1) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6837">Item <a href="#t0">6837</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.564 974.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6837 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6837)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6838">Item <a href="#t0">6838</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.564 974.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6838 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 4) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6838)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6849">Item <a href="#t0">6849</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6849 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 8) (0 9))
    ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6849)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6852">Item <a href="#t0">6852</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6852 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 8) (0 9))
    ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6852)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6855">Item <a href="#t0">6855</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6855 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 response_error access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 8) (0 9))
    ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 6855)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6871">Item <a href="#t0">6871</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.241 1199.776 42.642 1534.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6871 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response_error response-1 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 6871)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k6877">Item <a href="#t0">6877</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.014 1124.674 42.188 1534.389'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 6877 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response_error data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 8) (0 9)) ((3 1) (0 6)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 6877)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7277">Item <a href="#t0">7277</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.564 1124.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7277 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new access_token
      value access_type response response_error-0 response-0 data)
    (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((2 8) (0 11)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7277)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7283">Item <a href="#t0">7283</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.241 1049.776 42.642 1384.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7283 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new access_token
      value access_type response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((2 8) (0 11)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7283)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7291">Item <a href="#t0">7291</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.925 787.140 42.010 1234.321'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error-0) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7291 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response_error
      access_token value access_type response response_error-0
      access_token-0 access_type-0 value-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error-0)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((2 8) (0 11)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7291)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error-0) (response_error response_error)
        (response_new response_error) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7293">Item <a href="#t0">7293</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.925 787.140 42.010 1234.321'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error-0) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7293 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response_error
      access_token value access_type response response_error-0
      access_token-0 access_type-0 value-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error-0)
    (response_error response_error) (response_new response_error-0)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((2 8) (0 11)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7293)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error-0) (response_error response_error)
        (response_new response_error-0) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7295">Item <a href="#t0">7295</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 190.925 787.140 42.010 1234.321'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7295 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response_error
      access_token value access_type response response_error-0
      access_token-0 access_type-0 value-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((2 8) (0 11)) ((3 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7295)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error-0) (response_error response_error)
        (response_new response) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7315">Item <a href="#t0">7315</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7315 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7315)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7317">Item <a href="#t0">7317</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7317 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7317)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7318">Item <a href="#t0">7318</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7318 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7318)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7320">Item <a href="#t0">7320</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7320 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7320)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7321">Item <a href="#t0">7321</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-1) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7321 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-1) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7321)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-1)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7368">Item <a href="#t0">7368</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='1089.960' x2='339.840' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1539.960 Q 192.900 1502.460 45.960 1539.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1464.960' r='6.000'/>
   </g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='1239.960' r='6.000'/>
   </g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='1164.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 188.559 749.776 337.158 1084.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token_new) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7368 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      response-1 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token_new) (value value)
    (access_type access_type) (response response-1)
    (response_error response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 12) (2 5)) ((0 14) (3 3)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13))
    ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 15)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7368)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7369">Item <a href="#t0">7369</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.564 1124.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7369 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      response-1 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 8) (3 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13))
    ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7369)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7375">Item <a href="#t0">7375</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='1089.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='1239.960' r='6.000'/>
   </g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='1164.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 188.559 749.776 337.158 1084.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token_new) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7375 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token_new) (value value)
    (access_type access_type) (response response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 12) (2 5)) ((0 14) (3 3)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13))
    ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 15)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7375)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7376">Item <a href="#t0">7376</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.241 1049.776 42.642 1384.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7376 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 8) (3 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13))
    ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7376)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7388">Item <a href="#t0">7388</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='789.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(enc management_uri-0 (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 188.682 637.218 337.404 1009.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 188.682 412.218 337.404 784.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-0) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7388 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 access_token_new management_uri-0
      data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri-0)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7388)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7390">Item <a href="#t0">7390</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='789.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(enc management_uri-0 (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 188.682 637.218 337.404 1009.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 188.682 412.218 337.404 784.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-0) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7390 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 access_token_new management_uri-0
      data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri-0)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7390)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7410">Item <a href="#t0">7410</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7410 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response-1 response_error data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 7410)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7438">Item <a href="#t0">7438</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 140.627 787.044 41.373 1234.129'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token-0 value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token-0 value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token-0 value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token-0) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token-0 value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7438 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response_new access_token
      access_type value access_token-0 response response_error data)
    (c as rs name))
  (defstrand client 16
    (token (enc access_token-0 value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token-0) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((0 5) (3 0)) ((0 8) (3 3)) ((0 14) (3 7)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 4) (0 13)) ((3 1) (0 6)) ((3 6) (0 9))
    ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 15)
    (enc (enc access_token_new value-0 access_type-0 (privk as))
      (hash n3 n4-0)) (3 7))
  (label 7438)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response_error)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token (enc access_token-0 value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7439">Item <a href="#t0">7439</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 140.627 787.044 41.373 1234.129'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token-0) (access_token_new access_token-0) (value value-0) (access_type access_type-0) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri) (value value-0) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token-0 value-0 access_type-0 (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7439 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response_new access_token
      access_type value access_token-0 value-0 access_type-0 response
      response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token-0 value-0 access_type-0 (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri) (value value-0) (c c) (as as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token-0) (access_token_new access_token-0)
    (value value-0) (access_type access_type-0) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((0 5) (3 0)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 4) (0 13)) ((3 1) (0 6)) ((3 6) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value-0 access_type-0 (privk as))
      (hash n3 n4-0)) (3 7))
  (label 7439)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response_error)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token (enc access_token-0 value-0 access_type-0 (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7479">Item <a href="#t0">7479</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.320 975.660 44.759 1086.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7479 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_error response-0 response-1
      access access_token access_token_new access_type management_uri
      value data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (1 3)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 6) (0 11)) ((3 1) (0 1)) ((3 4) (0 4))
    ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7479)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7480">Item <a href="#t0">7480</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.320 975.660 44.759 1086.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7480 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_error response-0 response-1
      access access_token access_token_new access_type management_uri
      value data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (1 3)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 6) (0 11)) ((3 1) (0 1)) ((3 4) (0 4))
    ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7480)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7482">Item <a href="#t0">7482</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.320 975.660 44.759 1086.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7482 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_error response-0 response-1
      access access_token access_token_new access_type management_uri
      value data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response-0) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (1 3)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 6) (0 11)) ((3 1) (0 1)) ((3 4) (0 4))
    ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7482)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7483">Item <a href="#t0">7483</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.320 975.660 44.759 1086.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response-1) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7483 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_error response-0 response-1
      access access_token access_token_new access_type management_uri
      value data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response-1) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (1 3)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 6) (0 11)) ((3 1) (0 1)) ((3 4) (0 4))
    ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7483)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response-1)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7493">Item <a href="#t0">7493</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.320 975.660 44.759 1086.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7493 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new response
      access_token value access_type response-0 response_error-0 data)
    (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 11)) ((3 1) (0 6)) ((3 6) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 7493)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7495">Item <a href="#t0">7495</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.583 976.118 45.326 1087.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7495 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new response-0 access_token
      value access_type response-1 response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 6) (0 11)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 7495)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7587">Item <a href="#t0">7587</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='1089.960' x2='339.840' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1539.960 Q 192.900 1502.460 45.960 1539.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1464.960' r='6.000'/>
   </g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='1239.960' r='6.000'/>
   </g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='1164.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 188.559 749.776 337.158 1084.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token_new) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7587 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      response-1 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token_new) (value value)
    (access_type access_type) (response response-1)
    (response_error response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 12) (2 5)) ((0 14) (3 3)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13))
    ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 15)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7587)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7588">Item <a href="#t0">7588</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.564 1124.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7588 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      response-1 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 8) (3 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13))
    ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7588)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7594">Item <a href="#t0">7594</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='1089.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='1239.960' r='6.000'/>
   </g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='1164.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 188.559 749.776 337.158 1084.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token_new) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7594 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token_new) (value value)
    (access_type access_type) (response response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 12) (2 5)) ((0 14) (3 3)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13))
    ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 15)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7594)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7595">Item <a href="#t0">7595</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.241 1049.776 42.642 1384.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7595 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 8) (3 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13))
    ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7595)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7607">Item <a href="#t0">7607</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='789.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(enc management_uri-0 (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 188.682 637.218 337.404 1009.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 188.682 412.218 337.404 784.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-0) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7607 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 access_token_new management_uri-0
      data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri-0)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7607)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7609">Item <a href="#t0">7609</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='789.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(enc management_uri-0 (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 188.682 637.218 337.404 1009.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 188.682 412.218 337.404 784.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri-0) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7609 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 access_token_new management_uri-0
      data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri-0)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 3) (1 3)) ((0 3) (3 3))
    ((0 5) (2 0)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7609)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7629">Item <a href="#t0">7629</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7629 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response-1 response_error data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 7629)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7657">Item <a href="#t0">7657</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 140.627 787.044 41.373 1234.129'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token-0 value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token-0 value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token-0 value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token-0) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token-0 value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7657 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response_new access_token
      access_type value access_token-0 response response_error data)
    (c as rs name))
  (defstrand client 16
    (token (enc access_token-0 value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token-0) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((0 5) (3 0)) ((0 8) (3 3)) ((0 14) (3 7)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 4) (0 13)) ((3 1) (0 6)) ((3 6) (0 9))
    ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 15)
    (enc (enc access_token_new value-0 access_type-0 (privk as))
      (hash n3 n4-0)) (3 7))
  (label 7657)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token (enc access_token-0 value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7658">Item <a href="#t0">7658</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 140.627 787.044 41.373 1234.129'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token-0) (access_token_new access_token-0) (value value-0) (access_type access_type-0) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri) (value value-0) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token-0 value-0 access_type-0 (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7658 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response_new access_token
      access_type value access_token-0 value-0 access_type-0 response
      response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token-0 value-0 access_type-0 (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri) (value value-0) (c c) (as as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token-0) (access_token_new access_token-0)
    (value value-0) (access_type access_type-0) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((0 5) (3 0)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 4) (0 13)) ((3 1) (0 6)) ((3 6) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value-0 access_type-0 (privk as))
      (hash n3 n4-0)) (3 7))
  (label 7658)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token (enc access_token-0 value-0 access_type-0 (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7698">Item <a href="#t0">7698</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 141.584 899.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7698 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_error response-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (1 3)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 4) (0 11)) ((3 1) (0 1)) ((3 4) (0 4))
    ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7698)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7699">Item <a href="#t0">7699</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.564 1124.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.021 900.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-1) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7699 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token_new management_uri access_token value access_type
      response-1 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-1) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 8) (3 3)) ((0 12) (2 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13))
    ((3 4) (0 11)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 2 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7699)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-1) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7701">Item <a href="#t0">7701</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 141.584 899.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7701 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_error response-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response-0) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (1 3)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 4) (0 11)) ((3 1) (0 1)) ((3 4) (0 4))
    ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7701)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7702">Item <a href="#t0">7702</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 141.584 899.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7702 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_error response-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (1 3)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6))
    ((1 6) (0 9)) ((2 4) (0 11)) ((3 1) (0 1)) ((3 4) (0 4))
    ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7702)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7712">Item <a href="#t0">7712</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 141.584 899.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7712 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new access_token
      value access_type response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 4) (0 11)) ((3 1) (0 6)) ((3 6) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 7712)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7714">Item <a href="#t0">7714</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.021 900.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-1) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7714 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new response-0 access_token
      value access_type response-1 response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-1)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 9)) ((3 4) (0 11)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 7714)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-1) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7804">Item <a href="#t0">7804</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7804 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7804)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7806">Item <a href="#t0">7806</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7806 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7806)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7807">Item <a href="#t0">7807</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7807 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7807)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7809">Item <a href="#t0">7809</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7809 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7809)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7810">Item <a href="#t0">7810</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.900 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-1) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7810 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 response_error-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-1) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7810)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-1)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7825">Item <a href="#t0">7825</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error-0) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7825 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response response_error-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error-0)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 6) (0 9))
    ((2 8) (0 11)) ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7825)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error-0) (response_error response_error)
        (response_new response_error) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7828">Item <a href="#t0">7828</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error-0) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7828 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response response_error-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error-0)
    (response_error response_error) (response_new response_error-0)
    (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 6) (0 9))
    ((2 8) (0 11)) ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7828)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error-0) (response_error response_error)
        (response_new response_error-0) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7831">Item <a href="#t0">7831</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7831 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_error response response_error-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (2 3)) ((0 12) (3 5)) ((1 1) (0 6)) ((2 6) (0 9))
    ((2 8) (0 11)) ((3 1) (0 1)) ((3 4) (0 4)) ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7831)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error-0) (response_error response_error)
        (response_new response) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7847">Item <a href="#t0">7847</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.564 1124.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7847 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new access_token
      value access_type response response_error-0 response-0 data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((2 8) (0 11)) ((3 1) (0 6)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7847)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7853">Item <a href="#t0">7853</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.241 1049.776 42.642 1384.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7853 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new access_token
      value access_type response response_error-0 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((2 8) (0 11)) ((3 1) (0 6)) ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7853)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7904">Item <a href="#t0">7904</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.320 975.660 44.759 1086.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7904 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_error response-0 response-1
      access access_token access_token_new access_type management_uri
      value data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (1 3)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 6) (0 9))
    ((2 1) (0 6)) ((2 6) (0 11)) ((3 1) (0 1)) ((3 4) (0 4))
    ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7904)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7905">Item <a href="#t0">7905</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.320 975.660 44.759 1086.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7905 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_error response-0 response-1
      access access_token access_token_new access_type management_uri
      value data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (1 3)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 6) (0 9))
    ((2 1) (0 6)) ((2 6) (0 11)) ((3 1) (0 1)) ((3 4) (0 4))
    ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7905)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7907">Item <a href="#t0">7907</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.320 975.660 44.759 1086.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7907 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_error response-0 response-1
      access access_token access_token_new access_type management_uri
      value data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response-0) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (1 3)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 6) (0 9))
    ((2 1) (0 6)) ((2 6) (0 11)) ((3 1) (0 1)) ((3 4) (0 4))
    ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7907)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7908">Item <a href="#t0">7908</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.320 975.660 44.759 1086.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response-1) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7908 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_error response-0 response-1
      access access_token access_token_new access_type management_uri
      value data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response-1) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (1 3)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 6) (0 9))
    ((2 1) (0 6)) ((2 6) (0 11)) ((3 1) (0 1)) ((3 4) (0 4))
    ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 7908)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response-1)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7918">Item <a href="#t0">7918</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.320 975.660 44.759 1086.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7918 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new response
      access_token value access_type response-0 response_error-0 data)
    (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error-0) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 6) (0 11)) ((3 6) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 7918)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7920">Item <a href="#t0">7920</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.583 976.118 45.326 1087.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7920 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new response-0 access_token
      value access_type response-1 response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 6) (0 11)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 7920)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7950">Item <a href="#t0">7950</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7950 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((0 12) (2 5)) ((0 14) (3 7)) ((1 1) (0 6))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)) ((3 6) (0 9))
    ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 15)
    (enc (enc access_token_new-0 value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 7950)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response_error)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7951">Item <a href="#t0">7951</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7951 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((0 12) (2 5)) ((1 1) (0 6)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)) ((3 6) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new-0 value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 7951)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response_error)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7957">Item <a href="#t0">7957</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1539.960 Q 192.900 1502.460 45.960 1539.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1464.960' r='6.000'/>
   </g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='1239.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token_new) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7957 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token_new) (value value)
    (access_type access_type) (response response-1)
    (response_error response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 12) (2 5)) ((0 14) (3 3)) ((1 6) (0 9))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)) ((3 1) (0 6))
    ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 15)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7957)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7958">Item <a href="#t0">7958</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.564 1124.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7958 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 8) (3 3)) ((0 12) (2 5)) ((1 6) (0 9))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)) ((3 1) (0 6))
    ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7958)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7964">Item <a href="#t0">7964</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='1239.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token_new) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7964 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token_new) (value value)
    (access_type access_type) (response response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 12) (2 5)) ((0 14) (3 3)) ((1 6) (0 9))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)) ((3 1) (0 6))
    ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 15)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7964)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7965">Item <a href="#t0">7965</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.241 1049.776 42.642 1384.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7965 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 8) (3 3)) ((0 12) (2 5)) ((1 6) (0 9))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)) ((3 1) (0 6))
    ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 7965)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7984">Item <a href="#t0">7984</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 7984 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response-1 response_error data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 7984)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k7998">Item <a href="#t0">7998</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 939.960 Q 241.873 1125.217 43.945 1385.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 7998 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response-1 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (3 3)) ((0 8) (4 3)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 1) (0 6)) ((3 6) (0 9)) ((4 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (4 3))
  (label 7998)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8008">Item <a href="#t0">8008</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 789.960 Q 241.544 1049.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 8008 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (3 3)) ((0 8) (4 3)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 1) (0 6)) ((3 6) (0 9)) ((4 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (4 3))
  (label 8008)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8024">Item <a href="#t0">8024</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 414.960 Q 241.188 787.260 42.577 1234.561'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 236.880 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 8024 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 access_token-0 access_type-0 value-0
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (4 0)) ((0 3) (1 3)) ((0 3) (4 3))
    ((0 5) (2 0)) ((0 5) (3 0)) ((0 8) (3 3)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 1) (0 6)) ((3 6) (0 9)) ((4 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 8024)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8027">Item <a href="#t0">8027</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 414.960 Q 241.188 787.260 42.577 1234.561'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token-0 value-0 access_type-0 (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token-0 value-0 access_type-0 (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 236.880 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token-0) (access_type access_type-0) (management_uri management_uri_new) (value value-0) (c c) (as as))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token-0 value-0 access_type-0 (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 8027 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri management_uri_new response access_token
      access_type value response-0 access_token-0 access_type-0 value-0
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token-0 value-0 access_type-0 (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token-0) (access_type access_type-0)
    (management_uri management_uri_new) (value value-0) (c c) (as as))
  (precedes ((0 0) (1 0)) ((0 0) (4 0)) ((0 3) (1 3)) ((0 3) (4 3))
    ((0 5) (2 0)) ((0 5) (3 0)) ((0 8) (3 3)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 1) (0 6)) ((3 6) (0 9)) ((4 4) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 8027)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token-0 value-0 access_type-0 (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8050">Item <a href="#t0">8050</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 939.960 Q 242.689 976.406 45.578 1087.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 8050 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (3 3)) ((0 8) (4 3)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 1) (0 6)) ((3 6) (0 9)) ((4 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 8050)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8051">Item <a href="#t0">8051</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 939.960 Q 242.689 976.406 45.578 1087.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 8051 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (3 3)) ((0 8) (4 3)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 1) (0 6)) ((3 6) (0 9)) ((4 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 8051)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8054">Item <a href="#t0">8054</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 939.960 Q 242.689 976.406 45.578 1087.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 8054 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (3 3)) ((0 8) (4 3)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 1) (0 6)) ((3 6) (0 9)) ((4 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 3 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 8054)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8055">Item <a href="#t0">8055</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 939.960 Q 242.689 976.406 45.578 1087.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-1) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 8055 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_error access_token
      access_type value response-0 response-1 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-1) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (3 3)) ((0 8) (4 3)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 1) (0 6)) ((3 6) (0 9)) ((4 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 4 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 8055)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-1)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8097">Item <a href="#t0">8097</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 141.584 899.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 8097 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_error response-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (1 3)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 6) (0 9))
    ((2 1) (0 6)) ((2 4) (0 11)) ((3 1) (0 1)) ((3 4) (0 4))
    ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 8097)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8098">Item <a href="#t0">8098</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.564 1124.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.021 900.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-1) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 8098 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token_new management_uri access_token value access_type
      response-1 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-1) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 8) (3 3)) ((0 12) (2 5)) ((1 6) (0 9))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)) ((3 1) (0 6))
    ((3 4) (0 11)) ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 2 4 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 8098)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-1) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8100">Item <a href="#t0">8100</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 141.584 899.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 8100 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_error response-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response-0) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (1 3)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 6) (0 9))
    ((2 1) (0 6)) ((2 4) (0 11)) ((3 1) (0 1)) ((3 4) (0 4))
    ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 8100)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8101">Item <a href="#t0">8101</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 141.584 899.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 186.900 1127.460 333.840 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 8101 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_error response-0 access
      access_token access_token_new access_type management_uri value
      data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_error) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (precedes ((0 0) (3 0)) ((0 3) (3 3)) ((0 5) (1 0)) ((0 5) (2 0))
    ((0 8) (1 3)) ((0 8) (2 3)) ((0 12) (3 5)) ((1 6) (0 9))
    ((2 1) (0 6)) ((2 4) (0 11)) ((3 1) (0 1)) ((3 4) (0 4))
    ((3 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 8101)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8111">Item <a href="#t0">8111</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 141.584 899.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 8111 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error response_new access_token
      value access_type response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_error) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 1) (0 6)) ((2 4) (0 11)) ((3 6) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 8111)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_new)
        (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8113">Item <a href="#t0">8113</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.021 900.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-1) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 8113 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new response-0 access_token
      value access_type response-1 response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-1)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 4) (0 11)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 8113)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-1) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8143">Item <a href="#t0">8143</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token_new) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 8143 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token_new)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((0 12) (2 5)) ((0 14) (3 7)) ((1 1) (0 6))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)) ((3 6) (0 9))
    ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 15)
    (enc (enc access_token_new-0 value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 8143)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8144">Item <a href="#t0">8144</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response_error) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 8144 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response_new access access_token_new
      management_uri access_token value access_type response
      response_error data) (c as rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response_error)
    (response_error response) (response_new response_new) (c c) (as as)
    (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((0 12) (2 5)) ((1 1) (0 6)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)) ((3 6) (0 9)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new-0 value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 8144)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new)
        (response response_error) (response_error response)
        (response_new response_new) (n2 n4) (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8150">Item <a href="#t0">8150</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1539.960 Q 192.900 1502.460 45.960 1539.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1464.960' r='6.000'/>
   </g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='1239.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token_new) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 8150 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token_new) (value value)
    (access_type access_type) (response response-1)
    (response_error response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 12) (2 5)) ((0 14) (3 3)) ((1 6) (0 9))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)) ((3 1) (0 6))
    ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 15)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 8150)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8151">Item <a href="#t0">8151</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 939.960 Q 191.564 1124.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 8151 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      response-1 data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 8) (3 3)) ((0 12) (2 5)) ((1 6) (0 9))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)) ((3 1) (0 6))
    ((3 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 8151)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8157">Item <a href="#t0">8157</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1389.960 Q 192.900 1352.460 45.960 1389.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='1239.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <path
   d='M 39.960 1314.960 Q 186.900 1277.460 333.840 1314.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token_new) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 8157 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token_new) (value value)
    (access_type access_type) (response response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 12) (2 5)) ((0 14) (3 3)) ((1 6) (0 9))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)) ((3 1) (0 6))
    ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 15)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 8157)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8158">Item <a href="#t0">8158</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 191.241 1049.776 42.642 1384.593'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token_new value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc access_token_new value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token_new value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 8158 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response_new response-0 access
      access_token access_token_new access_type management_uri value
      data) (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token_new value access_type (privk as)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response-0) (response_new response_new) (c c)
    (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 5) (3 0))
    ((0 8) (1 3)) ((0 8) (3 3)) ((0 12) (2 5)) ((1 6) (0 9))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 6) (0 13)) ((3 1) (0 6))
    ((3 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (3 3))
  (label 8158)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new
          (enc access_token_new value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8177">Item <a href="#t0">8177</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 1089.960 Q 192.021 1200.338 44.202 1385.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='339.840' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-1) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>token_refresh 8177 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response-1 response_error data)
    (as c rs name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-1)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (2 3)) ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4))
    ((2 6) (0 9)) ((3 1) (0 6)) ((3 8) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc (enc access_token_new value access_type (privk as))
      (hash n3 n4-0)) (3 7))
  (label 8177)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8191">Item <a href="#t0">8191</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 939.960 Q 241.873 1125.217 43.945 1385.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-1 (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-1) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 8191 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 response-1 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-1) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (3 3)) ((0 8) (4 3)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 1) (0 6)) ((3 6) (0 9)) ((4 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (4 3))
  (label 8191)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k8201">Item <a href="#t0">8201</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 789.960 Q 241.544 1049.964 43.287 1384.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 192.900 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc access_token value access_type (privk as)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc access_token value access_type (privk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response_new) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc access_token value access_type (privk as))) (token_new (enc access_token value access_type (privk as))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>token_refresh 8201 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response response_new access_token
      access_type value response-0 data) (rs c as name))
  (defstrand client 16
    (token (enc access_token value access_type (privk as)))
    (token_new (enc access_token value access_type (privk as))) (n1 n1)
    (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response_new) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (3 3)) ((0 8) (4 3)) ((1 1) (0 1))
    ((1 4) (0 4)) ((2 1) (0 6)) ((3 6) (0 9)) ((4 4) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 0 client 9)
    (enc (enc access_token-0 value-0 access_type-0 (privk as-0))
      (hash n3 n4-0)) (4 3))
  (label 8201)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token (enc access_token value access_type (privk as)))
        (token_new (enc access_token value access_type (privk as))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

</body>
</html>
