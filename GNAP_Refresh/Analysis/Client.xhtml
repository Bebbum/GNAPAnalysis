<?xml version="1.0"?>
<!-- CPSA 3.6.9 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Grant Negotiation and Authorization Protocol</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(comment &quot;CPSA 3.6.9&quot;)
(comment &quot;Extracted shapes&quot;)
(herald &quot;Grant Negotiation and Authorization Protocol&quot; (limit 3000)
  (depth 1000) (bound 16)
  (comment
    &quot;This protocol allows a piece of software, the client instance, to request delegated authorization to resource servers and to request direct information&quot;))
(comment &quot;CPSA 3.6.9&quot;)
(comment &quot;All input read from GNAP_refresh_scenario.scm&quot;)
(comment &quot;Step count limited to 3000&quot;)
(comment &quot;Strand count bounded at 16&quot;)
(comment &quot;Tree depth bounded at 1000&quot;)</pre>

<p id="t0">Tree 0, POV <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='1654.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 1654.920' font-size='12.000'>
  <text
   x='89.880' y='1601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1284&quot;, &quot;_self&quot;)'>1284</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1282&quot;, &quot;_self&quot;)'>1282</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1261&quot;, &quot;_self&quot;)'>1261</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1259&quot;, &quot;_self&quot;)'>1259</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1257&quot;, &quot;_self&quot;)'>1257</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1155&quot;, &quot;_self&quot;)'>1155</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1153&quot;, &quot;_self&quot;)'>1153</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1151&quot;, &quot;_self&quot;)'>1151</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1133&quot;, &quot;_self&quot;)'>1133</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1131&quot;, &quot;_self&quot;)'>1131</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1129&quot;, &quot;_self&quot;)'>1129</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1111&quot;, &quot;_self&quot;)'>1111</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1109&quot;, &quot;_self&quot;)'>1109</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1107&quot;, &quot;_self&quot;)'>1107</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k765&quot;, &quot;_self&quot;)'>765</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k763&quot;, &quot;_self&quot;)'>763</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k743&quot;, &quot;_self&quot;)'>743</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k741&quot;, &quot;_self&quot;)'>741</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k641&quot;, &quot;_self&quot;)'>641</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k639&quot;, &quot;_self&quot;)'>639</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k619&quot;, &quot;_self&quot;)'>619</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k617&quot;, &quot;_self&quot;)'>617</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='813.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol token_refresh basic
  (defrole client
    (vars (c as rs name)
      (access management_uri management_uri_new response response_error
        response_new data) (n1 n2 n3 n4 text) (token token_new mesg))
    (trace (send (enc c n1 (pubk as))) (recv (enc as n1 n2 (pubk c)))
      (send (enc n2 (pubk as))) (send (enc c access (hash n1 n2)))
      (recv (enc management_uri token (hash n1 n2)))
      (send (enc c n3 (pubk rs))) (recv (enc rs n3 n4 (pubk c)))
      (send (enc n4 (pubk rs))) (send (enc token (hash n3 n4)))
      (recv (enc response (hash n3 n4))) (send (enc token (hash n3 n4)))
      (recv (enc response_error (hash n3 n4)))
      (send (enc token (hash n1 n2)))
      (recv (enc management_uri_new token_new (hash n1 n2)))
      (send (enc token_new (hash n3 n4)))
      (recv (enc response_new (hash n3 n4)))))
  (defrole authorization_server
    (vars (c as rs name)
      (access access_token access_token_new access_type management_uri
        management_uri_new value data) (n1 n2 text))
    (trace (recv (enc c n1 (pubk as))) (send (enc as n1 n2 (pubk c)))
      (recv (enc n2 (pubk as))) (recv (enc c access (hash n1 n2)))
      (send
        (enc management_uri
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n1 n2)))
      (recv
        (enc
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n1 n2)))
      (send
        (enc management_uri_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs)) (hash n1 n2)))))
  (defrole resource_server
    (vars (c as rs name)
      (access_token access_token_new value access_type response
        response_error response_new data) (n3 n4 text))
    (trace (recv (enc c n3 (pubk rs))) (send (enc rs n3 n4 (pubk c)))
      (recv (enc n4 (pubk rs)))
      (recv
        (enc
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n3 n4))) (send (enc response (hash n3 n4)))
      (recv
        (enc
          (enc (enc access_token value access_type (privk as))
            (pubk rs)) (hash n3 n4)))
      (send (enc response_error (hash n3 n4)))
      (recv
        (enc
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs)) (hash n3 n4)))
      (send (enc response_new (hash n3 n4))))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Children: <a href="#k617">617</a> <a href="#k619">619</a> <a href="#k639">639</a> <a href="#k641">641</a> <a href="#k741">741</a> <a href="#k743">743</a> <a href="#k763">763</a> <a href="#k765">765</a> <a href="#k1107">1107</a> <a href="#k1109">1109</a> <a href="#k1111">1111</a> <a href="#k1129">1129</a> <a href="#k1131">1131</a> <a href="#k1133">1133</a> <a href="#k1151">1151</a> <a href="#k1153">1153</a> <a href="#k1155">1155</a> <a href="#k1257">1257</a> <a href="#k1259">1259</a> <a href="#k1261">1261</a> <a href="#k1282">1282</a> <a href="#k1284">1284</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>(enc response_new (hash n3 n4))</title>
   <circle style='fill: red;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(enc token_new (hash n3 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc management_uri_new token_new (hash n1 n2))</title>
   <circle style='fill: red;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g><title>(enc token (hash n1 n2))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4))</title>
   <circle style='fill: red;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>(enc token (hash n3 n4))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc token (hash n3 n4))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc management_uri token (hash n1 n2))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((token token) (token_new token_new) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response_error) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>token_refresh 0</text></svg></div>

<pre>(defskeleton token_refresh
  (vars (token token_new mesg) (n1 n3 n2 n4 text)
    (access management_uri management_uri_new response response_error
      response_new data) (c as rs name))
  (defstrand client 16 (token token) (token_new token_new) (n1 n1)
    (n2 n2) (n3 n3) (n4 n4) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response_error) (response_new response_new) (c c)
    (as as) (rs rs))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (label 0)
  (unrealized (0 1) (0 4) (0 6) (0 9) (0 11) (0 13) (0 15))
  (origs (n1 (0 0)) (n3 (0 5)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k617">Item <a href="#t0">617</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 617 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 617)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k619">Item <a href="#t0">619</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 619 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 619)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k639">Item <a href="#t0">639</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 639 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 639)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k641">Item <a href="#t0">641</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 641 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 641)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k741">Item <a href="#t0">741</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 741 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 4) (0 9))
    ((2 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 741)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k743">Item <a href="#t0">743</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 743 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_error) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 4) (0 9))
    ((2 6) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 743)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k763">Item <a href="#t0">763</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 939.960 Q 141.584 1049.964 43.287 1234.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_new (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (response_error response_new) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_new) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 763 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_new access_token value access_type
      response data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_new) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (response_error response_new) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 4) (0 9))
    ((2 6) (0 15)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 2 3 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 763)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_new) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k765">Item <a href="#t0">765</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 765 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value data)
    (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 4) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 765)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1107">Item <a href="#t0">1107</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1107 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1107)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1109">Item <a href="#t0">1109</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1109 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1109)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response_error) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1111">Item <a href="#t0">1111</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1111 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1111)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1129">Item <a href="#t0">1129</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1129 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1129)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1131">Item <a href="#t0">1131</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1131 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1131)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1133">Item <a href="#t0">1133</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response_error) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1133 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response_error)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1133)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response_error) (response_new response-0)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1151">Item <a href="#t0">1151</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1151 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1151)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1153">Item <a href="#t0">1153</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1153 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1153)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1155">Item <a href="#t0">1155</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1579.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1579.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1464.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response) (response_error response-0) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1155 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response access_token access_type value
      response-0 response_error data) (as rs c name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response) (response_error response-0)
    (response_new response-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response-0)
    (response_error response_error) (response_new response) (c c)
    (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 8) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1155)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response)
        (response_error response-0) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1257">Item <a href="#t0">1257</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1257 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_error) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9))
    ((2 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 9)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1257)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_error)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1259">Item <a href="#t0">1259</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response_error-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1259 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response_error-0) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9))
    ((2 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1259)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response_error-0)
        (n2 n4) (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1261">Item <a href="#t0">1261</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1089.960 Q 142.920 1052.460 45.960 1089.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle cx='239.880' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response_error (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response_error-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (access_token_new access_token) (value value) (access_type access_type) (response response) (response_error response_error-0) (response_new response_error) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_type access_type) (management_uri management_uri) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri) (response response_error-0) (response_error response_error) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1261 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (access management_uri response_error access_token value access_type
      response response_error-0 data) (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri) (management_uri_new management_uri)
    (response response_error-0) (response_error response_error)
    (response_new response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_type access_type)
    (management_uri management_uri) (value value) (c c) (as as) (rs rs))
  (defstrand resource_server 9 (n3 n3) (n4 n4-0)
    (access_token access_token) (access_token_new access_token)
    (value value) (access_type access_type) (response response)
    (response_error response_error-0) (response_new response_error)
    (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 6) (0 9))
    ((2 8) (0 11)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 2 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1261)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri) (response response_error-0)
        (response_error response_error) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1282">Item <a href="#t0">1282</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1282 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 6) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 7)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1282)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k1284">Item <a href="#t0">1284</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='489.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc response-0 (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri_new (enc (enc access_token_new value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <path
   d='M 39.960 1164.960 Q 136.920 1127.460 233.880 1164.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc management_uri (enc (enc access_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (access_token access_token) (access_token_new access_token_new) (access_type access_type) (management_uri management_uri) (management_uri_new management_uri_new) (value value) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (access_token access_token) (value value) (access_type access_type) (response response-0) (response_error response) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc access_token value access_type (privk as)) (pubk rs))) (token_new (enc (enc access_token_new value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (management_uri management_uri) (management_uri_new management_uri_new) (response response) (response_error response) (response_new response-0) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>token_refresh 1284 (realized)</text>
  </svg></div>

<pre>(defskeleton token_refresh
  (vars (n1 n3 n4 n4-0 text)
    (management_uri_new response response-0 access access_token
      access_token_new access_type management_uri value data)
    (c as rs name))
  (defstrand client 16
    (token
      (enc (enc access_token value access_type (privk as)) (pubk rs)))
    (token_new
      (enc (enc access_token_new value access_type (privk as))
        (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (management_uri management_uri)
    (management_uri_new management_uri_new) (response response)
    (response_error response) (response_new response-0) (c c) (as as)
    (rs rs))
  (defstrand resource_server 7 (n3 n3) (n4 n4-0)
    (access_token access_token) (value value) (access_type access_type)
    (response response-0) (response_error response) (c c) (as as)
    (rs rs))
  (defstrand authorization_server 7 (n1 n1) (n2 n4) (access access)
    (access_token access_token) (access_token_new access_token_new)
    (access_type access_type) (management_uri management_uri)
    (management_uri_new management_uri_new) (value value) (c c) (as as)
    (rs rs))
  (precedes ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (1 0)) ((0 8) (1 3))
    ((0 12) (2 5)) ((1 1) (0 6)) ((1 6) (0 9)) ((2 1) (0 1))
    ((2 4) (0 4)) ((2 6) (0 13)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 1 resource_server 5)
    (enc response_new (hash n3 n4-0)) (0 15))
  (label 1284)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (management_uri management_uri)
        (management_uri_new management_uri_new) (response response)
        (response_error response) (response_new response-0) (n2 n4)
        (n4 n4-0)
        (token
          (enc (enc access_token value access_type (privk as))
            (pubk rs)))
        (token_new
          (enc (enc access_token_new value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

</body>
</html>
