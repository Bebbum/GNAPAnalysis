<?xml version="1.0"?>
<!-- CPSA 3.6.9 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Grant Negotiation and Authorization Protocol</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(comment &quot;CPSA 3.6.9&quot;)
(comment &quot;Extracted shapes&quot;)
(herald &quot;Grant Negotiation and Authorization Protocol&quot; (limit 3000)
  (comment
    &quot;This protocol allows a piece of software, the client instance, to request delegated authorization to resource servers and to request direct information&quot;))
(comment &quot;CPSA 3.6.9&quot;)
(comment &quot;All input read from GNAP_simple_scenario.scm&quot;)
(comment &quot;Step count limited to 3000&quot;)</pre>

<p id="t0">Tree 0, POV <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 754.920' font-size='12.000'>
  <text
   x='89.880' y='701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k655&quot;, &quot;_self&quot;)'>655</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k566&quot;, &quot;_self&quot;)'>566</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k499&quot;, &quot;_self&quot;)'>499</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k375&quot;, &quot;_self&quot;)'>375</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k353&quot;, &quot;_self&quot;)'>353</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k322&quot;, &quot;_self&quot;)'>322</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k312&quot;, &quot;_self&quot;)'>312</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k289&quot;, &quot;_self&quot;)'>289</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k281&quot;, &quot;_self&quot;)'>281</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k171&quot;, &quot;_self&quot;)'>171</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol single_token_simple basic
  (defrole client
    (vars (c as rs name) (access response data) (n1 n2 n3 n4 text)
      (token mesg))
    (trace (send (enc c n1 (pubk as))) (recv (enc as n1 n2 (pubk c)))
      (send (enc n2 (pubk as))) (send (enc c access (hash n1 n2)))
      (recv (enc token (hash n1 n2))) (send (enc c n3 (pubk rs)))
      (recv (enc rs n3 n4 (pubk c))) (send (enc n4 (pubk rs)))
      (send (enc token (hash n3 n4)))
      (recv (enc response (hash n3 n4)))))
  (defrole authorization_server
    (vars (c as rs name) (access acess_token value access_type data)
      (n1 n2 text))
    (trace (recv (enc c n1 (pubk as))) (send (enc as n1 n2 (pubk c)))
      (recv (enc n2 (pubk as))) (recv (enc c access (hash n1 n2)))
      (send
        (enc
          (enc (enc acess_token value access_type (privk as)) (pubk rs))
          (hash n1 n2)))))
  (defrole resource_server
    (vars (c as rs name) (acess_token value access_type response data)
      (n3 n4 text))
    (trace (recv (enc c n3 (pubk rs))) (send (enc rs n3 n4 (pubk c)))
      (recv (enc n4 (pubk rs)))
      (recv
        (enc
          (enc (enc acess_token value access_type (privk as)) (pubk rs))
          (hash n3 n4))) (send (enc response (hash n3 n4))))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Children: <a href="#k171">171</a> <a href="#k281">281</a> <a href="#k289">289</a> <a href="#k312">312</a> <a href="#k322">322</a> <a href="#k353">353</a> <a href="#k375">375</a> <a href="#k499">499</a> <a href="#k566">566</a> <a href="#k655">655</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>(enc response (hash n3 n4))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc token (hash n3 n4))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4 (pubk c))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc token (hash n1 n2))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((token token) (n1 n1) (n2 n2) (n3 n3) (n4 n4) (access access) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>single_token_simple 0</text></svg></div>

<pre>(defskeleton single_token_simple
  (vars (token mesg) (n1 n3 n2 n4 text) (access response data)
    (c as rs name))
  (defstrand client 10 (token token) (n1 n1) (n2 n2) (n3 n3) (n4 n4)
    (access access) (response response) (c c) (as as) (rs rs))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (label 0)
  (unrealized (0 1) (0 4) (0 6) (0 9))
  (origs (n1 (0 0)) (n3 (0 5)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k171">Item <a href="#t0">171</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (acess_token acess_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc acess_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>single_token_simple 171 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n1 n3 n4 n4-0 text)
    (access response acess_token value access_type data) (as rs c name))
  (defstrand client 10
    (token
      (enc (enc acess_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (response response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (acess_token acess_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 8) (2 3))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6)) ((2 4) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 3 0 client 9)
    (enc
      (enc (enc acess_token-0 value-0 access_type-0 (privk as-0))
        (pubk rs-0)) (hash n3 n4-0)) (2 3))
  (label 171)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (response response) (n2 n4) (n4 n4-0)
        (token
          (enc (enc acess_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k281">Item <a href="#t0">281</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 292.860 789.960 245.880 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk rs)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(enc c access (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk rs)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n3) (n2 n4-0) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as rs) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (acess_token acess_token) (value value) (access_type access_type) (response response) (c c) (as rs) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (cat c access)) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 281 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n1 n3 n4 n4-0 text)
    (access response acess_token value access_type data) (as c rs name))
  (defstrand client 10 (token (cat c access)) (n1 n1) (n2 n4) (n3 n3)
    (n4 n4-0) (access access) (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (acess_token acess_token) (value value) (access_type access_type)
    (response response) (c c) (as rs) (rs rs))
  (defstrand authorization_server 5 (n1 n3) (n2 n4-0) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as rs) (rs rs))
  (precedes ((0 0) (1 0)) ((0 5) (2 0)) ((0 5) (3 0)) ((0 8) (3 3))
    ((1 1) (0 1)) ((2 1) (0 6)) ((2 4) (0 9)) ((3 4) (2 3)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk c) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc c access-0 (hash n3 n4-0)) (3 3))
  (label 281)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (response response) (n2 n4) (n4 n4-0) (token (cat c access)))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k289">Item <a href="#t0">289</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 292.860 789.960 245.880 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as-0)) (pubk as-0)) (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(enc c access (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk as-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as-0 n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk as-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as-0)) (pubk as-0)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk as-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc as-0 n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk as-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk as-0))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc as-0 n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 137.111 488.906 234.262 562.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk as-0))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n3) (n2 n4-0) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as-0) (rs as-0))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (acess_token acess_token) (value value) (access_type access_type) (response response) (c c) (as as-0) (rs as-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (cat c access)) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (response response) (c c) (as as) (rs as-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 289 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n1 n3 n4 n4-0 text)
    (access response acess_token value access_type data)
    (as as-0 c name))
  (defstrand client 10 (token (cat c access)) (n1 n1) (n2 n4) (n3 n3)
    (n4 n4-0) (access access) (response response) (c c) (as as)
    (rs as-0))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (acess_token acess_token) (value value) (access_type access_type)
    (response response) (c c) (as as-0) (rs as-0))
  (defstrand authorization_server 5 (n1 n3) (n2 n4-0) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as-0) (rs as-0))
  (precedes ((0 0) (1 0)) ((0 5) (2 0)) ((0 5) (3 0)) ((0 8) (3 3))
    ((1 1) (0 1)) ((2 4) (0 9)) ((3 1) (0 6)) ((3 4) (2 3)))
  (neq (c as) (c as-0) (as as-0))
  (non-orig (privk as) (privk as-0) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc c access-0 (hash n3 n4-0)) (3 3))
  (label 289)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs as-0) (n1 n1) (n3 n3) (access access)
        (response response) (n2 n4) (n4 n4-0) (token (cat c access)))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k312">Item <a href="#t0">312</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (acess_token acess_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs rs))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((token (enc (enc acess_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 312 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n1 n3 n4 n4-0 text)
    (access response acess_token value access_type data) (c as rs name))
  (defstrand client 10
    (token
      (enc (enc acess_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (response response) (c c) (as as) (rs rs))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (acess_token acess_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 3) (1 3)) ((0 5) (2 0)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((1 4) (0 4)) ((2 1) (0 6))
    ((3 4) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc
      (enc (enc acess_token-0 value-0 access_type-0 (privk as-0))
        (pubk rs-0)) (hash n3 n4-0)) (3 3))
  (label 312)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (response response) (n2 n4) (n4 n4-0)
        (token
          (enc (enc acess_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k322">Item <a href="#t0">322</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (acess_token acess_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc acess_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 322 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n1 n3 n4 n4-0 text)
    (access response acess_token value access_type data) (as rs c name))
  (defstrand client 10
    (token
      (enc (enc acess_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (acess_token acess_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 8) (3 3)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 1) (0 6))
    ((3 4) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk as) (privk rs) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc
      (enc (enc acess_token-0 value-0 access_type-0 (privk as-0))
        (pubk rs-0)) (hash n3 n4-0)) (3 3))
  (label 322)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (response response) (n2 n4) (n4 n4-0)
        (token
          (enc (enc acess_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k353">Item <a href="#t0">353</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk rs-0)) (pubk rs-0)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc rs-0 n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n1 n4))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk rs-0)) (pubk rs-0)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 186.900 527.460 333.840 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc response (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk rs-0))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc rs-0 n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk rs-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as rs-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n1) (n4 n4) (acess_token acess_token) (value value) (access_type access_type) (response response) (c c) (as rs-0) (rs rs-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token response) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (response response) (c c) (as rs-0) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 353 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n1 n3 n4 n4-0 text)
    (access acess_token value access_type response data)
    (rs c rs-0 name))
  (defstrand client 10 (token response) (n1 n1) (n2 n4) (n3 n3)
    (n4 n4-0) (access access) (response response) (c c) (as rs-0)
    (rs rs))
  (defstrand resource_server 5 (n3 n1) (n4 n4) (acess_token acess_token)
    (value value) (access_type access_type) (response response) (c c)
    (as rs-0) (rs rs-0))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as rs-0) (rs rs-0))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((1 1) (0 1)) ((1 4) (0 4)) ((2 4) (1 3)) ((3 1) (0 6)))
  (neq (c rs-0) (c rs) (rs-0 rs))
  (non-orig (privk rs) (privk c) (privk rs-0))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc response-0 (hash n3 n4-0)) (0 9))
  (label 353)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as rs-0) (rs rs) (n1 n1) (n3 n3) (access access)
        (response response) (n2 n4) (n4 n4-0) (token response))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k375">Item <a href="#t0">375</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk as)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n1 n4))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 186.900 527.460 333.840 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc response (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 87.540 150.660 135.121 186.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n1) (n4 n4) (acess_token acess_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token response) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 375 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n1 n3 n4 n4-0 text)
    (access acess_token value access_type response data) (rs as c name))
  (defstrand client 10 (token response) (n1 n1) (n2 n4) (n3 n3)
    (n4 n4-0) (access access) (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 5 (n3 n1) (n4 n4) (acess_token acess_token)
    (value value) (access_type access_type) (response response) (c c)
    (as as) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((1 4) (0 4)) ((2 1) (0 1)) ((2 4) (1 3)) ((3 1) (0 6)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk as) (privk c))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 4 0 client 9)
    (enc response-0 (hash n3 n4-0)) (0 9))
  (label 375)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (response response) (n2 n4) (n4 n4-0) (token response))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k499">Item <a href="#t0">499</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 789.960 Q 392.820 789.960 345.840 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk rs)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(enc c access (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 864.960 Q 192.900 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk rs)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.990 489.232 334.019 563.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n3) (n2 n4-0) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as rs) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (acess_token acess_token) (value value) (access_type access_type) (response response) (c c) (as rs) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (cat c access)) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>single_token_simple 499 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n1 n3 n4 n4-0 text)
    (access response acess_token value access_type data) (c as rs name))
  (defstrand client 10 (token (cat c access)) (n1 n1) (n2 n4) (n3 n3)
    (n4 n4-0) (access access) (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (acess_token acess_token) (value value) (access_type access_type)
    (response response) (c c) (as rs) (rs rs))
  (defstrand authorization_server 5 (n1 n3) (n2 n4-0) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as rs) (rs rs))
  (precedes ((0 0) (1 0)) ((0 5) (2 0)) ((0 5) (3 0)) ((0 5) (4 0))
    ((0 8) (4 3)) ((1 1) (0 1)) ((2 1) (0 6)) ((3 4) (0 9))
    ((4 4) (3 3)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 0 client 9)
    (enc c access-0 (hash n3 n4-0)) (4 3))
  (label 499)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (response response) (n2 n4) (n4 n4-0) (token (cat c access)))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k566">Item <a href="#t0">566</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 236.880 677.460 433.800 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n3 n4-0))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n3 n3) (n4 n4-0) (acess_token acess_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs rs))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token (enc (enc acess_token value access_type (privk as)) (pubk rs))) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>single_token_simple 566 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n1 n3 n4 n4-0 text)
    (access response acess_token value access_type data) (c as rs name))
  (defstrand client 10
    (token
      (enc (enc acess_token value access_type (privk as)) (pubk rs)))
    (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access)
    (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (defstrand resource_server 5 (n3 n3) (n4 n4-0)
    (acess_token acess_token) (value value) (access_type access_type)
    (response response) (c c) (as as) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 3) (2 3)) ((0 5) (3 0))
    ((0 5) (4 0)) ((0 8) (4 3)) ((1 1) (0 1)) ((2 4) (0 4))
    ((3 1) (0 6)) ((4 4) (0 9)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 0 client 9)
    (enc
      (enc (enc acess_token-0 value-0 access_type-0 (privk as-0))
        (pubk rs-0)) (hash n3 n4-0)) (4 3))
  (label 566)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (response response) (n2 n4) (n4 n4-0)
        (token
          (enc (enc acess_token value access_type (privk as))
            (pubk rs))))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

<p id="k655">Item <a href="#t0">655</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 639.960 Q 242.880 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk as)) (hash n1 n4))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc response (hash n1 n4))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk as)) (hash n1 n4))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc response (hash n3 n4-0))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc n4-0 (pubk rs))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc rs n3 n4-0 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 236.880 527.460 433.800 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n3 (pubk rs))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc response (hash n1 n4))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n4))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n4 (pubk as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n4 (pubk c))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 137.111 113.906 234.262 187.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((n3 n3) (n4 n4-0) (c c) (rs rs))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (n2 n4) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs as))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n3 n1) (n4 n4) (acess_token acess_token) (value value) (access_type access_type) (response response) (c c) (as as) (rs as))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((n3 n1) (n4 n4) (c c) (rs as))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((token response) (n1 n1) (n2 n4) (n3 n3) (n4 n4-0) (access access) (response response) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>single_token_simple 655 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n1 n3 n4 n4-0 text)
    (access acess_token value access_type response data) (c as rs name))
  (defstrand client 10 (token response) (n1 n1) (n2 n4) (n3 n3)
    (n4 n4-0) (access access) (response response) (c c) (as as) (rs rs))
  (defstrand resource_server 2 (n3 n1) (n4 n4) (c c) (rs as))
  (defstrand resource_server 5 (n3 n1) (n4 n4) (acess_token acess_token)
    (value value) (access_type access_type) (response response) (c c)
    (as as) (rs as))
  (defstrand authorization_server 5 (n1 n1) (n2 n4) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs as))
  (defstrand resource_server 2 (n3 n3) (n4 n4-0) (c c) (rs rs))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 0) (3 0)) ((0 3) (3 3))
    ((0 5) (4 0)) ((1 1) (0 1)) ((2 4) (0 4)) ((3 4) (2 3))
    ((4 1) (0 6)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n1 n3)
  (operation encryption-test (displaced 5 0 client 9)
    (enc response-0 (hash n3 n4-0)) (0 9))
  (label 655)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n1 n1) (n3 n3) (access access)
        (response response) (n2 n4) (n4 n4-0) (token response))))
  (origs (n1 (0 0)) (n3 (0 5))))</pre>

</body>
</html>
