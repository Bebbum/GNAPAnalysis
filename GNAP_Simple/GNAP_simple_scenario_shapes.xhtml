<?xml version="1.0"?>
<!-- CPSA 3.6.9 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Grant Negotiation and Authorization Protocol</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(comment &quot;CPSA 3.6.9&quot;)
(comment &quot;Extracted shapes&quot;)
(herald &quot;Grant Negotiation and Authorization Protocol&quot; (limit 100)
  (comment
    &quot;This protocol allows a piece of software, the client instance, to request delegated authorization to resource servers and to request direct information&quot;))
(comment &quot;CPSA 3.6.9&quot;)
(comment &quot;All input read from GNAP_simple_scenario.scm&quot;)
(comment &quot;Step count limited to 100&quot;)</pre>

<p id="t0">Tree 0, POV <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='2029.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 2029.920' font-size='12.000'>
  <text
   x='89.880' y='1976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k41&quot;, &quot;_self&quot;)'>41</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='1989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k40&quot;, &quot;_self&quot;)'>40</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='1914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k39&quot;, &quot;_self&quot;)'>39</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k38&quot;, &quot;_self&quot;)'>38</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='1764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k37&quot;, &quot;_self&quot;)'>37</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k36&quot;, &quot;_self&quot;)'>36</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k35&quot;, &quot;_self&quot;)'>35</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k34&quot;, &quot;_self&quot;)'>34</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k33&quot;, &quot;_self&quot;)'>33</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k31&quot;, &quot;_self&quot;)'>31</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k30&quot;, &quot;_self&quot;)'>30</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k29&quot;, &quot;_self&quot;)'>29</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k28&quot;, &quot;_self&quot;)'>28</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k27&quot;, &quot;_self&quot;)'>27</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k25&quot;, &quot;_self&quot;)'>25</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k24&quot;, &quot;_self&quot;)'>24</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k22&quot;, &quot;_self&quot;)'>22</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k21&quot;, &quot;_self&quot;)'>21</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k19&quot;, &quot;_self&quot;)'>19</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k17&quot;, &quot;_self&quot;)'>17</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k16&quot;, &quot;_self&quot;)'>16</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k15&quot;, &quot;_self&quot;)'>15</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k14&quot;, &quot;_self&quot;)'>14</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k12&quot;, &quot;_self&quot;)'>12</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8&quot;, &quot;_self&quot;)'>8</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7&quot;, &quot;_self&quot;)'>7</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='39.960' y1='1014.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='1001.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol single_token_simple basic
  (defrole client
    (vars (c as rs name) (access acess_token value rights response data)
      (n1 n2 text) (k akey))
    (trace (send (enc c access (pubk c) (ltk c as)))
      (recv
        (enc (enc n1 (enc acess_token value rights (invk k)) (pubk c))
          (ltk c as)))
      (send
        (enc (enc n2 (enc acess_token value rights (invk k)) (pubk c))
          (ltk c rs))) (recv (enc (enc response (pubk c)) (ltk c rs)))))
  (defrole authorization_server
    (vars (c as name) (access acess_token value rights data) (n1 text)
      (k akey))
    (trace (recv (enc c access (pubk c) (ltk c as)))
      (send
        (enc (enc n1 (enc acess_token value rights (invk k)) (pubk c))
          (ltk c as)))))
  (defrole resource_server
    (vars (c rs name) (acess_token value rights response data) (n2 text)
      (k akey))
    (trace
      (recv
        (enc (enc n2 (enc acess_token value rights (invk k)) (pubk c))
          (ltk c rs)))
      (send (enc (enc response (pubk c)) (ltk c rs))))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Children: <a href="#k6">6</a> <a href="#k7">7</a> <a href="#k8">8</a> <a href="#k12">12</a> <a href="#k14">14</a> <a href="#k15">15</a> <a href="#k16">16</a> <a href="#k17">17</a> <a href="#k19">19</a> <a href="#k21">21</a> <a href="#k22">22</a> <a href="#k24">24</a> <a href="#k25">25</a> <a href="#k27">27</a> <a href="#k28">28</a> <a href="#k29">29</a> <a href="#k30">30</a> <a href="#k31">31</a> <a href="#k33">33</a> <a href="#k34">34</a> <a href="#k35">35</a> <a href="#k36">36</a> <a href="#k37">37</a> <a href="#k38">38</a> <a href="#k39">39</a> <a href="#k40">40</a> <a href="#k41">41</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>single_token_simple 0</text></svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 text) (access acess_token value rights response data)
    (c as rs name) (k akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs rs) (k k))
  (non-orig (ltk c as) (ltk c rs) k)
  (uniq-orig n2)
  (label 0)
  (unrealized (0 1) (0 3))
  (origs (n2 (0 2)))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k6">Item <a href="#t0">6</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((n2 n2) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (rs rs) (k k))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1-0) (n2 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as-0) (rs as) (k k))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>single_token_simple 6 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n1-0 text)
    (access acess_token value rights response access-0 data)
    (c as rs as-0 name) (k akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs rs) (k k))
  (defstrand client 3 (n1 n1-0) (n2 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as-0) (rs as) (k k))
  (defstrand resource_server 2 (n2 n2) (acess_token acess_token)
    (value value) (rights rights) (response response) (c c) (rs rs)
    (k k))
  (precedes ((0 2) (2 0)) ((1 2) (0 1)) ((2 1) (0 3)))
  (non-orig (ltk c as) (ltk c rs) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 3 0 client 3)
    (enc
      (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0))
        (pubk c)) (ltk c rs)) (2 0))
  (label 6)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k7">Item <a href="#t0">7</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((n2 n1) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (rs as) (k k))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1-0) (n2 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as-0) (rs as) (k k))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs as) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>single_token_simple 7 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n1-0 text)
    (access acess_token value rights response access-0 data)
    (c as as-0 name) (k akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs as) (k k))
  (defstrand client 3 (n1 n1-0) (n2 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as-0) (rs as) (k k))
  (defstrand resource_server 2 (n2 n1) (acess_token acess_token)
    (value value) (rights rights) (response response) (c c) (rs as)
    (k k))
  (precedes ((1 2) (0 1)) ((1 2) (2 0)) ((2 1) (0 3)))
  (non-orig (ltk c as) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 3 1 client 3)
    (enc
      (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0))
        (pubk c)) (ltk c rs)) (2 0))
  (label 7)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs as) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k8">Item <a href="#t0">8</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-1 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-1 (pubk c) (ltk c as-1))</title>
   <circle cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n2-0) (access access-1) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as-1) (rs rs) (k k-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs rs) (k k-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1-0) (n2 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as-0) (rs as) (k k))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 8 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n1-0 n2-0 n1-1 text)
    (access acess_token value rights response access-0 acess_token-0
      value-0 rights-0 access-1 data) (c as rs as-0 as-1 name)
    (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs rs) (k k))
  (defstrand client 3 (n1 n1-0) (n2 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as-0) (rs as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c) (rs rs)
    (k k-0))
  (defstrand client 3 (n1 n1-1) (n2 n2-0) (access access-1)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as-1) (rs rs) (k k-0))
  (precedes ((1 2) (0 1)) ((2 1) (0 3)) ((3 2) (2 0)))
  (non-orig (ltk c as) (ltk c rs) k)
  (uniq-orig n2)
  (operation encryption-test (added-strand client 3)
    (enc
      (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0))
        (pubk c)) (ltk c rs)) (2 0))
  (label 8)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k12">Item <a href="#t0">12</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.320 300.660 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n2-0) (access access) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as) (k k-0))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs as) (k k-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1-0) (n2 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as-0) (rs as) (k k))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs as) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 12 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n1-0 n2-0 text)
    (access acess_token value rights response access-0 acess_token-0
      value-0 rights-0 data) (c as as-0 name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs as) (k k))
  (defstrand client 3 (n1 n1-0) (n2 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as-0) (rs as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c) (rs as)
    (k k-0))
  (defstrand authorization_server 2 (n1 n2-0) (access access)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as) (k k-0))
  (precedes ((0 0) (3 0)) ((1 2) (0 1)) ((2 1) (0 3)) ((3 1) (2 0)))
  (non-orig (ltk c as) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 4 0 client 1)
    (enc c access-1 (pubk c) (ltk c rs)) (3 0))
  (label 12)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs as) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k14">Item <a href="#t0">14</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-1 (pubk c) (ltk c rs))</title>
   <circle cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-1 (pubk c) (ltk c rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.320 300.660 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((access access-1) (c c) (as rs))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n2-0) (access access-1) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as rs) (k k-0))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs rs) (k k-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1-0) (n2 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as-0) (rs as) (k k))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>single_token_simple 14 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n1-0 n2-0 text)
    (access acess_token value rights response access-0 acess_token-0
      value-0 rights-0 access-1 data) (c as rs as-0 name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs rs) (k k))
  (defstrand client 3 (n1 n1-0) (n2 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as-0) (rs as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c) (rs rs)
    (k k-0))
  (defstrand authorization_server 2 (n1 n2-0) (access access-1)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as rs) (k k-0))
  (defstrand client 1 (access access-1) (c c) (as rs))
  (precedes ((1 2) (0 1)) ((2 1) (0 3)) ((3 1) (2 0)) ((4 0) (3 0)))
  (non-orig (ltk c as) (ltk c rs) k)
  (uniq-orig n2)
  (operation encryption-test (added-strand client 1)
    (enc c access-1 (pubk c) (ltk c rs)) (3 0))
  (label 14)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k15">Item <a href="#t0">15</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n2 n2) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (rs rs) (k k))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (access access) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>single_token_simple 15 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 text) (access acess_token value rights response data)
    (c as rs name) (k akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs rs) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand resource_server 2 (n2 n2) (acess_token acess_token)
    (value value) (rights rights) (response response) (c c) (rs rs)
    (k k))
  (precedes ((0 0) (1 0)) ((0 2) (2 0)) ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (ltk c as) (ltk c rs) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 3 0 client 3)
    (enc
      (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0))
        (pubk c)) (ltk c rs)) (2 0))
  (label 15)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k16">Item <a href="#t0">16</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as-0))</title>
   <circle cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as-0) (rs rs) (k k-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs rs) (k k-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (access access) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 16 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n2-0 n1-0 text)
    (access acess_token value rights response acess_token-0 value-0
      rights-0 access-0 data) (c as rs as-0 name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs rs) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c) (rs rs)
    (k k-0))
  (defstrand client 3 (n1 n1-0) (n2 n2-0) (access access-0)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as-0) (rs rs) (k k-0))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 2) (2 0)))
  (non-orig (ltk c as) (ltk c rs) k)
  (uniq-orig n2)
  (operation encryption-test (added-strand client 3)
    (enc
      (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0))
        (pubk c)) (ltk c rs)) (2 0))
  (label 16)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k17">Item <a href="#t0">17</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n2 n1) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (rs as) (k k))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (access access) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs as) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>single_token_simple 17 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 text) (access acess_token value rights response data)
    (c as name) (k akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs as) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand resource_server 2 (n2 n1) (acess_token acess_token)
    (value value) (rights rights) (response response) (c c) (rs as)
    (k k))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 3)))
  (non-orig (ltk c as) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 3 1 authorization_server 2)
    (enc
      (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0))
        (pubk c)) (ltk c rs)) (2 0))
  (label 17)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs as) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k19">Item <a href="#t0">19</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n2 n2) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (rs rs) (k k))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((access access-0) (c c) (as as))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 19 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 text)
    (access acess_token value rights response access-0 data)
    (c as rs name) (k akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs rs) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand client 1 (access access-0) (c c) (as as))
  (defstrand resource_server 2 (n2 n2) (acess_token acess_token)
    (value value) (rights rights) (response response) (c c) (rs rs)
    (k k))
  (precedes ((0 2) (3 0)) ((1 1) (0 1)) ((2 0) (1 0)) ((3 1) (0 3)))
  (non-orig (ltk c as) (ltk c rs) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 4 0 client 3)
    (enc
      (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0))
        (pubk c)) (ltk c rs)) (3 0))
  (label 19)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k21">Item <a href="#t0">21</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-1 (pubk c) (ltk c as-0))</title>
   <circle cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access-1) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as-0) (rs rs) (k k-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs rs) (k k-0))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((access access-0) (c c) (as as))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>single_token_simple 21 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n2-0 n1-0 text)
    (access acess_token value rights response access-0 acess_token-0
      value-0 rights-0 access-1 data) (c as rs as-0 name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs rs) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand client 1 (access access-0) (c c) (as as))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c) (rs rs)
    (k k-0))
  (defstrand client 3 (n1 n1-0) (n2 n2-0) (access access-1)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as-0) (rs rs) (k k-0))
  (precedes ((1 1) (0 1)) ((2 0) (1 0)) ((3 1) (0 3)) ((4 2) (3 0)))
  (non-orig (ltk c as) (ltk c rs) k)
  (uniq-orig n2)
  (operation encryption-test (added-strand client 3)
    (enc
      (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0))
        (pubk c)) (ltk c rs)) (3 0))
  (label 21)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k22">Item <a href="#t0">22</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 192.810 264.232 45.781 338.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n2 n1) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (rs as) (k k))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((access access-0) (c c) (as as))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs as) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 22 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 text)
    (access acess_token value rights response access-0 data) (c as name)
    (k akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs as) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand client 1 (access access-0) (c c) (as as))
  (defstrand resource_server 2 (n2 n1) (acess_token acess_token)
    (value value) (rights rights) (response response) (c c) (rs as)
    (k k))
  (precedes ((1 1) (0 1)) ((1 1) (3 0)) ((2 0) (1 0)) ((3 1) (0 3)))
  (non-orig (ltk c as) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 4 1 authorization_server 2)
    (enc
      (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0))
        (pubk c)) (ltk c rs)) (3 0))
  (label 22)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs as) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k24">Item <a href="#t0">24</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 292.860 227.460 145.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-1))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-1 (pubk c) (ltk c as-1))</title>
   <circle cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as-0))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 141.913 337.717 43.945 485.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n1-0) (access access-1) (acess_token acess_token) (value value) (rights rights) (c c) (as as-1) (rs as-0) (k k))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n2-0) (access access-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as-0) (k k-0))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs as-0) (k k-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1-0) (n2 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as-0) (rs as) (k k))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs as-0) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>single_token_simple 24 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n1-0 n2-0 n1-1 text)
    (access acess_token value rights response access-0 acess_token-0
      value-0 rights-0 access-1 data) (c as as-0 as-1 name)
    (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs as-0) (k k))
  (defstrand client 3 (n1 n1-0) (n2 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as-0) (rs as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c)
    (rs as-0) (k k-0))
  (defstrand authorization_server 2 (n1 n2-0) (access access-0)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as-0) (k k-0))
  (defstrand client 3 (n1 n1-1) (n2 n1-0) (access access-1)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as-1) (rs as-0) (k k))
  (precedes ((1 0) (3 0)) ((1 2) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 2) (1 1)))
  (non-orig (ltk c as) (ltk c as-0) k)
  (uniq-orig n2)
  (operation encryption-test (added-strand client 3)
    (enc (enc n1-0 (enc acess_token value rights (invk k)) (pubk c))
      (ltk c as-0)) (1 1))
  (label 24)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs as-0) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k25">Item <a href="#t0">25</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.320 300.660 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((n1 n2-0) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as-0) (k k))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (rs as-0) (k k))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n2-0) (n2 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as-0) (rs as) (k k))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs as-0) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 25 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n2-0 text)
    (access response access-0 acess_token value rights data)
    (c as as-0 name) (k akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs as-0) (k k))
  (defstrand client 3 (n1 n2-0) (n2 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as-0) (rs as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token)
    (value value) (rights rights) (response response) (c c) (rs as-0)
    (k k))
  (defstrand authorization_server 2 (n1 n2-0) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as-0) (k k))
  (precedes ((1 0) (3 0)) ((1 2) (0 1)) ((2 1) (0 3)) ((3 1) (1 1))
    ((3 1) (2 0)))
  (non-orig (ltk c as) (ltk c as-0) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 4 3 authorization_server 2)
    (enc
      (enc n1-0 (enc acess_token-0 value-0 rights-0 (invk k-0))
        (pubk c)) (ltk c as-0)) (1 1))
  (label 25)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs as-0) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k27">Item <a href="#t0">27</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n2-0) (access access) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as) (k k-0))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs as) (k k-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (access access) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs as) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 27 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n2-0 text)
    (access acess_token value rights response acess_token-0 value-0
      rights-0 data) (c as name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs as) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c) (rs as)
    (k k-0))
  (defstrand authorization_server 2 (n1 n2-0) (access access)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as) (k k-0))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig (ltk c as) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 4 0 client 1)
    (enc c access-0 (pubk c) (ltk c rs)) (3 0))
  (label 27)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs as) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k28">Item <a href="#t0">28</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c rs))</title>
   <circle cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((access access-0) (c c) (as rs))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n2-0) (access access-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as rs) (k k-0))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs rs) (k k-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (access access) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>single_token_simple 28 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n2-0 text)
    (access acess_token value rights response acess_token-0 value-0
      rights-0 access-0 data) (c as rs name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs rs) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c) (rs rs)
    (k k-0))
  (defstrand authorization_server 2 (n1 n2-0) (access access-0)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as rs) (k k-0))
  (defstrand client 1 (access access-0) (c c) (as rs))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 0) (3 0)))
  (non-orig (ltk c as) (ltk c rs) k)
  (uniq-orig n2)
  (operation encryption-test (added-strand client 1)
    (enc c access-0 (pubk c) (ltk c rs)) (3 0))
  (label 28)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k29">Item <a href="#t0">29</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 242.880 77.460 145.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c rs))</title>
   <circle cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c rs))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c rs))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n2) (n2 n2-0) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as rs) (rs rs) (k k))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (rs rs) (k k))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as rs) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as rs) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 29 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n2-0 text)
    (access acess_token value rights response access-0 data) (c rs name)
    (k akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as rs) (rs rs) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as rs) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token)
    (value value) (rights rights) (response response) (c c) (rs rs)
    (k k))
  (defstrand client 3 (n1 n2) (n2 n2-0) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as rs) (rs rs) (k k))
  (precedes ((0 2) (3 1)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 0) (1 0))
    ((3 2) (2 0)))
  (non-orig (ltk c rs) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 4 0 client 3)
    (enc
      (enc n1-0 (enc acess_token-0 value-0 rights-0 (invk k-0))
        (pubk c)) (ltk c as)) (3 1))
  (label 29)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as rs) (rs rs) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k30">Item <a href="#t0">30</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-1 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-1 (pubk c) (ltk c as-0))</title>
   <circle cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 242.880 77.460 145.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-1) (n2 n1-0) (access access-1) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as-0) (rs as) (k k-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as) (rs rs) (k k-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs rs) (k k-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>single_token_simple 30 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n2-0 n1-0 n1-1 text)
    (access acess_token value rights response acess_token-0 value-0
      rights-0 access-0 access-1 data) (c rs as as-0 name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs rs) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c) (rs rs)
    (k k-0))
  (defstrand client 3 (n1 n1-0) (n2 n2-0) (access access-0)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as) (rs rs) (k k-0))
  (defstrand client 3 (n1 n1-1) (n2 n1-0) (access access-1)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as-0) (rs as) (k k-0))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 0) (1 0)) ((3 2) (2 0))
    ((4 2) (3 1)))
  (non-orig (ltk c rs) (ltk c as) k)
  (uniq-orig n2)
  (operation encryption-test (added-strand client 3)
    (enc
      (enc n1-0 (enc acess_token-0 value-0 rights-0 (invk k-0))
        (pubk c)) (ltk c as)) (3 1))
  (label 30)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k31">Item <a href="#t0">31</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 242.880 77.460 145.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n2-0) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (rs rs) (k k))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 31 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n2-0 text)
    (access acess_token value rights response access-0 data)
    (c rs as name) (k akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs rs) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token)
    (value value) (rights rights) (response response) (c c) (rs rs)
    (k k))
  (defstrand client 3 (n1 n1) (n2 n2-0) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (rs rs) (k k))
  (precedes ((1 1) (0 1)) ((1 1) (3 1)) ((2 1) (0 3)) ((3 0) (1 0))
    ((3 2) (2 0)))
  (non-orig (ltk c rs) (ltk c as) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 4 1 authorization_server 2)
    (enc
      (enc n1-0 (enc acess_token-0 value-0 rights-0 (invk k-0))
        (pubk c)) (ltk c as)) (3 1))
  (label 31)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k33">Item <a href="#t0">33</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.810 264.232 45.781 338.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 236.880 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n2-0) (access access) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as) (k k-0))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs as) (k k-0))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((access access-0) (c c) (as as))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs as) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>single_token_simple 33 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n2-0 text)
    (access acess_token value rights response access-0 acess_token-0
      value-0 rights-0 data) (c as name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs as) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand client 1 (access access-0) (c c) (as as))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c) (rs as)
    (k k-0))
  (defstrand authorization_server 2 (n1 n2-0) (access access)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as) (k k-0))
  (precedes ((0 0) (4 0)) ((1 1) (0 1)) ((2 0) (1 0)) ((3 1) (0 3))
    ((4 1) (3 0)))
  (non-orig (ltk c as) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 5 0 client 1)
    (enc c access-1 (pubk c) (ltk c rs)) (4 0))
  (label 33)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs as) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k34">Item <a href="#t0">34</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.810 264.232 45.781 338.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 336.840 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n2-0) (access access-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as) (k k-0))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs as) (k k-0))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((access access-0) (c c) (as as))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs as) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>single_token_simple 34 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n2-0 text)
    (access acess_token value rights response access-0 acess_token-0
      value-0 rights-0 data) (c as name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs as) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand client 1 (access access-0) (c c) (as as))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c) (rs as)
    (k k-0))
  (defstrand authorization_server 2 (n1 n2-0) (access access-0)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as) (k k-0))
  (precedes ((1 1) (0 1)) ((2 0) (1 0)) ((2 0) (4 0)) ((3 1) (0 3))
    ((4 1) (3 0)))
  (non-orig (ltk c as) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 5 2 client 1)
    (enc c access-1 (pubk c) (ltk c rs)) (4 0))
  (label 34)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs as) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k35">Item <a href="#t0">35</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 114.960 Q 492.780 114.960 445.800 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-1 (pubk c) (ltk c rs))</title>
   <circle cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-1 (pubk c) (ltk c rs))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.810 264.232 45.781 338.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((access access-1) (c c) (as rs))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n2-0) (access access-1) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as rs) (k k-0))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs rs) (k k-0))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g><title>((access access-0) (c c) (as as))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>single_token_simple 35 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n2-0 text)
    (access acess_token value rights response access-0 acess_token-0
      value-0 rights-0 access-1 data) (c as rs name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs rs) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand client 1 (access access-0) (c c) (as as))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c) (rs rs)
    (k k-0))
  (defstrand authorization_server 2 (n1 n2-0) (access access-1)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as rs) (k k-0))
  (defstrand client 1 (access access-1) (c c) (as rs))
  (precedes ((1 1) (0 1)) ((2 0) (1 0)) ((3 1) (0 3)) ((4 1) (3 0))
    ((5 0) (4 0)))
  (non-orig (ltk c as) (ltk c rs) k)
  (uniq-orig n2)
  (operation encryption-test (added-strand client 1)
    (enc c access-1 (pubk c) (ltk c rs)) (4 0))
  (label 35)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k36">Item <a href="#t0">36</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 292.860 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.320 300.660 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 236.880 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-0) (access access) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n2-0) (access access-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as) (k k-0))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs as) (k k-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1-0) (n2 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (rs as) (k k))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs as) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>single_token_simple 36 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n1-0 n2-0 text)
    (access acess_token value rights response access-0 acess_token-0
      value-0 rights-0 data) (c as name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs as) (k k))
  (defstrand client 3 (n1 n1-0) (n2 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (rs as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c) (rs as)
    (k k-0))
  (defstrand authorization_server 2 (n1 n2-0) (access access-0)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as) (k k-0))
  (defstrand authorization_server 2 (n1 n1-0) (access access)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (precedes ((0 0) (4 0)) ((1 0) (3 0)) ((1 2) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (1 1)))
  (non-orig (ltk c as) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 5 0 client 1)
    (enc c access-1 (pubk c) (ltk c as-0)) (4 0))
  (label 36)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs as) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k37">Item <a href="#t0">37</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 292.860 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as-0))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.320 300.660 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-0) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as-0) (k k))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n2-0) (access access-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as-0) (k k-0))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs as-0) (k k-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1-0) (n2 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as-0) (rs as) (k k))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs as-0) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>single_token_simple 37 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n1-0 n2-0 text)
    (access acess_token value rights response access-0 acess_token-0
      value-0 rights-0 data) (c as as-0 name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs as-0) (k k))
  (defstrand client 3 (n1 n1-0) (n2 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as-0) (rs as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c)
    (rs as-0) (k k-0))
  (defstrand authorization_server 2 (n1 n2-0) (access access-0)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as-0) (k k-0))
  (defstrand authorization_server 2 (n1 n1-0) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as-0) (k k))
  (precedes ((1 0) (3 0)) ((1 0) (4 0)) ((1 2) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (1 1)))
  (non-orig (ltk c as) (ltk c as-0) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 5 1 client 1)
    (enc c access-1 (pubk c) (ltk c as-0)) (4 0))
  (label 37)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs as-0) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k38">Item <a href="#t0">38</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 114.960 Q 492.780 114.960 445.800 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-1 (pubk c) (ltk c as-0))</title>
   <circle cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 292.860 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-1 (pubk c) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as-0))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.320 300.660 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-0 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c as-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((access access-1) (c c) (as as-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1-0) (access access-1) (acess_token acess_token) (value value) (rights rights) (c c) (as as-0) (k k))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n2-0) (access access-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as-0) (k k-0))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs as-0) (k k-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1-0) (n2 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as-0) (rs as) (k k))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs as-0) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>single_token_simple 38 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n1-0 n2-0 text)
    (access acess_token value rights response access-0 acess_token-0
      value-0 rights-0 access-1 data) (c as as-0 name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs as-0) (k k))
  (defstrand client 3 (n1 n1-0) (n2 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as-0) (rs as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c)
    (rs as-0) (k k-0))
  (defstrand authorization_server 2 (n1 n2-0) (access access-0)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as-0) (k k-0))
  (defstrand authorization_server 2 (n1 n1-0) (access access-1)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as-0) (k k))
  (defstrand client 1 (access access-1) (c c) (as as-0))
  (precedes ((1 0) (3 0)) ((1 2) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 1) (1 1)) ((5 0) (4 0)))
  (non-orig (ltk c as) (ltk c as-0) k)
  (uniq-orig n2)
  (operation encryption-test (added-strand client 1)
    (enc c access-1 (pubk c) (ltk c as-0)) (4 0))
  (label 38)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs as-0) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k39">Item <a href="#t0">39</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 242.880 77.460 145.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 236.880 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-0) (access access) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as) (k k-0))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as) (rs rs) (k k-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs rs) (k k-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>single_token_simple 39 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n2-0 n1-0 text)
    (access acess_token value rights response acess_token-0 value-0
      rights-0 access-0 data) (c rs as name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs rs) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c) (rs rs)
    (k k-0))
  (defstrand client 3 (n1 n1-0) (n2 n2-0) (access access-0)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as) (rs rs) (k k-0))
  (defstrand authorization_server 2 (n1 n1-0) (access access)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as) (k k-0))
  (precedes ((0 0) (4 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 0) (1 0))
    ((3 2) (2 0)) ((4 1) (3 1)))
  (non-orig (ltk c rs) (ltk c as) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 5 0 client 1)
    (enc c access-1 (pubk c) (ltk c as)) (4 0))
  (label 39)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k40">Item <a href="#t0">40</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 242.880 77.460 145.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 386.820 114.960 433.800 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-0) (access access-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as) (k k-0))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as) (rs rs) (k k-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs rs) (k k-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>single_token_simple 40 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n2-0 n1-0 text)
    (access acess_token value rights response acess_token-0 value-0
      rights-0 access-0 data) (c rs as name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs rs) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c) (rs rs)
    (k k-0))
  (defstrand client 3 (n1 n1-0) (n2 n2-0) (access access-0)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as) (rs rs) (k k-0))
  (defstrand authorization_server 2 (n1 n1-0) (access access-0)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as) (k k-0))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 0) (1 0)) ((3 0) (4 0))
    ((3 2) (2 0)) ((4 1) (3 1)))
  (non-orig (ltk c rs) (ltk c as) k)
  (uniq-orig n2)
  (operation encryption-test (displaced 5 3 client 1)
    (enc c access-1 (pubk c) (ltk c as)) (4 0))
  (label 40)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

<p id="k41">Item <a href="#t0">41</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 114.960 Q 492.780 114.960 445.800 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-1 (pubk c) (ltk c as))</title>
   <circle cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-1 (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 242.880 77.460 145.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2-0 (enc acess_token-0 value-0 rights-0 (invk k-0)) (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access-0 (pubk c) (ltk c as))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc response (pubk c)) (ltk c rs))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n2 (enc acess_token value rights (invk k)) (pubk c)) (ltk c rs))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc (enc n1 (enc acess_token value rights (invk k)) (pubk c)) (ltk c as))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c access (pubk c) (ltk c as))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((access access-1) (c c) (as as))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1-0) (access access-1) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as) (k k-0))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (c c) (as as) (rs rs) (k k-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n2 n2-0) (acess_token acess_token-0) (value value-0) (rights rights-0) (response response) (c c) (rs rs) (k k-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>resource_server</text></g>
  <g>
   <title>((n1 n1) (access access-0) (acess_token acess_token) (value value) (rights rights) (c c) (as as) (k k))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (rights rights) (response response) (c c) (as as) (rs rs) (k k))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>single_token_simple 41 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n2-0 n1-0 text)
    (access acess_token value rights response acess_token-0 value-0
      rights-0 access-0 access-1 data) (c rs as name) (k k-0 akey))
  (defstrand client 4 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (rights rights)
    (response response) (c c) (as as) (rs rs) (k k))
  (defstrand authorization_server 2 (n1 n1) (access access-0)
    (acess_token acess_token) (value value) (rights rights) (c c)
    (as as) (k k))
  (defstrand resource_server 2 (n2 n2-0) (acess_token acess_token-0)
    (value value-0) (rights rights-0) (response response) (c c) (rs rs)
    (k k-0))
  (defstrand client 3 (n1 n1-0) (n2 n2-0) (access access-0)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as) (rs rs) (k k-0))
  (defstrand authorization_server 2 (n1 n1-0) (access access-1)
    (acess_token acess_token-0) (value value-0) (rights rights-0) (c c)
    (as as) (k k-0))
  (defstrand client 1 (access access-1) (c c) (as as))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 0) (1 0)) ((3 2) (2 0))
    ((4 1) (3 1)) ((5 0) (4 0)))
  (non-orig (ltk c rs) (ltk c as) k)
  (uniq-orig n2)
  (operation encryption-test (added-strand client 1)
    (enc c access-1 (pubk c) (ltk c as)) (4 0))
  (label 41)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (k k) (access access)
        (acess_token acess_token) (value value) (rights rights)
        (response response) (n1 n1))))
  (origs (n2 (0 2))))</pre>

</body>
</html>
