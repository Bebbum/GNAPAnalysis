<?xml version="1.0"?>
<!-- CPSA 3.6.9 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Grant Negotiation and Authorization Protocol</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(comment &quot;CPSA 3.6.9&quot;)
(comment &quot;Extracted shapes&quot;)
(herald &quot;Grant Negotiation and Authorization Protocol&quot; (limit 3000)
  (comment
    &quot;This protocol allows a piece of software, the client instance, to request delegated authorization to resource servers and to request direct information&quot;))
(comment &quot;CPSA 3.6.9&quot;)
(comment &quot;All input read from GNAP_simple_scenario.scm&quot;)
(comment &quot;Step count limited to 3000&quot;)</pre>

<p id="t0">Tree 0, POV <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 1129.920' font-size='12.000'>
  <text
   x='89.880' y='1076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k878&quot;, &quot;_self&quot;)'>878</text>
  <line
   x1='39.960' y1='564.960' x2='89.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k832&quot;, &quot;_self&quot;)'>832</text>
  <line
   x1='39.960' y1='564.960' x2='89.880' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k637&quot;, &quot;_self&quot;)'>637</text>
  <line
   x1='39.960' y1='564.960' x2='89.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k631&quot;, &quot;_self&quot;)'>631</text>
  <line
   x1='39.960' y1='564.960' x2='89.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k610&quot;, &quot;_self&quot;)'>610</text>
  <line
   x1='39.960' y1='564.960' x2='89.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k531&quot;, &quot;_self&quot;)'>531</text>
  <line
   x1='39.960' y1='564.960' x2='89.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k496&quot;, &quot;_self&quot;)'>496</text>
  <line
   x1='39.960' y1='564.960' x2='89.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k342&quot;, &quot;_self&quot;)'>342</text>
  <line
   x1='39.960' y1='564.960' x2='89.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k322&quot;, &quot;_self&quot;)'>322</text>
  <line
   x1='39.960' y1='564.960' x2='89.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k37&quot;, &quot;_self&quot;)'>37</text>
  <line
   x1='39.960' y1='564.960' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k32&quot;, &quot;_self&quot;)'>32</text>
  <line
   x1='39.960' y1='564.960' x2='89.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k22&quot;, &quot;_self&quot;)'>22</text>
  <line
   x1='39.960' y1='564.960' x2='89.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k13&quot;, &quot;_self&quot;)'>13</text>
  <line
   x1='39.960' y1='564.960' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k10&quot;, &quot;_self&quot;)'>10</text>
  <line
   x1='39.960' y1='564.960' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  <line
   x1='39.960' y1='564.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='551.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol single_token_simple basic
  (defrole client
    (vars (c as rs name) (access response data) (n1 n2 n3 n4 text)
      (token mesg))
    (trace (send (enc c n1 (pubk as))) (recv (enc as n1 n2 (pubk c)))
      (send (enc n2 (pubk as))) (send (enc c access (hash n1 n2)))
      (recv (enc token (hash n1 n2))) (send (enc c n3 (pubk rs)))
      (recv (enc rs n3 n4 (pubk c))) (send (enc n4 (pubk rs)))
      (send (enc token (hash n3 n4)))
      (recv (enc response (hash n3 n4)))))
  (defrole authorization_server
    (vars (c as rs name) (access acess_token value access_type data)
      (n1 n2 text))
    (trace (recv (enc c n1 (pubk as))) (send (enc as n1 n2 (pubk c)))
      (recv (enc n2 (pubk as))) (recv (enc c access (hash n1 n2)))
      (send
        (enc
          (enc (enc acess_token value access_type (privk as)) (pubk rs))
          (hash n1 n2)))))
  (defrole resource_server
    (vars (c as rs name) (acess_token value access_type response data)
      (n3 n4 text))
    (trace (recv (enc c n3 (pubk rs))) (send (enc rs n3 n4 (pubk c)))
      (recv (enc n4 (pubk rs)))
      (recv
        (enc
          (enc (enc acess_token value access_type (privk as)) (pubk rs))
          (hash n3 n4))) (send (enc response (hash n3 n4))))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Children: <a href="#k3">3</a> <a href="#k10">10</a> <a href="#k13">13</a> <a href="#k22">22</a> <a href="#k32">32</a> <a href="#k37">37</a> <a href="#k322">322</a> <a href="#k342">342</a> <a href="#k496">496</a> <a href="#k531">531</a> <a href="#k610">610</a> <a href="#k631">631</a> <a href="#k637">637</a> <a href="#k832">832</a> <a href="#k878">878</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>single_token_simple 0</text></svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 text) (access acess_token value access_type data)
    (c as rs name))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs rs))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n2)
  (label 0)
  (unrealized (0 2) (0 3))
  (origs (n2 (0 1)))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k3">Item <a href="#t0">3</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2 (pubk rs-0))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs-0 n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk rs-0))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-0 (hash n1-0 n2-0))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-0 n2-0 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk rs-0)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-0 n1 n2 (pubk c))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk rs-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((token (cat c access)) (n1 n1-0) (n2 n2-0) (n3 n1) (n4 n2) (access access-0) (c c) (as as) (rs rs-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as rs-0) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>single_token_simple 3 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n1-0 n2-0 text)
    (access acess_token value access_type access-0 data)
    (rs c as rs-0 name))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as rs-0) (rs rs))
  (defstrand client 9 (token (cat c access)) (n1 n1-0) (n2 n2-0) (n3 n1)
    (n4 n2) (access access-0) (c c) (as as) (rs rs-0))
  (precedes ((0 1) (1 6)) ((1 7) (0 2)) ((1 8) (0 3)))
  (neq (c rs-0) (c rs) (rs-0 rs))
  (non-orig (privk rs) (privk c) (privk rs-0))
  (uniq-orig n2)
  (operation encryption-test (displaced 1 2 client 9)
    (enc c-0 access (hash n1 n2)) (0 3))
  (label 3)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as rs-0) (rs rs) (n2 n2) (access access)
        (acess_token acess_token) (value value)
        (access_type access_type) (n1 n1))))
  (origs (n2 (0 1))))</pre>

<p id="k10">Item <a href="#t0">10</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((n1 n1) (n2 n2) (access access) (c c) (as as))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>single_token_simple 10 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 text) (access acess_token value access_type data)
    (c rs as name))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs rs))
  (defstrand client 4 (n1 n1) (n2 n2) (access access) (c c) (as as))
  (precedes ((0 1) (1 1)) ((1 2) (0 2)) ((1 3) (0 3)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk rs) (privk as))
  (uniq-orig n2)
  (operation encryption-test (displaced 1 2 client 4)
    (enc c access (hash n1 n2)) (0 3))
  (label 10)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (access access)
        (acess_token acess_token) (value value)
        (access_type access_type) (n1 n1))))
  (origs (n2 (0 1))))</pre>

<p id="k13">Item <a href="#t0">13</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-1 (hash n1-1 n2-1))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as-1))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-1 n1-1 n2-1 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1-1 (pubk as-1))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc token (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-0 (hash n1-0 n2-0))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((token (cat c access)) (n1 n1-1) (n2 n2-1) (n3 n1) (n4 n2) (access access-1) (c c) (as as-1) (rs as))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((token token) (n1 n1-0) (n2 n2-0) (n3 n1) (n4 n2) (access access-0) (c c) (as as-0) (rs as))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>single_token_simple 13 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (token mesg) (n2 n1 n1-0 n2-0 n1-1 n2-1 text)
    (access acess_token value access_type access-0 access-1 data)
    (c as rs as-0 as-1 name))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs rs))
  (defstrand client 8 (token token) (n1 n1-0) (n2 n2-0) (n3 n1) (n4 n2)
    (access access-0) (c c) (as as-0) (rs as))
  (defstrand client 9 (token (cat c access)) (n1 n1-1) (n2 n2-1) (n3 n1)
    (n4 n2) (access access-1) (c c) (as as-1) (rs as))
  (precedes ((0 1) (1 6)) ((0 1) (2 6)) ((1 7) (0 2)) ((2 8) (0 3)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n2)
  (operation nonce-test (contracted (c-0 c) (rs-0 as)) n2 (2 6)
    (enc as n1 n2 (pubk c)))
  (label 13)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (access access)
        (acess_token acess_token) (value value)
        (access_type access_type) (n1 n1))))
  (origs (n2 (0 1))))</pre>

<p id="k22">Item <a href="#t0">22</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 141.331 487.313 42.783 709.665'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc token (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-0 (hash n1-0 n2-0))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 89.167 374.561 138.375 559.162'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((n1 n1) (n2 n2) (access access) (c c) (as as))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((token token) (n1 n1-0) (n2 n2-0) (n3 n1) (n4 n2) (access access-0) (c c) (as as-0) (rs as))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>single_token_simple 22 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (token mesg) (n2 n1 n1-0 n2-0 text)
    (access acess_token value access_type access-0 data)
    (c as rs as-0 name))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs rs))
  (defstrand client 8 (token token) (n1 n1-0) (n2 n2-0) (n3 n1) (n4 n2)
    (access access-0) (c c) (as as-0) (rs as))
  (defstrand client 4 (n1 n1) (n2 n2) (access access) (c c) (as as))
  (precedes ((0 1) (1 6)) ((0 1) (2 1)) ((1 7) (0 2)) ((2 3) (0 3)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n2)
  (operation nonce-test (contracted (as-1 as)) n2 (2 1)
    (enc as n1 n2 (pubk c)))
  (label 22)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (access access)
        (acess_token acess_token) (value value)
        (access_type access_type) (n1 n1))))
  (origs (n2 (0 1))))</pre>

<p id="k32">Item <a href="#t0">32</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-0 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 90.713 449.561 41.505 634.162'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 138.509 337.313 237.057 559.665'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((token (cat c access)) (n1 n1-0) (n2 n2-0) (n3 n1) (n4 n2) (access access-0) (c c) (as as-0) (rs as))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g><title>((n1 n1) (n2 n2) (c c) (as as))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>single_token_simple 32 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 n1-0 n2-0 text)
    (access acess_token value access_type access-0 data)
    (c as rs as-0 name))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs rs))
  (defstrand client 3 (n1 n1) (n2 n2) (c c) (as as))
  (defstrand client 9 (token (cat c access)) (n1 n1-0) (n2 n2-0) (n3 n1)
    (n4 n2) (access access-0) (c c) (as as-0) (rs as))
  (precedes ((0 1) (1 1)) ((0 1) (2 6)) ((1 2) (0 2)) ((2 8) (0 3)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n2)
  (operation nonce-test (contracted (c-0 c) (rs-0 as)) n2 (2 6)
    (enc as n1 n2 (pubk c)))
  (label 32)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (access access)
        (acess_token acess_token) (value value)
        (access_type access_type) (n1 n1))))
  (origs (n2 (0 1))))</pre>

<p id="k37">Item <a href="#t0">37</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((n1 n1) (n2 n2) (access access) (c c) (as as))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g><title>((n1 n1) (n2 n2) (c c) (as as))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>single_token_simple 37 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n2 n1 text) (access acess_token value access_type data)
    (c as rs name))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs rs))
  (defstrand client 3 (n1 n1) (n2 n2) (c c) (as as))
  (defstrand client 4 (n1 n1) (n2 n2) (access access) (c c) (as as))
  (precedes ((0 1) (1 1)) ((0 1) (2 1)) ((1 2) (0 2)) ((2 3) (0 3)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk c) (privk as) (privk rs))
  (uniq-orig n2)
  (operation nonce-test (contracted (as-0 as)) n2 (2 1)
    (enc as n1 n2 (pubk c)))
  (label 37)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (access access)
        (acess_token acess_token) (value value)
        (access_type access_type) (n1 n1))))
  (origs (n2 (0 1))))</pre>

<p id="k322">Item <a href="#t0">322</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='414.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='414.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc token (hash n1 n2))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.729 638.906 45.578 712.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2 (pubk rs-1))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs-1 n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk rs-1))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc token (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-1 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-0 n2-0 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n2 (pubk rs-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(enc token (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc c access-0 (hash n1 n2))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk rs-1))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc rs-1 n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk rs-1))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk rs-1)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk rs-1))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 137.111 488.906 234.262 562.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-1 n1 n2 (pubk c))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk rs-1))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>((token token) (n1 n1-0) (n2 n2-0) (n3 n1) (n4 n2) (access access-1) (c c) (as as) (rs rs-1))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((token token) (n1 n1) (n2 n2) (n3 n2) (access access-0) (c c) (as rs-1) (rs rs-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as rs-1) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>single_token_simple 322 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (token mesg) (n1 n2 n1-0 n2-0 text)
    (access acess_token value access_type access-0 access-1 data)
    (rs rs-0 c as rs-1 name))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as rs-1) (rs rs))
  (defstrand client 6 (token token) (n1 n1) (n2 n2) (n3 n2)
    (access access-0) (c c) (as rs-1) (rs rs-0))
  (defstrand client 9 (token token) (n1 n1-0) (n2 n2-0) (n3 n1) (n4 n2)
    (access access-1) (c c) (as as) (rs rs-1))
  (precedes ((0 1) (1 1)) ((0 1) (2 6)) ((1 5) (0 3)) ((2 7) (0 2))
    ((2 8) (1 4)))
  (neq (c rs-1) (c rs) (rs-1 rs))
  (non-orig (privk rs) (privk c) (privk rs-1))
  (uniq-orig n2)
  (operation generalization deleted (1 0))
  (label 322)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as rs-1) (rs rs) (n2 n2) (access access)
        (acess_token acess_token) (value value)
        (access_type access_type) (n1 n1))))
  (origs (n2 (0 1))))</pre>

<p id="k342">Item <a href="#t0">342</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 141.913 562.717 43.945 710.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n2-0 (pubk rs-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc c access-1 (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-1 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as-0))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc token (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-0 (hash n1 n2))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as-0)) (pubk rs)) (hash n1-0 n2-0))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 89.167 374.561 138.375 559.162'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((token (cat c access-1)) (n1 n1-0) (n2 n2-0) (n3 n2-0) (access access-1) (c c) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((token token) (n1 n1) (n2 n2) (n3 n1-0) (n4 n2-0) (access access-0) (c c) (as as) (rs as-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as-0) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>single_token_simple 342 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (token mesg) (n1 n2 n1-0 n2-0 text)
    (access acess_token value access_type access-0 access-1 data)
    (rs as c as-0 rs-0 name))
  (defstrand authorization_server 5 (n1 n1-0) (n2 n2-0) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as-0) (rs rs))
  (defstrand client 8 (token token) (n1 n1) (n2 n2) (n3 n1-0) (n4 n2-0)
    (access access-0) (c c) (as as) (rs as-0))
  (defstrand client 6 (token (cat c access-1)) (n1 n1-0) (n2 n2-0)
    (n3 n2-0) (access access-1) (c c) (as as-0) (rs rs-0))
  (precedes ((0 1) (1 6)) ((0 1) (2 1)) ((1 7) (0 2)) ((2 5) (0 3)))
  (neq (c as-0) (c rs) (as-0 rs))
  (non-orig (privk rs) (privk c) (privk as-0))
  (uniq-orig n2-0)
  (operation generalization deleted (2 0))
  (label 342)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as-0) (rs rs) (n2 n2-0) (access access)
        (acess_token acess_token) (value value)
        (access_type access_type) (n1 n1-0))))
  (origs (n2-0 (0 1))))</pre>

<p id="k496">Item <a href="#t0">496</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='414.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='414.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc token (hash n1 n2))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk rs-1))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc rs-1 n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk rs-1))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc token (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-1 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1-0 n2-0 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n2 (pubk rs-0))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(enc token (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc c access-0 (hash n1 n2))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 91.604 637.464 43.287 709.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2 (pubk rs-1))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc rs-1 n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk rs-1))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk rs-1)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk rs-1))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 137.111 488.906 234.262 562.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc rs-1 n1 n2 (pubk c))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk rs-1))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>((token token) (n1 n1-0) (n2 n2-0) (n3 n1) (n4 n2) (access access-1) (c c) (as as) (rs rs-1))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((token token) (n1 n1) (n2 n2) (n3 n2) (access access-0) (c c) (as rs-1) (rs rs-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as rs-1) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>single_token_simple 496 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (token mesg) (n1 n2 n1-0 n2-0 text)
    (access acess_token value access_type access-0 access-1 data)
    (rs rs-0 c as rs-1 name))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as rs-1) (rs rs))
  (defstrand client 6 (token token) (n1 n1) (n2 n2) (n3 n2)
    (access access-0) (c c) (as rs-1) (rs rs-0))
  (defstrand client 9 (token token) (n1 n1-0) (n2 n2-0) (n3 n1) (n4 n2)
    (access access-1) (c c) (as as) (rs rs-1))
  (precedes ((0 1) (1 1)) ((0 1) (2 6)) ((1 2) (0 2)) ((1 5) (0 3))
    ((2 8) (1 4)))
  (neq (c rs-1) (c rs) (rs-1 rs))
  (non-orig (privk rs) (privk c) (privk rs-1))
  (uniq-orig n2)
  (operation generalization deleted (1 0))
  (label 496)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as rs-1) (rs rs) (n2 n2) (access access)
        (acess_token acess_token) (value value)
        (access_type access_type) (n1 n1))))
  (origs (n2 (0 1))))</pre>

<p id="k531">Item <a href="#t0">531</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n2 (pubk rs-0))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc c access-0 (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-0 (hash n1 n2))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 91.604 337.464 43.287 409.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((token (cat c access-0)) (n1 n1) (n2 n2) (n3 n2) (access access-0) (c c) (as as) (rs rs-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>single_token_simple 531 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n1 n2 text)
    (access acess_token value access_type access-0 data)
    (rs c as rs-0 name))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs rs))
  (defstrand client 6 (token (cat c access-0)) (n1 n1) (n2 n2) (n3 n2)
    (access access-0) (c c) (as as) (rs rs-0))
  (precedes ((0 1) (1 1)) ((1 2) (0 2)) ((1 5) (0 3)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n2)
  (operation generalization deleted (1 0))
  (label 531)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (access access)
        (acess_token acess_token) (value value)
        (access_type access_type) (n1 n1))))
  (origs (n2 (0 1))))</pre>

<p id="k610">Item <a href="#t0">610</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.300 375.660 144.719 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-1 (hash n1 n2))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n2 (pubk rs-0))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc c access-1 (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-0 (hash n1 n2))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 91.604 337.464 43.287 409.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((n1 n1) (n2 n2) (access access-1) (c c) (as as))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((token (cat c access-1)) (n1 n1) (n2 n2) (n3 n2) (access access-0) (c c) (as as) (rs rs-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>single_token_simple 610 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n1 n2 text)
    (access acess_token value access_type access-0 access-1 data)
    (rs rs-0 c as name))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs rs))
  (defstrand client 6 (token (cat c access-1)) (n1 n1) (n2 n2) (n3 n2)
    (access access-0) (c c) (as as) (rs rs-0))
  (defstrand client 4 (n1 n1) (n2 n2) (access access-1) (c c) (as as))
  (precedes ((0 1) (1 1)) ((0 1) (2 1)) ((1 2) (0 2)) ((1 5) (0 3))
    ((2 3) (1 4)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n2)
  (operation generalization deleted (1 0))
  (label 610)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (access access)
        (acess_token acess_token) (value value)
        (access_type access_type) (n1 n1))))
  (origs (n2 (0 1))))</pre>

<p id="k631">Item <a href="#t0">631</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.300 375.660 144.719 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-1 (hash n1 n2))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.320 300.660 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n2 (pubk rs-0))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc c access-1 (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-0 (hash n1 n2))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((n1 n1) (n2 n2) (access access-1) (c c) (as as))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((token (cat c access-1)) (n1 n1) (n2 n2) (n3 n2) (access access-0) (c c) (as as) (rs rs-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>single_token_simple 631 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n1 n2 text)
    (access acess_token value access_type access-0 access-1 data)
    (rs rs-0 c as name))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs rs))
  (defstrand client 6 (token (cat c access-1)) (n1 n1) (n2 n2) (n3 n2)
    (access access-0) (c c) (as as) (rs rs-0))
  (defstrand client 4 (n1 n1) (n2 n2) (access access-1) (c c) (as as))
  (precedes ((0 1) (1 1)) ((0 1) (2 1)) ((1 5) (0 3)) ((2 2) (0 2))
    ((2 3) (1 4)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n2)
  (operation generalization deleted (1 0))
  (label 631)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (access access)
        (acess_token acess_token) (value value)
        (access_type access_type) (n1 n1))))
  (origs (n2 (0 1))))</pre>

<p id="k637">Item <a href="#t0">637</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n2 (pubk rs-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc c access-0 (hash n1 n2))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-0 (hash n1 n2))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 91.604 337.464 43.287 409.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as)) (pubk rs)) (hash n1 n2))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1 n2))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((token (cat c access-0)) (n1 n1) (n2 n2) (n3 n2) (access access-0) (c c) (as as) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g><title>((n1 n1) (n2 n2) (c c) (as as))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1) (n2 n2) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>single_token_simple 637 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (n1 n2 text)
    (access acess_token value access_type access-0 data)
    (rs c as rs-0 name))
  (defstrand authorization_server 5 (n1 n1) (n2 n2) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as) (rs rs))
  (defstrand client 3 (n1 n1) (n2 n2) (c c) (as as))
  (defstrand client 6 (token (cat c access-0)) (n1 n1) (n2 n2) (n3 n2)
    (access access-0) (c c) (as as) (rs rs-0))
  (precedes ((0 1) (1 1)) ((0 1) (2 1)) ((1 2) (0 2)) ((2 5) (0 3)))
  (neq (c as) (c rs) (as rs))
  (non-orig (privk rs) (privk c) (privk as))
  (uniq-orig n2)
  (operation generalization deleted (2 0))
  (label 637)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as) (rs rs) (n2 n2) (access access)
        (acess_token acess_token) (value value)
        (access_type access_type) (n1 n1))))
  (origs (n2 (0 1))))</pre>

<p id="k832">Item <a href="#t0">832</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='414.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc token-0 (hash n1-0 n2-0))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as-0))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc token-0 (hash n1-1 n2-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-2 (hash n1-1 n2-1))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-1 (pubk as-1))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-1 n1-1 n2-1 (pubk c))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1-1 (pubk as-1))</title>
   <circle cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n2-0 (pubk rs-0))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc token-0 (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc c access-1 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.340 675.660 44.759 711.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as-0))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc token (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-0 (hash n1 n2))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as-0)) (pubk rs)) (hash n1-0 n2-0))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 87.540 525.660 135.121 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 489.960 Q 186.990 489.232 334.019 563.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>((token token-0) (n1 n1-1) (n2 n2-1) (n3 n1-0) (n4 n2-0) (access access-2) (c c) (as as-1) (rs as-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((token token-0) (n1 n1-0) (n2 n2-0) (n3 n2-0) (access access-1) (c c) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((token token) (n1 n1) (n2 n2) (n3 n1-0) (n4 n2-0) (access access-0) (c c) (as as) (rs as-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as-0) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 832 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (token token-0 mesg) (n1 n2 n1-0 n2-0 n1-1 n2-1 text)
    (access acess_token value access_type access-0 access-1 access-2
      data) (rs as c as-0 rs-0 as-1 name))
  (defstrand authorization_server 5 (n1 n1-0) (n2 n2-0) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as-0) (rs rs))
  (defstrand client 8 (token token) (n1 n1) (n2 n2) (n3 n1-0) (n4 n2-0)
    (access access-0) (c c) (as as) (rs as-0))
  (defstrand client 6 (token token-0) (n1 n1-0) (n2 n2-0) (n3 n2-0)
    (access access-1) (c c) (as as-0) (rs rs-0))
  (defstrand client 9 (token token-0) (n1 n1-1) (n2 n2-1) (n3 n1-0)
    (n4 n2-0) (access access-2) (c c) (as as-1) (rs as-0))
  (precedes ((0 1) (1 6)) ((0 1) (2 1)) ((0 1) (3 6)) ((1 7) (0 2))
    ((2 5) (0 3)) ((3 8) (2 4)))
  (neq (c as-0) (c rs) (as-0 rs))
  (non-orig (privk rs) (privk c) (privk as-0))
  (uniq-orig n2-0)
  (operation generalization deleted (2 0))
  (label 832)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as-0) (rs rs) (n2 n2-0) (access access)
        (acess_token acess_token) (value value)
        (access_type access_type) (n1 n1-0))))
  (origs (n2-0 (0 1))))</pre>

<p id="k878">Item <a href="#t0">878</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.260 375.660 244.679 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c access-2 (hash n1-0 n2-0))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as-0))</title>
   <circle cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 141.913 562.717 43.945 710.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc c n2-0 (pubk rs-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc c access-2 (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-1 (hash n1-0 n2-0))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as-0))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc token (hash n1 n2))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc c access-0 (hash n1 n2))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc n2 (pubk as))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc as n1 n2 (pubk c))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1 (pubk as))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (enc (enc acess_token value access_type (privk as-0)) (pubk rs)) (hash n1-0 n2-0))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(enc c access (hash n1-0 n2-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(enc n2-0 (pubk as-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 89.167 374.561 138.375 559.162'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc as-0 n1-0 n2-0 (pubk c))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc c n1-0 (pubk as-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access-2) (c c) (as as-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((token (cat c access-2)) (n1 n1-0) (n2 n2-0) (n3 n2-0) (access access-1) (c c) (as as-0) (rs rs-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((token token) (n1 n1) (n2 n2) (n3 n1-0) (n4 n2-0) (access access-0) (c c) (as as) (rs as-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((n1 n1-0) (n2 n2-0) (access access) (acess_token acess_token) (value value) (access_type access_type) (c c) (as as-0) (rs rs))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>authorization_server</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>single_token_simple 878 (realized)</text>
  </svg></div>

<pre>(defskeleton single_token_simple
  (vars (token mesg) (n1 n2 n1-0 n2-0 text)
    (access acess_token value access_type access-0 access-1 access-2
      data) (rs as c as-0 rs-0 name))
  (defstrand authorization_server 5 (n1 n1-0) (n2 n2-0) (access access)
    (acess_token acess_token) (value value) (access_type access_type)
    (c c) (as as-0) (rs rs))
  (defstrand client 8 (token token) (n1 n1) (n2 n2) (n3 n1-0) (n4 n2-0)
    (access access-0) (c c) (as as) (rs as-0))
  (defstrand client 6 (token (cat c access-2)) (n1 n1-0) (n2 n2-0)
    (n3 n2-0) (access access-1) (c c) (as as-0) (rs rs-0))
  (defstrand client 4 (n1 n1-0) (n2 n2-0) (access access-2) (c c)
    (as as-0))
  (precedes ((0 1) (1 6)) ((0 1) (2 1)) ((0 1) (3 1)) ((1 7) (0 2))
    ((2 5) (0 3)) ((3 3) (2 4)))
  (neq (c as-0) (c rs) (as-0 rs))
  (non-orig (privk rs) (privk c) (privk as-0))
  (uniq-orig n2-0)
  (operation generalization deleted (2 0))
  (label 878)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((c c) (as as-0) (rs rs) (n2 n2-0) (access access)
        (acess_token acess_token) (value value)
        (access_type access_type) (n1 n1-0))))
  (origs (n2-0 (0 1))))</pre>

</body>
</html>
